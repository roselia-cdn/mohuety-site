(function(t){function e(e){for(var a,s,i=e[0],c=e[1],l=e[2],d=0,h=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&h.push(r[s][0]),r[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(h.length)h.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(a=!1)}a&&(o.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},r={app:0},o=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"034f":function(t,e,n){"use strict";var a=n("19b3"),r=n.n(a);r.a},1:function(t,e){},"19b3":function(t,e,n){},"217c":function(t,e,n){"use strict";var a=n("68ec"),r=n.n(a);r.a},3266:function(t,e,n){},"36ae":function(t,e,n){},"38c8":function(t,e,n){"use strict";var a=n("36ae"),r=n.n(a);r.a},"3d75":function(t,e,n){},"55e6":function(t,e,n){},6155:function(t,e,n){"use strict";var a=n("8f9b"),r=n.n(a);r.a},6801:function(t,e,n){"use strict";var a=n("3266"),r=n.n(a);r.a},"68ec":function(t,e,n){},8315:function(t,e,n){},"84f6":function(t,e,n){"use strict";var a=n("8315"),r=n.n(a);r.a},"86f9":function(t,e,n){"use strict";var a=n("55e6"),r=n.n(a);r.a},"8cd6":function(t,e,n){"use strict";var a=n("c217"),r=n.n(a);r.a},"8f9b":function(t,e,n){},afe5:function(t,e,n){"use strict";var a=n("3d75"),r=n.n(a);r.a},c217:function(t,e,n){},c293:function(t,e,n){"use strict";var a=n("cd21"),r=n.n(a);r.a},cd21:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"black-shout"}},[n("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.$route.meta.title,expression:"$route.meta.title"}]}),n("theme-listener",{model:{value:t.preferredLight,callback:function(e){t.preferredLight=e},expression:"preferredLight"}}),n("v-app",{attrs:{dark:t.isNight}},[n("v-content",[n("v-slide-x-transition",{attrs:{"hide-on-leave":""}},[n("router-view",{attrs:{currentColorScheme:!t.isNight,userData:t.userData},on:{forceSwitchToLight:t.switchToLight,forceSwitchToDark:t.switchToDark}})],1)],1),n("go-top-btn")],1),n("vue-progress-bar")],1)},o=[],s=(n("0d03"),a["default"].extend({mounted:function(){this.checkScheme()},methods:{setState:function(t){this.$emit("change",t)},checkScheme:function(){var t=this,e=matchMedia("(prefers-color-scheme: dark)"),n=matchMedia("(prefers-color-scheme: light)");e.matches||n.matches?(this.setState(n.matches),e.addListener((function(e){return t.setState(!e.matches)})),n.addListener((function(e){return t.setState(e.matches)}))):this.setState(void 0)}},model:{prop:"scheme",event:"change"},props:{scheme:Boolean},render:function(t){return t()}})),i=(n("a4d3"),n("99af"),n("4de4"),n("4160"),n("a15b"),n("d81d"),n("13d5"),n("4fad"),n("e439"),n("dbb4"),n("b64b"),n("d3b7"),n("e25e"),n("5d41"),n("ac1f"),n("3ca3"),n("466d"),n("5319"),n("1276"),n("2ca0"),n("10d1"),n("159b"),n("ddb0"),n("bf2d")),c=n("284c"),l=n("2fa7"),u=n("e587");function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=function(t){return t.replace(/([A-Z])/g,"_$1").toLowerCase()},f=function(t){return t.replace(/_([a-zA-Z])/g,(function(t,e){return e.toUpperCase()}))},p=function(t){return function(e){return Object.entries(e).map((function(e){var n=Object(u["a"])(e,2),a=n[0],r=n[1];return t(a,r)}))}},v=function(t){return t.reduce((function(t,e){return h({},t,Object(l["a"])({},e[0],e[1]))}),{})};function g(t){return function(e){return Object.assign.apply(Object,[{}].concat(Object(c["a"])(Object.entries(e).map((function(e){var n=Object(u["a"])(e,2),a=n[0],r=n[1];return Object(l["a"])({},a,t(r))})))))}}var b=function t(e){return function(n){return n instanceof Array?n.map(t(e)):n&&"object"===Object(i["a"])(n)?v(p((function(n,a){return[e(n),t(e)(a)]}))(n)):n}},y=b(f),w=b(m),k=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return"undefined"===typeof t?void 0:t[e]}),t)}},_=function(t,e){return t===e||!(!t||!e)&&t.toLowerCase()===e.toLowerCase()},D=function(t,e,n){return(299*t+587*e+114*n)/1e3},x=function(t){return t.match(/\d+/g).map((function(t){return parseInt(t,10)}))},C=function(t){if(t){var e,n=t.toLowerCase();if(n.startsWith("rgb")){var a=x(n);e=D(a[0],a[1],a[2])}else{var r=n.substring(1);if(3===r.length&&(r=r.split("").map((function(t){return t+t})).join("")),6!==r.length)return;var o=r.replace(/(..)(?=.)/g,"$1-").split("-").map((function(t){return parseInt(t,16)}));e=D(o[0],o[1],o[2])}return e>=128}};function O(t,e,n,a){var r=C(t);return"undefined"===typeof r?a:r?e:n}function T(t,e){var n=new WeakMap;return new Proxy(t,{get:function(t,a){var r=Reflect.get(t,a);return"function"===typeof r?(n.has(r)||n.set(r,r.bind(e||t)),n.get(r)):r}})}var P=n("9f12"),S=n("53fe");function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var V=function(){function t(e){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:localStorage;Object(P["a"])(this,t),this.changeListeners=[],this.key=e,this.storage=a,this.addStorageEventListener((function(){return n.onStorageChanged()}))}return Object(S["a"])(t,[{key:"onStorageChanged",value:function(){var t=this.payload;this.changeListeners.forEach((function(e){return e(t)}))}},{key:"addChangeListener",value:function(t){var e=this;return this.changeListeners.push(t),function(){e.changeListeners=e.changeListeners.filter((function(e){return e!==t}))}}},{key:"getItem",value:function(t){var e=this.payload;return e&&e[t]}},{key:"getPayload",value:function(){return this.payload}},{key:"setPayload",value:function(t){this.payload=t}},{key:"updatePayload",value:function(t){this.setPayload(L({},t,{},this.payload))}},{key:"clear",value:function(){this.storage.removeItem(this.key),this.onStorageChanged()}},{key:"addStorageEventListener",value:function(t){var e=this;addEventListener("storage",(function(n){n.key===e.key&&t(e.payload)}))}},{key:"isEmpty",value:function(){return!this.payload}},{key:"payload",get:function(){return JSON.parse(this.storage.getItem(this.key)||"null")},set:function(t){this.storage.setItem(this.key,JSON.stringify(t)),this.onStorageChanged()}}]),t}(),E=new V("loginData"),$={name:"App",components:{"theme-listener":s},mounted:function(){this.$Progress.finish(),this.$watch("$vuetify.theme.currentTheme",(function(t){document.body.style.setProperty("--themed-text-color",O(t.primary,"#000000","#ffffff","#ffffff"))}),{immediate:!0,deep:!0})},created:function(){var t=this;E.addChangeListener((function(e){t.userData=e}))},methods:{switchToLight:function(t){this.forceLight=!!t},switchToDark:function(t){this.forceDark=!!t}},data:function(){return{forceLight:!1,forceDark:!1,forceTitle:"",preferredLight:void 0,userData:E.getPayload()}},computed:{isNight:function(){var t=(new Date).getHours(),e=t>6&&t<18;return this.forceDark||!(this.forceLight||e)}},watch:{preferredLight:function(t){if("undefined"!==typeof t){var e=!t;this.forceLight=!e,this.forceDark=e}else this.forceLight=this.forceDark=!1},isNight:{handler:function(t){this.$vuetify.theme.isDark=t},immediate:!0}}},A=$,I=(n("034f"),n("2877")),U=n("6544"),R=n.n(U),F=n("7496"),N=n("a75b"),M=n("0789"),B=Object(I["a"])(A,r,o,!1,null,null,null),q=B.exports;R()(B,{VApp:F["a"],VContent:N["a"],VSlideXTransition:M["f"]});var J=n("8c4f"),W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"text-center fill-height",attrs:{fluid:"","grid-list-md":""}},[n("v-row",{attrs:{justify:"center",align:"center"}},[n("v-col",{attrs:{cols:"12"}},[n("h3",{staticClass:"display-3"},[t._v("Welcome to "),n("strong",{staticClass:"primary--text"},[t._v(t._s(t.title))])]),n("span",{staticClass:"subtitle-1"},[t._v(t._s(t.motto))]),n("v-divider",{staticClass:"my-3"}),t.loading?n("div",[n("div",{staticClass:"title mb-3"},[t._v("Please standby...")]),n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):t.isFirstRun?n("div",[n("div",{staticClass:"title mb-3"},[t._v("Add first user to continue.")]),n("v-btn",{staticClass:"mx-0",attrs:{color:"primary",large:"",to:{name:"userManagement",params:{firstRun:!0}}}},[t._v(" Add user ")])],1):n("div",[n("div",{staticClass:"title mb-3"},[t._v("Great! You are now prepared to "),n("strong",{staticClass:"primary--text"},[t._v(t._s(t.title))])]),n("v-btn",{staticClass:"mx-0",attrs:{color:"secondary",large:"",to:{name:"index"}}},[t._v(" Go to "+t._s(t.title)+" ")])],1)],1)],1)],1)},H=[],Y="Somainer's Blog",G="Do what you want to do, be who you want to be.",z="https://roselia.moe/blog/api",K="/blog",X={primary:"#0288d1",secondary:"#6292E9",accent:"#E08696",error:"#FB5458",warning:"#FE9952",info:"#95CAEE",success:"#61BF99"},Z={title:Y,motto:G,apiBase:z,theme:X,enableRoseliaScript:!0,enableAskYukina:!0,footerName:"Somainer",urlPrefix:K,images:{indexBannerImage:K+"/static/img/bg_n3.jpg",postBannerImage:K+"/static/img/nest.png",lazyloadImage:K+"/static/img/observe.jpg",timelineBannerImage:K+"/static/img/bg_n0.png"}},Q=(n("25f0"),n("841c"),n("bc3a")),tt=n.n(Q),et=tt.a.create();et.interceptors.request.use((function(t){return Bo.$Progress.start(),t})),et.interceptors.response.use((function(t){return 200===t.status?Bo.$Progress.finish():Bo.$Progress.fail(),t}),(function(t){return Bo.$Progress.fail(),Promise.reject(t)}));var nt=et,at=n("2ef0"),rt=n.n(at),ot={};ot.apiBase=Z.apiBase,ot.getArguments=function(){return this.$route.query},ot.setRedirect=function(t){window.sessionStorage.setItem("redirectURL",JSON.stringify(t||ot.getAbsPath()))},ot.getRedirect=function(){return JSON.parse(window.sessionStorage.getItem("redirectURL"))},ot.cleanRedirect=function(){window.sessionStorage.removeItem("redirectURL")},ot.getAbsPath=function(){return window.location.pathname+window.location.search+window.location.hash},ot.redirectTo=function(t){so.push(t||"./")},ot.getLoginData=function(){return E.getPayload()},ot.setLoginData=function(t){E.setPayload(t)},ot.updateLoginData=function(t){return ot.setLoginData(t(ot.getLoginData()))},ot.removeLoginData=function(){return E.clear()},ot.saveSUToken=function(t){window.sessionStorage.setItem("suToken",t)},ot.getSUToken=function(){return window.sessionStorage.getItem("suToken")},ot.removeSUToken=function(){window.sessionStorage.removeItem("suToken")},ot.getPosts=function(t){return this.fetchJSON(this.apiFor("posts")).then(t)},ot.refreshToken=function(t){if(!t){var e=ot.getLoginData();t=e&&e.rftoken}return t?ot.fetchJSON(ot.apiFor("login","token","refresh"),"POST",{token:t},!1,!1).then((function(t){if(t.success){var e=ot.getLoginData();return e&&(e.token=t.token)&&ot.setLoginData(e),e}return ot.removeLoginData(),Promise.reject(t.msg)})):Promise.reject("No token")},ot.formatDate=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n=new Date(t);return isNaN(n.getTime())?t:e?n.toLocaleString():n.toLocaleDateString()}catch(a){return}},ot.getPostsData=function(){return JSON.parse(window.localStorage.postData||"null")},ot.deleteDraft=function(){return window.localStorage.removeItem("postDraft")},ot.setPosts=function(t){window.localStorage.postData=JSON.stringify(t)},ot.apiFor=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return"".concat(ot.apiBase,"/").concat(e.join("/"))},ot.encodeArgs=function(t){return rt.a.map(t,(function(t,e){return"".concat(e,"=").concat(t)})).join("&")},ot.processPosts=function(t){var e=window.localStorage.postData;return e?t(JSON.parse(e)):ot.getPosts(t),!1},ot.ajaxPromised=function(t){return nt(t).then((function(t){return t.data}))},ot.fetchJSON=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=this.getLoginData(),s=o?o.token:"";e=e.toUpperCase(),r&&(n["__timestamp"]=(new Date).getTime());var i=a?Object.assign({},n,{token:s}):n;return"GET"===e&&(i={params:i}),nt[e.toLowerCase()](t,i).then((function(t){return t.data})).catch((function(t){return Promise.reject(t)}))},ot.fetchJSONWithSuccess=function(){return this.fetchJSON.apply(this,arguments).then((function(t){return t.success?t.result||t.data||t:Promise.reject(t.msg)}))},ot.getTokenExpiryTime=function(t){try{var e=t.split(".")[0],n=JSON.parse(window.atob(e)),a=n.exp;return new Date(1e3*a)}catch(r){return console.error(r),new Date}},ot.isTokenExpired=function(t){return ot.getTokenExpiryTime(t||this.getLoginData().token)<new Date},ot.showToast=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.toast.show=!1,this.toast.text=t.toString(),this.toast.color=e,this.toast.show=!0},ot.getToastOption=function(){return{show:!1,text:"",color:""}},ot.addEventListener=function(t,e){return addEventListener(t,e),function(){removeEventListener(t,e)}},ot.addStorageListener=function(t){return ot.addEventListener("storage",t)};var st=ot;function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var lt={name:"HelloWorld",data:function(){return{title:Z.title,motto:Z.motto,loading:!0,isFirstRun:!1}},methods:{getFirstRunData:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("firstrun")).then((function(e){t.isFirstRun=!0,st.setLoginData(ct({nickname:"Minato Yukina"},e,{su_token:void 0})),st.saveSUToken(e.su_token)})).finally((function(e){t.loading=!1}))}},mounted:function(){this.getFirstRunData()}},ut=lt,dt=n("8336"),ht=n("62ad"),mt=n("a523"),ft=n("ce7e"),pt=n("490a"),vt=n("0fd9"),gt=Object(I["a"])(ut,W,H,!1,null,"62fa0a28",null),bt=gt.exports;R()(gt,{VBtn:dt["a"],VCol:ht["a"],VContainer:mt["a"],VDivider:ft["a"],VProgressCircular:pt["a"],VRow:vt["a"]});var yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nav-bar",{attrs:{userData:t.userData,route:this.$route.fullPath}}),n("v-parallax",{attrs:{dark:"",src:t.meta.images.indexBannerImage}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[n("h1",{staticClass:"display-2 font-weight-thin mb-3"},[t._v(t._s(t.realTitle||t.meta.title))]),n("h4",{staticClass:"subheading"},[t._v(t._s(t.realSubtitle||t.meta.motto))])])],1)],1),n("v-layout",[n("v-container",{attrs:{fluid:"","grid-list-lg":""}},[t.posts.length?t._e():n("v-row",{attrs:{wrap:""}},t._l(6,(function(e){return n("v-col",{key:e,attrs:{cols:"12",xs:"12",sm:"8","offset-sm":"2"}},[n("v-skeleton-loader",{staticClass:"mb-6",class:{"round-corner-card":t.$vuetify.breakpoint.smAndUp},attrs:{elevation:"2",type:"card"}})],1)})),1),n("v-row",{attrs:{wrap:""}},t._l(t.posts,(function(e){return n("v-col",{key:e.id,attrs:{cols:"12",xs:"12",sm:"8","offset-sm":"2"}},[n("v-card",{class:{"round-corner-card":t.$vuetify.breakpoint.smAndUp},attrs:{hover:"",ripple:!1,shaped:t.$vuetify.breakpoint.smAndUp,to:t.getRoute(e)}},[e.img?n("v-img",{attrs:{src:e.img,"lazy-src":t.meta.images.lazyloadImage,ripple:"true"}},[n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{staticClass:"fill-height",attrs:{align:"end"}},[n("v-col",{attrs:{cols:"12","align-self":"end",flexbox:""}},[t._l(e.tags,(function(e){return n("router-link",{key:e,attrs:{to:{name:"index",params:{tag:e},query:{tag:e}}}},[n("v-chip",{staticClass:"ma-1"},[t._v(t._s(e))])],1)})),e.secret?n("v-chip",{staticClass:"ma-1",attrs:{color:"success","text-color":"white"}},[n("v-avatar",{attrs:{left:""}},[n("v-icon",[t._v("lock")]),t._v(t._s(e.secret)+" ")],1),t._v(" Secret ")],1):t._e(),e.hidden?n("v-chip",{staticClass:"ma-1",attrs:{color:"grey","text-color":"white"}},[n("v-avatar",{attrs:{left:""}},[n("v-icon",[t._v("visibility_off")])],1),t._v(" Hidden ")],1):t._e()],2)],1)],1)],1):t._e(),n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("div",{staticClass:"headline"},[t._v(t._s(e.title))]),n("span",{staticClass:"grey--text subtitle-1"},[t._v(t._s(e.subtitle))])]),n("v-spacer"),n("span",{staticClass:"right caption"},[t._v(t._s(t.formatDate(e.created)||e.date))])],1),e.img?t._e():n("v-col",{attrs:{cols:"12","align-self":"end",flexbox:""}},[t._l(e.tags,(function(e){return n("router-link",{key:e,attrs:{to:{name:"index",params:{tag:e},query:{tag:e}}}},[n("v-chip",{staticClass:"ma-1"},[t._v(t._s(e))])],1)})),e.secret?n("v-chip",{staticClass:"ma-1",attrs:{color:"success","text-color":"white"}},[n("v-avatar",{attrs:{left:""}},[n("v-icon",[t._v("lock")]),t._v(t._s(e.secret)+" ")],1),t._v(" Secret ")],1):t._e(),e.hidden?n("v-chip",{staticClass:"ma-1",attrs:{color:"grey","text-color":"white"}},[n("v-avatar",{attrs:{left:""}},[n("v-icon",[t._v("visibility_off")])],1),t._v(" Hidden ")],1):t._e()],2),n("v-card-title",[n("span",{staticClass:"grey--text subtitle-1"},[t._v(t._s(e.author.nickname))])]),t.userData&&t.userData.role&&t.userData.role>=e.author.role?n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{small:"",fab:"",color:"error",to:{name:"edit",query:{post:e.id},params:{deletePost:!0,title:e.title}}}},[n("v-icon",[t._v("delete")])],1),n("v-btn",{attrs:{small:"",fab:"",color:"primary",to:{name:"edit",query:{post:e.id}}}},[n("v-icon",[t._v("mode_edit")])],1)],1):t._e()],1)],1)})),1)],1)],1),n("v-container",[n("div",{staticClass:"text-center"},[n("v-pagination",{attrs:{length:t.pages,circle:""},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)]),n("toast",t._b({on:{showChange:t.changeToast}},"toast",t.toast,!1)),n("blog-footer"),n("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.windowTitle,expression:"windowTitle"}]})],1)},wt=[],kt=(n("7db0"),n("c760"),n("96cf"),n("89ba")),_t=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(a){return st.fetchJSONWithSuccess(st.apiFor(e),t,w(a),n).then(y)}},Dt=_t("get","luis/run-command"),xt=_t("get","luis/ask-yukina");function Ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ct(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ct(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Tt=function(t){return v(t.map((function(t){return[t.type,t.entity]})))};function Pt(t){return St.apply(this,arguments)}function St(){return St=Object(kt["a"])(regeneratorRuntime.mark((function t(e){var n,a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(e in Et)){t.next=4;break}return Et[e]({}),t.abrupt("return",!0);case 4:t.next=18;break;case 6:return t.prev=6,t.t0=t["catch"](0),t.next=10,Dt({command:e});case 10:if(n=t.sent,a=n.topScoringIntent.intent,r=Tt(n.entities),r.Password&&(o=n.entities.find((function(t){return"Password"===t.type})),r.Password=e.substring(o.startIndex,o.endIndex+1)),!(a in Et)){t.next=17;break}return Et[a](r),t.abrupt("return",!0);case 17:return t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[0,6]])}))),St.apply(this,arguments)}var jt=function(){var t=Object(kt["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xt({question:e});case 2:return t.abrupt("return",t.sent[0]);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Lt={login:function(t){var e=t.Username,n=t.Password;so.push({name:"login",params:{credential:{username:e,password:n}}})},newPost:function(t){var e=t.PostID;so.push({name:"edit",query:{post:e}})},search:function(t){var e=t.PostTag;so.push({name:"index",query:{tag:e}})},showTimeline:function(t){var e=t.Username;so.push({name:e?"userTimeline":"timeline",params:{username:e}})},"Utilities.GoBack":function(){so.go(-1)},logout:function(){so.push({name:"login",params:{logout:!0}})}},Vt={},Et=T(new Proxy(Lt,{get:function(t,e){return Reflect.get(Vt,e)||Reflect.get(t,e)},has:function(t,e){return Reflect.has(Vt,e)||Reflect.has(t,e)}})),$t=function(t,e){Vt=Ot({},Vt,{},T(t,e))},At=function(){Vt={}};function It(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?It(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):It(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Rt={name:"blog-index",data:function(){return{currentPage:1,prevPage:0,nextPage:0,pages:0,toast:st.getToastOption(),posts:[],meta:Z,realTitle:"",realSubtitle:"",windowTitle:""}},props:{userData:Object},methods:{makeDirect:function(t){st.setRedirect(st.getAbsPath()),this.$router.push(t)},getTag:function(){return this.getArguments().tag||null},getArguments:function(){return this.$route.query},getPageOffset:function(t){var e=parseInt(this.getArguments().page)||1,n=e+t;return n>0&&n<=this.pages?n:-1},formatDate:function(t){return st.formatDate(t)},shiftPage:function(t){var e=this.getPageOffset(t);-1!==e&&(this.$vuetify.goTo(0),this.$router.push({name:"index",query:{page:e}}))},showToast:function(t,e){return st.showToast.call(this,t,e)},changeToast:function(t){this.toast.show=t},getPostsOnContext:function(t){return t=t||this.getArguments(),this.getPosts(t.page,!1,t.tag)},getPosts:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;t=t||1,this.posts=[];var r={page:t,limit:6};a?(this.windowTitle="".concat(this.meta.title," - Tag: ").concat(a),this.realTitle=a,this.realSubtitle="Posts for tag: ".concat(a),r.tag=a):(this.realTitle="",this.realSubtitle="",this.windowTitle="".concat(this.meta.title," - #").concat(t)),st.fetchJSON(st.apiFor("posts"),"GET",r).then((function(a){a.valid||!e.userData||n||st.refreshToken().then((function(n){e.userData=n,e.getPosts(t,!0)})).catch((function(t){e.showToast(t,"warning"),e.userData=null,st.removeLoginData()})),a.total||st.fetchJSONWithSuccess(st.apiFor("firstrun")).then((function(t){e.$router.push({name:"helloWorld"})})),e.posts=a.data.map((function(t){return t.deleted=!1,t})),e.pages=parseInt(a.pages),e.currentPage=parseInt(t),e.nextPage=e.getPageOffset(1),e.prevPage=e.getPageOffset(-1),e.$emit("roselia-load")})).catch((function(t){console.log(t)}))},getRoute:function(t){return t=y(t),t.displayId?{name:"postWithEternalLink",params:{postLink:t.displayId}}:{name:"post",query:{p:t.id}}}},mounted:function(){this.getPostsOnContext(),$t({"Utilities.ShowNext":function(){-1!==this.nextPage?this.showToast("Taking you to the next page..."):this.showToast("No more pages...","error"),this.shiftPage(1)},"Utilities.ShowPrevious":function(){-1!==this.prevPage?this.showToast("Taking you to the previous page..."):this.showToast("No more pages...","error"),this.shiftPage(-1)}},this)},computed:{},watch:{userData:function(){this.pages&&this.getPosts()},currentPage:function(t){this.$router.push(Ut({},this.$route,{query:Ut({},this.$route.query,{page:1===t?void 0:t})}))}},beforeRouteUpdate:function(t,e,n){this.$vuetify.goTo(0);var a=t.query;this.getPostsOnContext(a),n()},destroyed:function(){At()}},Ft=Rt,Nt=(n("afe5"),n("8212")),Mt=n("b0af"),Bt=n("99d9"),qt=n("cc20"),Jt=n("132d"),Wt=n("adda"),Ht=n("a722"),Yt=n("891e"),Gt=n("8b9c"),zt=n("3129"),Kt=n("2fa4"),Xt=Object(I["a"])(Ft,yt,wt,!1,null,"f37574f4",null),Zt=Xt.exports;R()(Xt,{VAvatar:Nt["a"],VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardTitle:Bt["c"],VChip:qt["a"],VCol:ht["a"],VContainer:mt["a"],VIcon:Jt["a"],VImg:Wt["a"],VLayout:Ht["a"],VPagination:Yt["a"],VParallax:Gt["a"],VRow:vt["a"],VSkeletonLoader:zt["a"],VSpacer:Kt["a"]});var Qt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("blog-toolbar",{attrs:{userData:t.userData,shouldHide:!0}}),n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",xs:"12",sm:"8",md:"4"}},[n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{dark:"",color:"primary"}},[this.$route.query.ported?n("v-btn",{attrs:{text:"",fab:"",onclick:"window.self.close()"}},[n("v-icon",[t._v("close")])],1):n("v-btn",{attrs:{text:"",fab:"",to:"/"}},[n("v-icon",[t._v("arrow_back")])],1),n("v-toolbar-title",[t._v(t._s(t.title))]),n("v-spacer")],1),n("v-card-text",[n("v-alert",{attrs:{type:t.toast.color,transition:"scale-transition",dismissible:""},model:{value:t.toast.show,callback:function(e){t.$set(t.toast,"show",e)},expression:"toast.show"}},[t._v(" "+t._s(t.toast.text)+" ")]),n("h2",{staticClass:"flex text--secondary"},[t._v(t._s(t.message))]),n("v-window",{attrs:{value:t.currentLayer,touchless:""}},[n("v-window-item",{attrs:{value:2}},[t.loading&&!t.loginCode?n("div",[n("h3",{staticClass:"display-1"},[t._v("Please standby...")]),n("v-progress-linear",{attrs:{indeterminate:"",color:"accent"}})],1):t._e()]),n("v-window-item",{attrs:{value:0}},[t.loading||t.loginCode?t._e():n("v-form",{model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{"prepend-icon":"person",name:"username",label:"Username",type:"text",autofocus:"",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.focusPassword(e)}},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),n("v-text-field",{ref:"passWord",attrs:{id:"password","prepend-icon":"lock",name:"password",label:"Password",type:"password",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),n("v-window-item",{attrs:{value:1}},[t.loginCode?n("v-container",[n("v-row",{attrs:{align:"center",justify:"center"}},[t.scannedUsername?n("div",[n("h6",{staticClass:"display-1"},[t._v("Welcome, please confirm:")]),n("h1",{staticClass:"info--text display-3"},[t._v(t._s(t.scannedUsername))])]):n("div",[n("h6",{staticClass:"display-1"},[t._v("Your login code:")]),n("h1",{staticClass:"primary--text display-3"},[t._v(t._s(t.loginCode))])])])],1):t._e()],1),n("v-window-item",{attrs:{value:3}},[n("v-container",[n("v-row",{attrs:{align:"center",justify:"center"}},[n("div",[n("h6",[t._v("One more step")]),n("v-text-field",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.authLoginCode,callback:function(e){t.authLoginCode=e},expression:"authLoginCode"}}),n("v-btn",{attrs:{color:"primary",small:"",rounded:""},nativeOn:{click:function(e){t.forceStep=null}}},[t._v("Give Up")])],1)])],1)],1)],1),!t.loading&&t.hasOauthAdapter?n("v-row",{attrs:{align:"center",justify:"center"}},[n("h4",[t._v("Login using")]),n("div",[n("div",{staticClass:"text-xs-center"},t._l(t.oauthLogin.adapters,(function(e){return n("v-btn",{key:e,staticClass:"ma-1",attrs:{rounded:"",color:"accent",dark:"",loading:t.oauthLogin.loading},on:{click:function(n){return t.redirectOauthLogin(e)}}},[t.$vuetify.icons.values.brand[e]?n("v-icon",[t._v(t._s(t.$vuetify.icons.values.brand[e]))]):n("span",[t._v(t._s(e))])],1)})),1)])]):t._e()],1),n("v-card-actions",[t.oauthLogin.loading?t._e():n("div",[t.loginCode?n("v-btn",{attrs:{color:"info"},on:{click:t.codeLoginCleanUp}},[t._v("With username")]):n("v-btn",{attrs:{color:"secondary"},on:{click:t.codeLogin}},[t._v("With access code")])],1),n("v-spacer"),n("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1),n("toast",t._b({directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],on:{showChange:t.changeToast}},"toast",t.toast,!1))],1)},te=[],ee=(n("a623"),n("fb6a"),n("dfdf")),ne=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.shouldHide?t._e():n("v-app-bar",{attrs:{color:"primary","scroll-off-screen":""}},[t.shouldHaveToolbar?n("v-app-bar-nav-icon",{attrs:{dark:""},nativeOn:{click:function(e){t.drawer=!t.drawer}}}):t._e(),t._t("default"),n("v-toolbar-title",[n("router-link",{staticClass:"themed-text no-deco",attrs:{to:{name:"index"}}},[t._v(t._s(t.title))])],1),n("v-spacer"),t.shouldHaveToolbar?t._e():n("v-toolbar-items",[t.canAskYukina?n("v-btn",{attrs:{dark:"",text:""},on:{click:function(e){t.dialog=!0}}},[n("v-icon",[t._v("question_answer")])],1):t._e(),n("v-btn",{attrs:{dark:"",text:"",to:"/"}},[t._v("Index")]),n("v-btn",{attrs:{dark:"",text:"",to:"/timeline"}},[t._v("Timeline")]),t.userData?n("v-btn",{attrs:{dark:"",text:"",to:"/userspace"}},[t._v(t._s(t.userData.nickname))]):n("v-btn",{attrs:{dark:"",text:"",tag:"a",to:{name:"login"}},on:{contextmenu:function(e){return t.portedLogin(e)}},nativeOn:{click:function(e){return t.setRedirect(e)}}},[t._v("Login ")])],1)],2),t.shouldHaveToolbar&&!t.shouldHide?n("v-navigation-drawer",{attrs:{fixed:"",clipped:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-toolbar",{attrs:{flat:""}},[n("v-list",[n("v-list-item",[n("v-list-item-title",{staticClass:"title"},[t._v(" "+t._s(t.title)+" ")])],1)],1)],1),n("v-divider"),n("v-list",{staticClass:"pt-0",attrs:{dense:""}},[n("v-list-item",{attrs:{to:"/"}},[n("v-list-item-action",[n("v-icon",[t._v("home")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Index")])],1)],1)],1),n("v-list",{staticClass:"pt-0",attrs:{dense:""}},[n("v-list-item",{attrs:{to:"/timeline"}},[n("v-list-item-action",[n("v-icon",[t._v("list_alt")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Timeline")])],1)],1)],1),t.userData?n("v-list",{staticClass:"pt-0",attrs:{dense:""}},[n("v-list-item",{attrs:{to:"/userspace"}},[n("v-list-item-action",[n("v-icon",[t._v("account_circle")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.userData.nickname))])],1)],1)],1):n("v-list",{staticClass:"pt-0",attrs:{dense:""}},[n("v-list-item",{attrs:{to:"/login"},on:{click:t.setRedirect}},[n("v-list-item-action",[n("v-icon",[t._v("person")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Login")])],1)],1)],1),t.canAskYukina?n("v-list",{staticClass:"pt-0",attrs:{dense:""}},[n("v-list-item",{on:{click:function(e){t.dialog=!0}}},[n("v-list-item-action",[n("v-icon",[t._v("question_answer")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Ask Yukina for Help")])],1)],1)],1):t._e()],1):t._e(),t.canAskYukina?n("v-dialog",{attrs:{width:t.responseList.length?1e3:500},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline",attrs:{"primary-title":""}},[t._v(" What do you want to do? ("),n("v-icon",[t._v("fa-flask")]),t._v(" Experimental) ")],1),n("v-container",{attrs:{"grid-list-md":""}},[n("v-row",{attrs:{wrap:""}},[n("v-col",{attrs:{cols:"12"}},[n("v-alert",{attrs:{type:"error",transition:"scale-transition",dismissible:""},model:{value:t.notUnderstand,callback:function(e){t.notUnderstand=e},expression:"notUnderstand"}},[t._v(" Sorry, I don't understand. ")]),t.responseList.length?n("recursive-comments",{ref:"comments",attrs:{comments:t.responseList,canAddComment:!1,canDeleteComment:function(){return!1},myUsername:t.userData&&t.userData.username}}):t._e(),t.loading?n("div",[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}}),t._v(" Practice like you perform, perform like you practice. ")],1):n("v-text-field",{ref:"command",attrs:{"hide-details":"","prepend-icon":"question_answer",label:"Ask Yukina for Help","single-line":"",autofocus:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.runCommand(e)}},model:{value:t.command,callback:function(e){t.command=e},expression:"command"}})],1)],1)],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialog=!1}}},[t._v(" Close ")])],1)],1)],1):t._e(),t.canAskYukina?n("GlobalEvents",{on:{keyup:[function(e){return(e.type.indexOf("key")||89===e.keyCode)&&e.ctrlKey?void(t.dialog=!t.dialog):null},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.dialog=!1}]}}):t._e()],1)},ae=[],re=n("17d3"),oe=n("8414"),se=n("1e06"),ie=n("48d3");function ce(t){return le(t)?t.author.nickname:t.nickname}function le(t){return!!t.author}var ue=ie["componentFactoryOf"]().create({name:"recursive-comment",props:{comments:{type:Array,required:!0},canAddComment:{type:Boolean,default:!0},canDeleteComment:{type:Function},postAuthorUsername:String,myUsername:String},render:function(){var t=arguments[0];return t(ht["a"],{attrs:{cols:10,sm:7,"offset-sm":2}},[this.renderComments(this.comments)])},methods:{renderComments:function(t){var e=this,n=this.$createElement;return n(oe["a"],{attrs:{dense:!0,"align-top":!0}},[n(M["f"],{attrs:{group:!0}},[t.map((function(t){return n(se["a"],{key:t.id,class:"mb-3",attrs:{"fill-dot":!0,color:t.color||(t.author?"accent":"#bbbbbb"),id:"comment-".concat(t.id)}},[t.author&&t.author.avatar?n(Nt["a"],{slot:"icon"},[n(Wt["a"],{attrs:{src:t.author.avatar}})]):null,n(vt["a"],{attrs:{justify:"space-between"}},[n(ht["a"],{attrs:{cols:7}},[e.infoLabel(ce(t),t.color||(t.author?"secondary":"#bbbbbb"),!1,e.getUsername(t)?{name:"userTimeline",params:{username:e.getUsername(t)}}:void 0),e.myUsername&&_(e.getUsername(t),e.myUsername)?e.infoLabel("You","accent",!0):e.postAuthorUsername&&_(e.getUsername(t),e.postAuthorUsername)?e.infoLabel("Author","accent",!0):null,n("div",{domProps:{innerHTML:t.content}}),e.canAddComment&&n(dt["a"],{attrs:{text:!0,icon:!0},on:{click:function(){return e.$emit("reply-comment",t.id)}}},[n(Jt["a"],["reply"])]),e.canDeleteComment(t)?n(dt["a"],{attrs:{text:!0,icon:!0,color:"error",small:!0},on:{click:function(){return e.$emit("delete-comment",t.id)}}},[n(Jt["a"],["delete"])]):null]),n(ht["a"],{attrs:{cols:5},class:"text-right"},[st.formatDate(t.createdAt)])]),n(vt["a"],{attrs:{"no-gutters":!0,dense:!0,justify:"start"}},[n(ht["a"],{attrs:{cols:12}},[t.replies.length?n("div",[e.renderComments(t.replies)]):null])])])}))])])},getUsername:function(t){return function(t){return t.author&&t.author.username}(t)},infoLabel:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,r=this.$createElement,o=this.$vuetify.theme.currentTheme[e]||e,s=r(qt["a"],{attrs:{small:!0,color:e,outlined:n,to:a},class:{"ml-0":!0,"white--text":!n&&O(o,!1,!0,!0)}},[t]);return a?r("router-link",{attrs:{to:a}},[s]):s}}}),de={name:"blog-toolbar",components:{GlobalEvents:re["a"],RecursiveComments:ue},props:["userData","route","realTitle","noDrawer","shouldHide"],data:function(){return{drawer:!1,dialog:!1,command:"",loading:!1,notUnderstand:!1,responseList:[],userMeta:{}}},methods:{setRedirect:function(){st.setRedirect(this.route)},portedLogin:function(t){t.preventDefault();var e=window.open(this.$router.resolve({name:"login",query:{ported:!0}}).href,"loginWindow","height=400,width=400,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no"),n=this.$watch("userData",(function(t){t&&(e.close(),n())}));e.addEventListener("close",n)},runCommand:function(){var t=this;this.loading=!0,Pt(this.command).then((function(e){if(t.loading=!1,!e)return Promise.reject("Not understand");t.dialog=!1})).catch(this.askYukina)},askYukina:function(){var t=this;this.responseList=[].concat(Object(c["a"])(this.responseList),[{id:Math.round(233*Math.random()),content:this.command,replies:[],createdAt:(new Date).toLocaleTimeString(),author:this.userMeta.username?this.userMeta:this.userData,nickname:"New Staff",color:"accent"}]),this.loading=!0,jt(this.command).then((function(e){t.responseList=[].concat(Object(c["a"])(t.responseList),[{id:Math.round(233*Math.random()),content:e,replies:[],createdAt:(new Date).toLocaleTimeString(),author:{nickname:"Yukina (Bot)",avatar:"https://img.lisa.moe/images/2019/04/15/GQ6GLDt_.jpg"}}]),t.loading=!1,t.command=""})).catch((function(e){t.loading=!1,t.notUnderstand=!0}))}},computed:{title:function(){return this.realTitle||Z.title},shouldHaveToolbar:function(){return!this.noDrawer&&this.$vuetify.breakpoint.smAndDown},canAskYukina:function(){return Z.enableAskYukina}},watch:{shouldHaveToolbar:function(t){t||(this.drawer=!1)},dialog:function(t){var e=this;t&&(this.$nextTick((function(){return e.$refs.command.focus()})),this.userMeta.username||st.fetchJSONWithSuccess(st.apiFor("user","user-meta"),"GET",{username:this.userData.username}).then((function(t){e.userMeta=y(t)})))},userData:function(){this.userMeta={},this.responseList=[]}}},he=de,me=n("0798"),fe=n("40dc"),pe=n("5bc1"),ve=n("169a"),ge=n("8860"),be=n("da13"),ye=n("1800"),we=n("5d23"),ke=n("f774"),_e=n("8654"),De=n("71d9"),xe=n("2a7f"),Ce=Object(I["a"])(he,ne,ae,!1,null,"3863fa3e",null),Oe=Ce.exports;function Te(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Pe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Te(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Te(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}R()(Ce,{VAlert:me["a"],VAppBar:fe["a"],VAppBarNavIcon:pe["a"],VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardTitle:Bt["c"],VCol:ht["a"],VContainer:mt["a"],VDialog:ve["a"],VDivider:ft["a"],VIcon:Jt["a"],VList:ge["a"],VListItem:be["a"],VListItemAction:ye["a"],VListItemContent:we["a"],VListItemTitle:we["b"],VNavigationDrawer:ke["a"],VProgressCircular:pt["a"],VRow:vt["a"],VSpacer:Kt["a"],VTextField:_e["a"],VToolbar:De["a"],VToolbarItems:xe["a"],VToolbarTitle:xe["b"]});var Se={components:{BlogToolbar:Oe},data:function(){return{loading:!1,title:Z.title,toast:{show:!1,text:"",color:""},username:"",password:"",rules:[function(t){return!!t||"Required"},function(t){return t&&t.length>4&&t.length<20||"Length is not valid"}],valid:!1,loginCode:"",scannedUsername:"",focusAt:!1,oauthLogin:{loading:!1,adapters:[]},authLoginCode:"",forceStep:0,redirectLock:!1}},props:{userData:Object},methods:{login:function(){var t=this;this.valid&&(this.$emit("beforeLogin"),this.loading=!0,st.fetchJSON(st.apiFor("login"),"POST",{username:this.username,password:this.password,code:this.authLoginCode},!1).then((function(e){if(!e.success)return e.totp&&(t.forceStep=3,!t.authLoginCode)?Promise.reject({msg:"Please enter two step authentication code",color:"info"}):Promise.reject(e.msg);t.setLoginData({username:t.username,token:e.token,role:e.role,rftoken:e.rftoken}).then((function(){return t.redirectBack()}))})).catch((function(e){e.color?t.showToast(e.msg,e.color):t.showToast(e,"error"),t.loading=!1})))},redirectBack:function(){this.redirectLock||(this.$router.push(this.redirection),this.redirectLock=!0)},showToast:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.toast.show=!1,this.toast.text=t.toString(),this.toast.color=e,this.toast.show=!0},changeToast:function(t){this.toast.show=t},cleanUp:function(){st.cleanRedirect(),window.sessionStorage.removeItem("message")},setLoginData:function(t){var e=t.username,n=Object(ee["a"])(t,["username"]);return st.fetchJSONWithSuccess(st.apiFor("user","user-meta"),"GET",{username:e}).then((function(t){var e=t.username,a=t.nickname;st.setLoginData(Pe({username:e,nickname:a},n))})).catch((function(t){st.setLoginData(Pe({username:e,nickname:e},n))}))},tokenLogin:function(t){var e=this;return this.loading=!0,st.fetchJSON(st.apiFor("login","token"),"POST",{token:t},!1).then((function(n){if(!n.success)return Promise.reject(n.msg);e.setLoginData({username:n.payload.username,token:t,role:n.payload.role}).then((function(){return e.redirectBack()}))})).catch((function(t){return e.loading=!1,e.showToast(t,"error"),Promise.reject(t)})).finally(this.cleanUp)},getLoginCode:function(){return st.fetchJSON(st.apiFor("login","code","gen")).then((function(t){return t.code}))},codeLoginTriggers:function(){var t=this;this.codeChecker=setInterval((function(){t.loginCode&&st.fetchJSON(st.apiFor("login","code",t.loginCode),"POST",{},!1).then((function(e){if(e.success){var n=e.data;n.username&&(t.scannedUsername=n.username),n.token&&t.setLoginData({username:n.username,role:n.role,token:n.token}).then((function(){return t.redirectBack()}))}})).catch((function(e){t.showToast("Unstable network may affect remote login.","warning")}))}),3e3),this.codeLoginCleaner=setTimeout((function(){return t.codeLoginCleanUp()}),6e4)},codeLogin:function(){var t=this;this.loading=!0,this.loginCode="Loading...",this.getLoginCode().then((function(e){t.loginCode=(Array(6).join("0")+e).slice(-6)})).then((function(e){t.codeLoginTriggers()})).catch((function(e){t.showToast(e,"error"),t.codeLoginCleanUp()}))},codeLoginCleanUp:function(){this.codeChecker&&clearInterval(this.codeChecker),this.codeLoginCleaner&&clearTimeout(this.codeLoginCleaner),this.loading=!1,this.loginCode="",this.scannedUsername=""},focusPassword:function(){var t=this;this.rules.map((function(e){return e(t.username)})).every((function(t){return!0===t}))&&this.$refs.passWord.focus()},getAdapters:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("login","oauth","adapters")).then((function(e){t.oauthLogin.adapters=e})).catch((function(e){t.showToast(e,"error")}))},redirectOauthLogin:function(t){var e=this;this.oauthLogin.loading=!0,st.fetchJSONWithSuccess(st.apiFor("login","oauth",t,"url"),"GET",{base:window.location.href.split("?")[0],redirect:this.redirection}).then((function(t){e.loading=!0,window.location.href=t})).catch((function(t){e.oauthLogin.loading=!1,e.showToast(t,"error")}))}},computed:{redirection:function(){return this.$route.params.redirect||this.$route.query.redirect||st.getRedirect()||"/"},message:function(){return window.sessionStorage.getItem("message")||this.$route.params.message||"Login"},hasOauthAdapter:function(){return this.oauthLogin.adapters.length>0},currentLayer:function(){if(this.forceStep)return this.forceStep;var t=!!this.loading<<1|!!this.loginCode;return 1&t||2&t}},mounted:function(){var t=this;if(this.userData&&(this.$route.params.logout?(st.removeLoginData(),this.showToast("Logged out!")):this.redirectBack()),this.$route.query.alertText){var e=this.$route.query,n=e.alertText,a=e.alertColor;this.$router.replace(Pe({},this.$route,{params:Pe({},this.$route.params,{alert:{text:n,color:a}}),query:Pe({},this.$route.query,{alertColor:void 0,alertText:void 0})})),this.showToast(n,a)}if(this.$route.params.alert){var r=this.$route.params.alert,o=r.color,s=r.text;this.showToast(s,o)}var i=st.getArguments.call(this).token;if(i&&this.tokenLogin(i).catch((function(e){t.getAdapters(),t.$router.replace(Pe({},t.$route,{query:Pe({},t.$route.query,{token:void 0})}))})),this.$route.params.credential){var c=this.$route.params.credential,l=c.username,u=c.password;this.username=l||this.username,this.password=u||this.password,this.username&&this.password&&this.login(),this.username&&this.focusPassword()}i||this.getAdapters()},watch:{userData:function(t){t&&this.redirectBack()}},destroyed:function(){this.oauthLogin.loading||this.cleanUp(),this.codeLoginCleanUp()}},je=Se,Le=n("4bd4"),Ve=n("8e36"),Ee=n("f665"),$e=n("1e6c"),Ae=Object(I["a"])(je,Qt,te,!1,null,null,null),Ie=Ae.exports;R()(Ae,{VAlert:me["a"],VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardText:Bt["b"],VCol:ht["a"],VContainer:mt["a"],VForm:Le["a"],VIcon:Jt["a"],VProgressLinear:Ve["a"],VRow:vt["a"],VSpacer:Kt["a"],VTextField:_e["a"],VToolbar:De["a"],VToolbarTitle:xe["b"],VWindow:Ee["a"],VWindowItem:$e["a"]});var Ue=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"post"}},[n("nav-bar",{attrs:{userData:t.userData,route:t.$route.fullPath}}),t.postData.img?n("v-parallax",{class:{"blur-image":t.extraDisplaySettings.blurMainImage,"blur-image-transition":!0},attrs:{id:"main-pic",dark:"",src:t.postData.img||t.config.images.postBannerImage}},[t.extraDisplaySettings.metaBelowImage?t._e():n("v-row",{class:t.titleClass,attrs:{align:"center",column:"",justify:"center"}},[n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[n("h1",{staticClass:"display-2 font-weight-thin mb-3",attrs:{id:"title"}},[t._v(t._s(t.postData.title))]),n("h4",{staticClass:"subtitle-1",attrs:{id:"subtitle"}},[t._v(t._s(t.postData.subtitle))]),n("h4",{staticClass:"subtitle-1",attrs:{id:"date"}},[t._v(t._s(t.formatDate(t.postData.created)||t.postData.date))]),n("h4",{staticClass:"subtitle-2",attrs:{id:"author"}},[t._v(t._s(t.postData.author.nickname))])])],1)],1):t._e(),!t.postData.img||t.extraDisplaySettings.metaBelowImage?n("v-container",[n("v-row",{attrs:{align:"center",column:"",justify:"center"}},[n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[n("h1",{staticClass:"display-3 font-weight-thin mb-3",attrs:{id:"title"}},[t._v(t._s(t.postData.title))]),n("h2",{staticClass:"subtitle-1",attrs:{id:"subtitle"}},[t._v(t._s(t.postData.subtitle))]),n("h4",{staticClass:"subtitle-1",attrs:{id:"date"}},[t._v(t._s(t.formatDate(t.postData.created)||t.postData.date))]),n("h4",{staticClass:"subtitle-2",attrs:{id:"author"}},[t._v(t._s(t.postData.author.nickname))])])],1)],1):t._e(),n("v-container",{staticClass:"fill-height",attrs:{"grid-list-md":"",fluid:""}},[n("v-row",[n("v-col",{attrs:{wrap:"",cols:"12",sm:"10","offset-sm":"2"}},[n("v-row",[t._l(t.postData.tags,(function(e){return n("router-link",{key:e,attrs:{to:{name:"index",params:{tag:e},query:{tag:e}}}},[n("v-chip",{staticClass:"ma-1"},[t._v(t._s(e))])],1)})),t.postData.secret?n("v-chip",{staticClass:"ma-1",attrs:{color:"success","text-color":"white"}},[n("v-avatar",{staticClass:"success",attrs:{left:""}},[n("v-icon",[t._v("lock")]),t._v(t._s(t.postData.secret)+" ")],1),t._v(" Secret ")],1):t._e(),-1===t.postData.id?n("v-chip",{staticClass:"ma-1",attrs:{color:"warning","text-color":"white"}},[n("v-avatar",{attrs:{left:""}},[n("v-icon",[t._v("error")])],1),t._v(" 404 ")],1):t._e(),t.postData.hidden?n("v-chip",{staticClass:"ma-1",attrs:{color:"grey","text-color":"white"}},[n("v-avatar",{attrs:{left:""}},[n("v-icon",[t._v("visibility_off")])],1),t._v(" Hidden ")],1):t._e()],2),n("v-col",{attrs:{cols:"12",md:"10"}},[n("v-row",[t.cachedData?n("v-btn",{attrs:{color:"secondary",fab:"",small:""},on:{click:function(e){return t.$router.go(-1)}}},[n("v-icon",[t._v("arrow_back")])],1):t._e(),n("v-spacer"),"preview"!==t.postData.id&&-1!==t.postData.id&&t.isEditable?n("div",[n("v-btn",{staticClass:"ma-3",attrs:{color:"error",fab:"",small:"",to:{name:"edit",params:{deletePost:!0,title:t.postData.title},query:{post:t.postData.id}}}},[n("v-icon",[t._v("delete")])],1),n("v-btn",{staticClass:"ma-3",attrs:{color:"primary",fab:"",small:"",to:{name:"edit",query:{post:t.postData.id}}}},[n("v-icon",[t._v("mode_edit")])],1)],1):t._e(),t.isPostFound&&!t.isShared?n("v-btn",{staticClass:"ma-3",attrs:{fab:"",small:"",color:"secondary"},on:{click:t.sharePost}},[n("v-icon",[t._v("share")])],1):t._e()],1),n("v-row",[n("v-col",{attrs:{cols:"12"}},["preview"===t.postData.id&&!t.postData.serverRendered&&t.postData.markdownContent?n("v-alert",{attrs:{border:"left",prominent:"","colored-border":"",type:"info",elevation:"2"}},[n("v-row",{attrs:{align:"center"}},[n("v-col",[t._v(" This page is rendered by your browser. "),n("v-btn",{attrs:{loading:t.loading},on:{click:t.renderPreviewByServer}},[t._v("Render it via server")])],1)],1)],1):t._e()],1)],1)],1),n("v-row",[n("v-col",{attrs:{sm:t.hasDigest?8:10}},[n("div",{ref:"content",staticClass:"flow-text responsive-img",attrs:{id:"content"}},[t.rsRendered?n("div",{ref:"rhodonite"}):n("div",{domProps:{innerHTML:t._s(t.postData.content)}})]),t.postData.id<0?n("div",{staticClass:"flow-text"},[n("p",[t._v("Oops, we can not show you the post.")]),n("p",[n("strong",[t._v("This may because:")])]),n("ol",[n("li",[t._v("Your post ID is invalid.")]),n("li",[t._v("This post is secret"),t.userData?n("strong",[t._v(" and even beyond your permission level")]):t._e(),t._v(".")]),t.userData&&t.isTokenExpired?n("li",{staticClass:"warning--text"},[n("v-icon",{attrs:{color:"warning"}},[t._v("warning")]),t._v("Your session is expired.")],1):t._e(),n("li",[t._v("Your network condition is poor.")])]),n("p",[n("strong",[t._v("All you need to do is check your input, refresh your token or try to login again.")])])]):t._e()]),t.hasDigest?n("v-col",{attrs:{sm:"2"}},[n("blog-digest-nav",{attrs:{items:t.postDigest,offset:"500",threshold:"500"}})],1):t._e()],1),n("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.postData.title,expression:"postData.title"}]})],1)],1)],1),t.postData.author?n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{justify:"center"}},[t.postData.author.avatar?n("div",[n("v-avatar",{staticClass:"elevation-7"},[n("v-img",{attrs:{src:t.postData.author.avatar,alt:t.postData.author.username}})],1)],1):t._e(),t.postData.author&&t.postData.author.username?n("div",[n("router-link",{attrs:{to:{name:"userTimeline",params:{username:t.postData.author.username}}}},[n("v-chip",[t._v(" @"+t._s(t.postData.author.username)+" ("+t._s(t.postData.author.nickname)+") ")])],1)],1):t._e()])],1):t._e(),n("v-container",[n("div",{staticClass:"text-center"},[n("h4",{staticClass:"subtitle-1 grey--text"},[t._v("Last edit at: "+t._s(t.formatDate(t.postData.lastEdit,!0)))])])]),n("v-container",[n("v-col",{attrs:{cols:"12",sm:"10","offset-sm":"1"}},[n("v-row",[-1!==t.postData.next?n("v-btn",{attrs:{color:"primary",fab:!t.nextMeta||!t.shouldDisplayAdjacentMeta,rounded:!!t.nextMeta,small:!t.nextMeta||!t.shouldDisplayAdjacentMeta,to:{name:"post",query:{p:t.postData.next}}}},[n("v-icon",[t._v("chevron_left")]),t._v(t._s(t.shouldDisplayAdjacentMeta&&t.nextMeta?t.nextMeta.title:"")+" ")],1):t._e(),n("v-spacer"),-1!==t.postData.prev?n("v-btn",{attrs:{color:"primary",fab:!t.prevMeta||!t.shouldDisplayAdjacentMeta,rounded:!!t.prevMeta,small:!t.prevMeta||!t.shouldDisplayAdjacentMeta,to:{name:"post",query:{p:t.postData.prev}}}},[t._v(" "+t._s(t.shouldDisplayAdjacentMeta&&t.prevMeta?t.prevMeta.title:"")),n("v-icon",[t._v("chevron_right")])],1):t._e()],1)],1),t.isPostFound?n("blog-comments",{attrs:{userData:t.userData,postData:t.postData,toast:t.showToast,renderer:t.renderer}}):t._e()],1),n("v-slide-x-transition",[n("v-menu",{attrs:{"offset-y":"","position-x":t.preview.x,"position-y":t.preview.y},model:{value:t.preview.show,callback:function(e){t.$set(t.preview,"show",e)},expression:"preview.show"}},[n("v-card",{attrs:{color:t.preview.color,dark:"",width:"300"}},[t.preview.img?n("v-img",{attrs:{src:t.preview.img}}):t._e(),n("v-card-text",[t.preview.loading?t._e():n("div",[n("h1",{staticClass:"title"},[n("strong",[t._v(t._s(t.preview.title))])]),n("v-spacer"),n("h6",{staticClass:"subtitle-1 text-truncate"},[t._v(t._s(t.preview.subtitle))])],1),t.preview.loading?n("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}}):t._e()],1)],1)],1)],1),n("toast",{attrs:{color:t.toast.color,text:t.toast.text},on:{showChange:t.changeToast},model:{value:t.toast.show,callback:function(e){t.$set(t.toast,"show",e)},expression:"toast.show"}}),n("blog-footer"),n("GlobalEvents",{on:{mousemove:t.mouseMoveHandler}}),n("v-dialog",{attrs:{width:"500"},model:{value:t.share.open,callback:function(e){t.$set(t.share,"open",e)},expression:"share.open"}},[n("v-card",[n("v-card-title",{staticClass:"headline primary",attrs:{"primary-title":""}},[t._v(" Share "+t._s(t.postData.title)+" ")]),n("v-card-text",[n("v-text-field",{attrs:{label:"Address",outlined:"",value:t.sharePath,readonly:""}}),n("a",{attrs:{href:t.sharePath}},[t._v("Shared_"+t._s(t.postData.title))]),t._v(" <- Right click and copy link. "),n("p",[t._v("This post will be visible regardless of the user privileges.")])],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"accent",text:""},on:{click:function(e){t.share.open=!1}}},[t._v(" Done ")])],1)],1)],1)],1)},Re=[],Fe=(n("a630"),n("c975"),n("b0c0"),n("a9e3"),n("4d63"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"digestNav",staticClass:"hide-on-small-only pushpin",attrs:{id:"digest-nav"}},[n("ul",{staticClass:"section table-of-contents"},t._l(t.items,(function(e){var a=e.hash,r=e.title;return n("li",{key:a},[n("a",{attrs:{href:"#"+a,to:{hash:a,query:t.$route.query}}},[t._v(t._s(r))])])})),0)])}),Ne=[],Me=n("4d5c"),Be=n.n(Me),qe={name:"blog-digest-nav",data:function(){return{}},props:{items:Array},methods:{onCreate:function(){var t=this;this.$nextTick((function(e){return t.processDigest()}))},processDigest:function(){var t=document.querySelectorAll(".scrollspy"),e=document.getElementById("content");this.instance=Be.a.ScrollSpy.init(t),Be.a.Pushpin.init(document.querySelectorAll(".pushpin"),{top:e.offsetTop,offset:150,bottom:e.offsetHeight+e.offsetTop-this.$refs.digestNav.offsetHeight})},getInstance:function(){return Be.a.ScrollSpy.getInstance(this.targetElements())}},computed:{targetElements:function(){return this.items.map((function(t){return t.element}))}},mounted:function(){this.onCreate()},destroyed:function(){this.getInstance().destroy()},watch:{items:function(){this.onCreate()}}},Je=qe,We=(n("c389"),n("c293"),Object(I["a"])(Je,Fe,Ne,!1,null,"6e2088a0",null)),He=We.exports,Ye=(n("e01a"),n("81b8"),n("4ec9"),n("8a79"),n("498a"),function t(e,n){Object(P["a"])(this,t),this.template=e,this.returnValue=n}),Ge=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{row:"",justify:"center"}},[n("v-dialog",{attrs:{width:"400"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v(t._s(t.title))]),n("v-card-text",[t._v(" "+t._s(t.message)+" ")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary"},on:{click:t.commitReject}},[t._v(" Disagree ")]),n("v-btn",{attrs:{color:"primary",text:""},on:{click:t.commitConfirm}},[t._v(" Agree ")])],1)],1)],1)],1)},ze=[],Ke=n("8b83"),Xe=n("c65a"),Ze=n("c03e"),Qe=n("9ab4"),tn=n("60a3"),en=function(t){function e(){var t;return Object(P["a"])(this,e),t=Object(Ke["a"])(this,Object(Xe["a"])(e).apply(this,arguments)),t.dialog=!0,t.isConfirmed=!1,t}return Object(Ze["a"])(e,t),Object(S["a"])(e,[{key:"onDialogChanged",value:function(t,e){e||(this.isConfirmed||this.onReject(),this.$destroy(),this.cleanUp&&this.cleanUp())}},{key:"commitConfirm",value:function(){this.isConfirmed=!0,this.onConfirm(),this.dialog=!1}},{key:"commitReject",value:function(){this.isConfirmed=!1,this.onReject(),this.dialog=!1}}]),e}(tn["c"]);Qe["a"]([Object(tn["b"])(Function)],en.prototype,"onConfirm",void 0),Qe["a"]([Object(tn["b"])(Function)],en.prototype,"onReject",void 0),Qe["a"]([Object(tn["b"])(Function)],en.prototype,"cleanUp",void 0),Qe["a"]([Object(tn["b"])(String)],en.prototype,"title",void 0),Qe["a"]([Object(tn["b"])(String)],en.prototype,"message",void 0),Qe["a"]([Object(tn["d"])("dialog")],en.prototype,"onDialogChanged",null),en=Qe["a"]([tn["a"]],en);var nn=en,an=nn,rn=Object(I["a"])(an,Ge,ze,!1,null,null,null),on=rn.exports;R()(rn,{VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardText:Bt["b"],VCardTitle:Bt["c"],VDialog:ve["a"],VLayout:Ht["a"],VSpacer:Kt["a"]});var sn=function(t,e){return new a["default"]({render:function(e){return e(on,{props:t})}}).$mount(e)};function cn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ln(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cn(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cn(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function un(t){if(!window.APlayer){var e=document.createElement("script"),n=document.createElement("link");n.rel="stylesheet",n.href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css",e.async=!0,e.onload=t||null,e.src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js",document.head.appendChild(n),document.body.appendChild(e)}}function dn(t){var e=document.createElement("div");return e.innerHTML=t.replace(/<em>(.*?)<\/em>/,(function(t,e){return"*".concat(e,"*")})),e.innerText||e.textContent}function hn(t){return t instanceof Array?t.map(hn).join(""):(t instanceof Ye&&(t=t.template),t instanceof HTMLElement?t.outerHTML:at["isNumber"](t)||at["isString"](t)?t:"")}function mn(t,e,n){return t.replace(new RegExp((e||["{{","}}"]).join("\\s*?(([\\s\\S]+?))\\s*?"),"gm"),n)}function fn(t,e,n){var a=function(t){return"with(data) { with(functions) {return (".concat(t,");}}")},r=function(t){if(!Z.enableRoseliaScript)return"<pre><code>".concat(t,"</code></pre>");try{var n,r=/([a-zA-Z_$]+[a-zA-Z_0-9]*){([\s\S]+)}/.exec(t),o=!1;if(r){var s=Object(u["a"])(r,3),i=(s[0],s[1]),c=s[2],l=e[i]||e.functions[i];at["isFunction"](l)&&(n=l(dn(c)),o=!0)}return o||(t=dn(t),n=new Function("data",a(t))(e)),hn(n)}catch(d){return console.log("On rendering:",t),console.error(d),t}};return mn(t,n,(function(t,e){var n=e.trim(),a=!n.endsWith(";"),o=a?n:n.substring(0,n.length-1),s=r(o);return a?s:""}))}function pn(t,e){var n=new WeakMap;if(e){var a=function(t){return new Proxy({},{get:function(){return null}})};e.forEach((function(e){return t[e]=a(e)}))}var r={get:function(t,e){var a=Reflect.get(t,e);return at["isFunction"](a)?(n.has(a)||n.set(a,a.bind(t)),n.get(a)):a}};return new Proxy(t,r)}function vn(t){return new Proxy(t,{has:function(t,e){return!0},get:function(t,e){if(e!==Symbol.unscopables)return Reflect.get(t,e)}})}var gn=Symbol("yukina"),bn=ln({},Z.theme),yn=function(){function t(e){Object(P["a"])(this,t),this.app=e,this.scriptEvaluator=new wn(e),this.context=vn(pn(this.scriptEvaluator))}return Object(S["a"])(t,[{key:"render",value:function(e){this.scriptEvaluator.pendingFunctions=[];try{this.toInject=this.app;var n=fn(e,this.context,t.roseliaScriptDelim);return n}catch(a){return console.error(a),e}}},{key:"cleanScript",value:function(e){return mn(e,t.roseliaScriptDelim,(function(t){return""}))}},{key:"renderAsync",value:function(){var t=Object(kt["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return t(n.render(e))})).then((function(t){return t})));case 1:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderVue",value:function(t){var e=this,n=this.scriptEvaluator.randomID(),r=new a["default"]({template:'<div id="'.concat(n,'">')+this.render(t)+"</div>",data:this.scriptEvaluator.functions,delimiters:["v{{","}}"]});return this.toInject=r,Object.defineProperty(r,"autoInject",{value:function(){r.$mount(document.getElementById(n)),r.$nextTick((function(){return e.injectEvents()}))}}),r}},{key:"renderVueAsync",value:function(){var t=Object(kt["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return t(n.renderVue(e))})));case 1:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"injectEvents",value:function(){this.scriptEvaluator.injectEventsOn(this.toInject)}},{key:"pushContext",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"context";return this.scriptEvaluator.def(n,t),function(){e.scriptEvaluator.undef(n)}}},{key:"pushMethod",value:function(t,e){var n=this;return this.pushContext((function(){return t(n.context).apply(void 0,arguments)}),e)}}]),t}();yn.roseliaScriptDelim=["(?:Roselia|roselia|r|R){{","}}"];var wn=function(){function t(e){var n=this;Object(P["a"])(this,t),this.Y=function(t){return function(t){return t(t)}((function(e){return t((function(t){return e(e)(t)}))}))},this.request={get:function(t,e){return n.askForAccess("fetch","This post would like to fetch data","It wants to access ".concat(t,".")).then((function(){return nt.get(t,{params:e}).then((function(t){return t.data}))}))}},this.app=e,this.customFunctions={app:null},this.functions=pn(this.customFunctions),this.app.$on("postUnload",(function(){n.customFunctions={app:null},n.functions=pn(n.customFunctions),n.mounted=!1})),this.askAccess=new Map,this.pendingFunctions=[],this.mounted=!1}return Object(S["a"])(t,[{key:"then",value:function(t){this.mounted?this.app.$nextTick(t):this.pendingFunctions.push(t)}},{key:"injectEventsOn",value:function(t){this.pendingFunctions.forEach(function(){var e=Object(kt["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.$nextTick(n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.pendingFunctions=[],this.mounted=!0}},{key:"music",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;un((function(){return e.app.$emit("aPlayerLoaded")}));var r,o=this.randomID();return this.then((function(){var s=function(){var e=document.getElementById(o);r=new window.APlayer({container:e,narrow:!1,autoplay:n,mutex:!0,theme:Z.theme.accent,mode:"circulation",showlrc:1,preload:"metadata",audio:t}),r.on("loadstart",(function(){Array.from(e.getElementsByClassName("aplayer-title")).forEach((function(t){t&&(t.style.color=Z.theme.secondary)})),a&&a(r)}))};window.APlayer?e.then(s):e.app.$once("aPlayerLoaded",(function(){e.then(s)})),e.app.$once("postUnload",(function(){r.destroy()}))})),new Ye('<div id="'.concat(o,'"></div>'),r)}},{key:"heimu",value:function(t){var e=this.randomID();return new Ye('<span class="heimu" id="'.concat(e,'">').concat(t,"</span>"),e)}},{key:"cite",value:function(t,e){return'<a href="post?p='.concat(e,'">').concat(t,"</a>")}},{key:"randomID",value:function(t){return Number(Math.random().toString().substring(3,t)+Date.now()).toString(36)}},{key:"onceLoad",value:function(t){this.app.$once("postLoaded",t)}},{key:"onceUnload",value:function(t){this.app.$once("postUnload",t)}},{key:"extendAttributes",value:function(t,e){this.element(t).then((function(t){at["merge"](t,e)}))}},{key:"btn",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0,r=this.randomID();return n instanceof Array&&(n=n.join(" ")),e&&this.then((function(){document.getElementById(r).addEventListener("click",e)})),a&&this.extendAttributes(r,a),new Ye('<button id="'.concat(r,'" class="v-btn v-btn--contained v-size--default ').concat(n,'">').concat(t,"</button>"),r)}},{key:"toast",value:function(t,e){this.app.showToast(t,e||"info")}},{key:"formula",value:function(t){return"$ ".concat(t," $")}},{key:"formulation",value:function(t){return"$$ ".concat(t," $$")}},{key:"formulationEscape",value:function(){var t=this,e=[["$$","$$"],["$","$"],["\\(","\\)"]];e.map((function(t){return t.map((function(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")})).join("\\s*(.*?)\\s*")})).map((function(t){return new RegExp(t,"gms")})).forEach((function(e){t.app.postData.content=t.app.postData.content.replace(e,(function(t,e){return dn(e)}))}))}},{key:"importJS",value:function(t,e){var n=document.createElement("script");n.onload=e,n.async=!0,n.src=t,document.body.appendChild(n)}},{key:"def",value:function(t,e){return e instanceof Ye?(this.customFunctions[t]=e.returnValue,e.template):(this.customFunctions[t]=e,at["isString"](e)||e instanceof HTMLElement?e:void 0)}},{key:"undef",value:function(t){this.customFunctions[t]=void 0}},{key:"audio",value:function(t){var e=this.randomID();return new Ye("<audio id='".concat(e,"' src='").concat(t,"' hidden='true'/>"),e)}},{key:"getElement",value:function(t){if(t instanceof HTMLElement&&(t=t.id),t instanceof Ye&&(t=at["isString"](t.returnValue)?t.returnValue:t.template),at["isString"](t)){var e=/id=['"]([a-zA-Z0-9-]+)['"]/.exec(t);e&&(t=e[1])}t instanceof HTMLElement&&(t=t.id);var n=t in this.functions?this.functions[t]:t;return document.getElementById(n instanceof Element?n.id:n)}},{key:"raw",value:function(t){return"<pre>Roselia{{".concat(t,"}}</pre>")}},{key:"previewColor",value:function(t){var e=this,n=this.app.preview.color;this.app.preview.color=t,this.onceUnload((function(){e.app.preview.color=n}))}},{key:"element",value:function(t){var e=this;return new Promise((function(n,a){var r=e.getElement(t);if(r)return n(r);e.then((function(){var r=e.getElement(t);r?n(r):a()}))}))}},{key:"createElement",value:function(t,e){var n=document.createElement(t);return n.id=this.randomID(),e&&this.extendAttributes(n,e),n}},{key:"setPreview",value:function(t,e){var n=this;this.element(t).then((function(t){t.addEventListener("mouseover",(function(a){a.preventDefault(),n.app.preview.show=!0,n.app.preview.attach=t,n.app.preview.cacheData=null,n.app.preview.current=n.app.postData.id,["title","subtitle","img","color"].forEach((function(t){var a=e[t];at["isNil"](a)||(n.app.preview[t]=a)}))})),t.addEventListener("mouseout",(function(t){t.preventDefault(),n.app.preview.show=!1})),at["isNil"](e.goTo)||t.addEventListener("click",(function(t){t.preventDefault();try{n.app.$vuetify.goTo(at["isNumber"](e.goTo)?e.goTo:n.getElement(e.goTo),{offset:-200})}catch(a){at["isString"](e.goTo)?location.href=e.goTo:n.app.$router.push(e.goTo),console.error(a)}}))}))}},{key:"previewed",value:function(t,e){return this.setPreview(t,e),t}},{key:"doTo",value:function(t,e){return this.element(t).then(e),t}},{key:"icon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e instanceof Array&&(e=e.join(" ")),t.startsWith("fa")){var n=t.split("-"),a=Object(u["a"])(n,2),r=a[0],o=a[1];return'<i aria-hidden="true" class="v-icon '.concat(r," fa-").concat(o," ").concat(e,'"></i>')}return'<i aria-hidden="true" class="v-icon material-icons '.concat(e,'">').concat(t,"</i>")}},{key:"askForAccess",value:function(t,e,n){var a=this;return new Promise((function(r,o){if(a.onceUnload((function(){return a.askAccess.clear()})),a.askAccess.has(t))a.askAccess.get(t)?r():o();else{var s=a.createElement("div");document.getElementById("content").appendChild(s),sn({onConfirm:function(){r(),a.askAccess.set(t,!0)},onReject:function(){o(),a.askAccess.set(t,!1)},cleanUp:function(){document.getElementById("content").removeChild(s)},title:e,message:n},s)}})).then((function(){a.toast("Operation ".concat(t," granted"),"success")})).catch((function(){return a.toast("Operation ".concat(t," rejected"),"error"),Promise.reject(new Error("User rejected"))}))}},{key:"askForToken",value:function(){return this.askForAccess("token","This post wish to access your personal info","This post needs to access your token to make requests.")}},{key:"roseliaApi",value:function(){for(var t=this,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(function(){var e=Object(kt["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.askForToken();case 2:return e.abrupt("return",st.fetchJSON(st.apiFor.apply(st,n),"GET",a));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"nil",value:function(){return null}},{key:"forceChangeTheme",value:function(t,e){e===gn&&this.app.$vuetify.theme.setTheme(this.app.$vuetify.isDark?"dark":"light",t)}},{key:"currentTheme",value:function(){return ln({},this.app.$vuetify.theme.currentTheme)}},{key:"changeTheme",value:function(t){var e=this;this.askForAccess("theme","This post would like to change your theme","Changes will discard after refresh").then((function(){e.forceChangeTheme(t,gn),bn=ln({},bn,{},t)}))}},{key:"changeThemeOnce",value:function(t){var e=this;this.forceChangeTheme(t,gn),this.onceUnload((function(){e.forceChangeTheme(bn,gn)}))}},{key:"resetTheme",value:function(){this.changeThemeOnce(Z.theme)}},{key:"saveCurrentTheme",value:function(){var t=this,e=this.currentTheme();this.askForAccess("theme","This post would like to save your current theme.","Changes will discard after refresh").then((function(){bn=ln({},bn,{},e),t.onceUnload((function(){t.forceChangeTheme(e,gn)}))}))}},{key:"forceSwitchToColorMode",value:function(){var t=Object(kt["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n===gn){t.next=3;break}return t.next=3,this.askForAccess("colorMode","This post would like to change your color scheme.","Changes will discard after refresh,");case 3:this.app.$emit("forceSwitchToLight",!!e),this.app.$emit("forceSwitchToDark",!e);case 5:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"switchToColorMode",value:function(t){var e=this;this.forceSwitchToColorMode(t,gn),this.onceUnload((function(){return e.resetColorMode()}))}},{key:"resetColorMode",value:function(){this.app.$emit("forceSwitchToLight",!1),this.app.$emit("forceSwitchToDark",!1)}},{key:"changeExtraDisplaySettings",value:function(t){this.app.extraDisplaySettings=ln({},this.app.extraDisplaySettings,{},t)}}]),t}(),kn={RoseliaRenderer:yn,createRenderer:function(t){return new yn(t)}},_n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("lazy-component",{attrs:{text:"Load comment"}},[n("v-container",[n("v-col",{attrs:{cols:"12",sm:"8","offset-sm":"2"}},[n("v-badge",[t.commentCount?n("span",{attrs:{slot:"badge"},slot:"badge"},[t._v(t._s(t.commentCount))]):t._e(),n("v-icon",[t._v(" mode_comment ")])],1),n("v-divider",{staticClass:"my-3"})],1),t.canAddComment?n("v-col",{attrs:{cols:"12",sm:"8","offset-sm":"2"}},[n("v-row",{attrs:{row:"",wrap:""}},[t.replyToComment?n("v-chip",{attrs:{close:"",color:"secondary",dark:""},on:{"click:close":function(e){t.chip=!1}},model:{value:t.chip,callback:function(e){t.chip=e},expression:"chip"}},[t._v(" @"+t._s(t.atToNickname)+" ")]):t._e(),n("v-spacer"),n("v-btn",{attrs:{color:"accent",icon:""},on:{click:t.switchPreviewMode}},[t.showPreview?n("v-icon",[t._v("mode_edit")]):n("v-icon",[t._v("visibility")])],1)],1),t.showPreview?n("div",[n("recursive-comment",{ref:"previewComment",attrs:{comments:[t.currentCommentObject],canAddComment:!1,canDeleteComment:function(){return!1},myUsername:t.userData&&t.userData.username}})],1):n("v-textarea",{ref:"commentText",attrs:{"auto-grow":"",outlined:"",placeholder:t.commentPlaceholer,color:"primary",label:"Leave a comment"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),n("v-row",{attrs:{row:"",wrap:""}},[n("v-col",{attrs:{cols:"4"}},[t.userData&&t.userData.nickname?n("span",[t._v(t._s(t.userData.nickname))]):n("v-text-field",{attrs:{small:"",label:"Nickname"},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}})],1),n("v-spacer"),n("v-col",{attrs:{cols:"3",md:"2",lg:"1"}},[n("v-btn",{attrs:{color:"primary",disabled:!this.isValid,loading:t.loading,rounded:""},on:{click:t.addComment}},[n("v-icon",[t._v("send")])],1)],1)],1)],1):t._e(),n("recursive-comment",{ref:"comments",attrs:{comments:t.recursiveCommentList,canAddComment:t.canAddComment,canDeleteComment:t.canDeleteComment,postAuthorUsername:t.postData.author&&t.postData.author.username,myUsername:t.userData&&t.userData.username},on:{"delete-comment":function(e){t.commentToDelete.id=e,t.commentToDelete.show=!0},"reply-comment":t.onReplyComment}}),n("v-row",{attrs:{align:"center",column:"",justify:"center",dense:""}},[n("v-col",{staticClass:"text-center",attrs:{cols:"2"}},[n("v-chip",{staticClass:"white--text ml-0 center-align",attrs:{color:"secondary",small:""},on:{click:function(e){return t.$vuetify.goTo(t.$refs.commentText)}}},[n("v-icon",[t._v("add_comment")])],1),t.currentPage<t.totalPages?n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.loadNextPage,expression:"loadNextPage"}]},[n("v-btn",{attrs:{loading:t.loading,small:"",block:"",color:"secondary",dark:""},on:{click:t.loadNextPage}},[n("v-icon",[t._v("keyboard_arrow_down")])],1)],1):t.loading?n("div",[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):n("div",[n("v-divider"),t._v(" Tiro Finale ")],1)],1)],1)],1),n("v-dialog",{attrs:{"max-width":"500",scrollable:""},model:{value:t.commentToDelete.show,callback:function(e){t.$set(t.commentToDelete,"show",e)},expression:"commentToDelete.show"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Are you sure?")]),n("v-divider"),n("v-card-text",[t._v(" You are deleting this comment: "),n("br"),n("recursive-comment",{attrs:{comments:t.commentToDeleteList,canAddComment:!1,canDeleteComment:function(){return!1}}})],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"info",text:""},on:{click:function(e){t.commentToDelete.show=!1}}},[t._v(" No ")]),n("v-btn",{attrs:{color:"error",text:""},on:{click:function(){t.deleteComment(t.commentToDelete.id),t.commentToDelete.show=!1,t.commentToDelete.id=0}}},[t._v(" Yes, delete"),n("v-icon",[t._v("delete")])],1)],1)],1)],1)],1)},Dn=[],xn=(n("45fc"),n("4e827"),n("7ed3"),n("2f62")),Cn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.visible?n("div",[t._t("default")],2):n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.setVisible,expression:"setVisible"}]},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-btn",{on:{click:t.setVisible}},[t._v(t._s(this.text))])],1)],1)])},On=[],Tn={props:["text"],name:"lazy-component",data:function(){return{visible:!1}},methods:{setVisible:function(){this.visible=!0}}},Pn=Tn,Sn=Object(I["a"])(Pn,Cn,On,!1,null,null,null),jn=Sn.exports;R()(Sn,{VBtn:dt["a"],VRow:vt["a"]});var Ln=n("ebfb"),Vn=n.n(Ln);function En(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function $n(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?En(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):En(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var An={components:{lazyComponent:jn,recursiveComment:ue},props:["userData","postData","toast","renderer"],name:"blog-comment",data:function(){return{visible:!1,chip:!1,comment:"",nickname:"",commentLeft:!1,loading:!1,currentPage:0,totalPages:1,commentCount:0,commentList:[],replyToComment:void 0,hasUnsafedDraft:!1,commentToDelete:{id:0,show:!1},removeTokens:{},cachedDraft:{},userMeta:{},userMetaLoaded:!1,showPreview:!1}},methods:$n({},Object(xn["b"])(["setCommentDraft","removeCommentDraft"]),{getCommentDraft:function(t){return this.$store.state.commentDraft[t]},setVisible:function(){this.visible=!0},formatDate:function(t){return st.formatDate(t)},hightlightLanguage:function(){window.hljs&&(window.hljs.initHighlighting.called=!1,window.hljs.initHighlighting())},addComment:function(){var t=this;this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("comment","add"),"POST",this.addPostForm).then(y).then((function(e){t.toast("Well, you placed a comment!","success"),t.loading=!1,t.removeTokens[e.commentId]=e.removeToken,t.cachedDraft[e.commentId]={nickname:t.nickname,comment:t.comment,replyTo:t.replyToComment},t.removeCommentDraft(t.postData.id),t.cleanUp(),t.loadNextPage()})).catch((function(e){t.toast(e,"error"),t.loading=!1}))},cleanUp:function(){this.currentPage=0,this.totalPages=1,this.commentCount=0,this.commentList=[],this.comment="",this.replyToComment=void 0,this.commentLeft=!1,this.showPreview=!1},deleteComment:function(t){var e=this;st.fetchJSONWithSuccess(st.apiFor("comment","delete"),"POST",w({comment:t,removeToken:this.removeTokens[t]})).then((function(n){if(e.commentList=e.commentList.filter((function(e){return e.id!==t})),--e.commentCount,e.removeTokens[t]=void 0,e.cachedDraft[t]){var a=e.cachedDraft[t],r=a.nickname,o=a.comment,s=a.replyTo;e.comment||(e.nickname=r,e.comment=o,e.replyToComment=s),e.cachedDraft[t]=void 0}})).catch((function(t){e.toast("Oops! Failed.","error")}))},onReplyComment:function(t){this.replyToComment=t},canDeleteComment:function(t){return!!this.removeTokens[t.id]||!!this.isLoggedIn&&(!t.author||(t.author.username==this.userData.username||(t.author.role?t.author.role<=this.userData.role:!!this.userData)))},loadNextPage:function(){var t=this;this.loading||this.currentPage>=this.totalPages||(this.loading=!0,st.fetchJSON(st.apiFor("comment","comments"),"GET",{p:this.postData.id,page:this.currentPage+1,limit:10}).then((function(t){return t.success?t:Promise.reject("Invalid postid")})).then((function(e){t.commentList=t.commentList.concat(e.result.map(y).map((function(t){return $n({},t,{showReply:!1})}))),t.totalPages=e.pages,t.commentCount=e.total,++t.currentPage,t.loading=!1,t.renderScript(),t.$nextTick((function(){t.processComments(),t.hasUnsafedDraft=!1}))})).catch((function(e){t.toast(e,"error"),t.loading=!1})))},getComment:function(t){return this.commentDict[t]},getCommentOrNotFound:function(t){var e=this.getComment(t);return e||(this.loadNextPage(),{id:0,nickname:"Anoymous",content:"This comment is gone.",createdAt:new Date})},getCommentNickname:function(t){return t.nickname||k("author","nickname")(t)},processComments:function(t){var e=this,n=t||this.$refs.comments.$el||this.$refs.comments,a=Array.from(n.querySelectorAll("a")).filter((function(t){return!!t.href})),r=["mohuety.com","roselia.moe","roselia.xyz","lisa.moe","roselia.app"].map((function(t){return new RegExp(t)}));a.filter((function(t){return!t.getAttribute("roselia-prevented")})).filter((function(t){return t.host!==location.host&&!r.some((function(e){return e.exec(t.host)}))})).forEach(function(){var t=Object(kt["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.setAttribute("roselia-prevented",!0),n.addEventListener("click",(function(t){t.preventDefault(),e.renderer.context.askForAccess(n.host,"This link wish to visit an unknown host ".concat(n.host),"The link is ".concat(n.href," please make sure it is safe.")).then((function(){window.open(n.href)}))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var o=n.querySelectorAll("img"),s=Array.from(o);s.forEach((function(t){t.classList.add("responsive-img")})),Be.a.Materialbox.init(o),this.hightlightLanguage()},renderScript:function(){var t=this;this.commentList.filter((function(t){return t.author})).filter((function(t){return!t.rendered})).forEach((function(e){t.forceRenderScript(e)}))},forceRenderScript:function(t){Object.defineProperty(t,"id",{value:t.id,writable:!1}),t.author=new Proxy(t.author,{set:function(t,e,n){if("role"!==e)return Reflect.set(t,e,n)}});var e=this.renderer.pushContext(t,"comment");t.cleanedContent=this.renderer.cleanScript(t.content);var n=this.renderer.render(t.content);t.content=n,t.rendered=!0,this.renderer.injectEvents(),e()},onExit:function(t){this.hasUnsafedDraft&&this.setCommentDraft({commentId:t||this.postData.id,comment:{comment:this.comment,nickname:this.nickname}})},loadDraft:function(t){var e=this.getCommentDraft(t||this.postData.id);e&&(this.comment=e.comment||this.comment,this.nickname=e.nickname||this.nickname)},ensureUserMeta:function(){var t=this;this.userData||(this.userMetaLoaded=!1,this.userMeta={}),this.userMetaLoaded&&this.userMeta.username===this.userData.username||(this.userMetaLoaded=!1,st.fetchJSONWithSuccess(st.apiFor("user","user-meta"),"GET",{username:this.userData.username}).then((function(e){t.userMeta=y(e),t.userMetaLoaded=!0,t.showPreview&&(t.showPreview=!1,t.$nextTick((function(){t.showPreview=!0})))})).catch((function(t){})))},switchPreviewMode:function(){var t=this;this.showPreview=!this.showPreview,this.showPreview&&(this.ensureUserMeta(),this.$nextTick((function(){t.processComments(t.$refs.previewComment.$el||t.$refs.previewComment)})))},highlightLanguage:function(){window.hljs&&(window.hljs.initHighlighting.called=!1,window.hljs.initHighlighting())}}),computed:{commentPlaceholer:function(){return this.commentLeft?"It is fine to keep silent, dear ".concat(this.currentNickname,"."):"Say something."},currentNickname:function(){return this.userData&&this.userData.nickname||this.nickname},isValid:function(){return this.comment&&this.currentNickname},isLoggedIn:function(){return!!this.userData},addPostForm:function(){return w({toPost:this.postData.id,content:this.comment,nickname:this.isLoggedIn?void 0:this.currentNickname,toComment:this.replyToComment||void 0})},canAddComment:function(){return!(!this.userData&&!this.postData.enableComment)},commentDict:function(){return this.commentList.reduce((function(t,e){return $n({},t,Object(l["a"])({},e.id,e))}),{})},atToNickname:function(){var t=this.getComment(this.replyToComment);return t&&this.getCommentNickname(t)},recursiveCommentList:function(){var t=this,e=this.commentDict,n=this.commentList.filter((function(t){return!t.replyTo})).concat(this.commentList.filter((function(t){return t.replyTo})).filter((function(t){return!e[t.replyTo]})).map((function(n){var a=$n({},t.getCommentOrNotFound(n.replyTo),{id:n.replyTo});return e[n.replyTo]=a})));return Object.entries(e).forEach((function(t){var n=Object(u["a"])(t,2),a=n[0],r=n[1];e[a]=$n({},r,{replies:[]})})),this.commentList.forEach((function(t){t.replyTo&&e[t.replyTo].replies.push(e[t.id])})),n.sort((function(t,e){return e.id-t.id})),n.map((function(t){return e[t.id]}))},commentToDeleteList:function(){return[$n({},this.commentDict[this.commentToDelete.id],{replies:[]})]},currentCommentObject:function(){var t=function(t){return Vn.a.prototype.markdown(t)},e={content:t(this.comment),color:"",createdAt:new Date,replies:[],author:this.userData?$n({},this.userMetaLoaded?this.userMeta:this.userData):void 0,nickname:this.userData?void 0:this.nickname,id:0};return this.showPreview&&this.userData&&this.forceRenderScript(e),e}},watch:{comment:function(){this.commentLeft=!0,this.hasUnsafedDraft=!0},replyToComment:function(t){t&&(this.$vuetify.goTo(this.$refs.commentText),this.chip=!0)},chip:function(t){t||(this.$vuetify.goTo("#comment-"+this.replyToComment),this.replyToComment=void 0)},postData:function(t,e){this.onExit(e.id),this.cleanUp(),this.loadDraft(t.id)},userData:function(){this.ensureUserMeta()}},mounted:function(){this.loadDraft()},beforeDestroy:function(){this.onExit()}},In=An,Un=n("4ca6"),Rn=n("a844"),Fn=Object(I["a"])(In,_n,Dn,!1,null,null,null),Nn=Fn.exports;function Mn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Bn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mn(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mn(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}R()(Fn,{VBadge:Un["a"],VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardText:Bt["b"],VCardTitle:Bt["c"],VChip:qt["a"],VCol:ht["a"],VContainer:mt["a"],VDialog:ve["a"],VDivider:ft["a"],VIcon:Jt["a"],VProgressCircular:pt["a"],VRow:vt["a"],VSpacer:Kt["a"],VTextField:_e["a"],VTextarea:Rn["a"]});var qn={components:{BlogDigestNav:He,BlogComments:Nn,GlobalEvents:re["a"]},name:"blog-post",props:{p:Number,currentColorScheme:Boolean,userData:Object},data:function(){return{postData:{img:"",id:0,displayId:"",content:"<p>Loading, please wait...</p>",author:{nickname:""},darkTitle:!1,next:-1,prev:-1,secret:0,title:"Loading...",subtitle:"",tags:[""],date:(new Date).toDateString()},postDigest:[],preview:{show:!1,loading:!1,current:0,title:"",subtitle:"",attach:"",origin:"center center",img:"",cacheData:null,color:"secondary",x:0,y:0},cachedData:!1,renderer:null,toast:st.getToastOption(),rsRendered:!1,share:{open:!1,shareId:""},extraDisplaySettings:{metaBelowImage:!1,blurMainImage:!1},loading:!1,nextMeta:null,prevMeta:null}},methods:{showToast:function(t,e){return st.showToast.call(this,t,e)},changeToast:function(t){this.toast.show=t},getArguments:function(){return this.$route.query},formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return st.formatDate(t,e)},loadContent:function(t,e){var n=this;if(t=t||this.getPostNum(),e=e||this.$route,e&&e.params.data){var a=e.params.data;if("preview"===a.id||a.id==t)return this.postData=Bn({},this.notFoundData(),{},a),this.cachedData=!0,void this.processContent()}var r="post"!==e.name;r&&(t=e.params.postLink),this.cachedData=!1,-1!==t?(this.loading=!0,st.fetchJSON(st.apiFor(r?"post-link":"post",t)).then((function(t){return n.loading=!1,t?(n.postData=y(t),n.processContent()):Promise.reject(ReferenceError("NPE"))})).catch((function(t){n.loading=!1,n.postData=n.notFoundData()}))):this.postData=this.notFoundData()},processContent:function(){var t=this;this.extraDisplaySettings.metaBelowImage=this.extraDisplaySettings.blurMainImage=!1,this.postData.displayId&&(this.$route.params.changeRoute||this.$route.query.p&&!this.isShared)&&this.$router.replace({name:"postWithEternalLink",params:{postLink:this.postData.displayId,doNotLoad:!0}}),Object.defineProperty(this.postData,"id",{value:this.postData.id,writable:!1});var e=this.renderer.pushContext(this.postData,"post");this.renderer.renderAsync(this.postData.content).then((function(n){t.postData.content=n,t.$nextTick((function(){t.renderer.injectEvents(),e()}))})).then((function(){return t.$nextTick(Object(kt["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.afterContentMounted());case 1:case"end":return e.stop()}}),e)}))))})),this.getAdjacentPostMeta()},afterContentMounted:function(){var t=this,e=this.$refs.content.querySelectorAll("img");Array.from(e).forEach((function(t){t.classList.add("responsive-img")})),Be.a.Materialbox.init(e),this.setDigest();var n=Object(at["escapeRegExp"])(location.host),a=["".concat(n,"/.*\\?p=(\\d+)"),"".concat(n,"(?:/.*)?/post/([\\s\\S]*)")].map((function(t){return new RegExp(t)})),r=Array.from(this.$refs.content.querySelectorAll("a")).filter((function(t){return!!t.href}));if(r.filter((function(t){return t.host===location.host})).forEach(function(){var e=Object(kt["a"])(regeneratorRuntime.mark((function e(n){var r,o,s,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=n.href,o=a[0].exec(r),s=a[1].exec(r),(o||s||n.pathname===location.pathname)&&(i=(o||s||["","preview"])[1],c=n.hash,n.addEventListener("click",(function(e){e.preventDefault(),c?t.$vuetify.goTo(document.getElementById(n.hash.substring(1)),{offset:200}):t.$router.push({name:o?"post":"postWithEternalLink",query:{p:o?i:void 0},params:{data:t.preview.current!=i||t.preview.loading?void 0:t.preview.cacheData,postLink:s?i:void 0}})}),!0),n.addEventListener("mouseover",function(){var e=Object(kt["a"])(regeneratorRuntime.mark((function e(a){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preview.show=!0,t.preview.attach=n,!c){e.next=10;break}return t.preview.cacheData=null,t.preview.current=i,r=document.getElementById(n.hash.substring(1)),t.preview.title=r.innerText,t.preview.img="",-1!==n.hash.indexOf("ref")?t.preview.subtitle=r.parentElement.innerText:t.preview.subtitle="",e.abrupt("return");case 10:if(t.preview.current!==i||t.preview.loading||!t.preview.cacheData){e.next=13;break}return t.preview.current=i,e.abrupt("return");case 13:t.preview.current=i,t.preview.loading=!0,t.preview.img="",st.fetchJSON(st.apiFor(o?"post":"post-link",i)).then((function(e){if(!e)return t.preview.loading=!1,t.preview.title="Oops! :(",t.preview.subtitle="This is a secret",void(t.preview.img="");t.preview.cacheData=y(e),t.preview.loading=!1,t.preview.title=e.title,t.preview.subtitle=e.subtitle,t.preview.img=e.img})).catch((function(e){t.preview.loading=!1,t.preview.cacheData=null,t.preview.title=":(",t.preview.subtitle=e.message,t.preview.img=""}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.addEventListener("mouseout",(function(e){t.preview.show=!1})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.highlightLanguage(),this.renderWithMathJax(),this.$emit("postLoaded"),this.postData.img){var o=this.postData.id,s=document.createElement("img");s.addEventListener("error",(function(e){o===t.postData.id&&(t.postData.img="")})),s.src=this.postData.img}},highlightLanguage:function(){window.hljs&&(window.hljs.initHighlighting.called=!1,window.hljs.initHighlighting())},renderWithMathJax:function(){window.MathJax&&window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,"output"])},getPostNum:function(){return this.getArguments().p||-1},notFoundData:function(){return{img:"",id:-1,content:"",next:-1,prev:-1,secret:0,title:"Page Not Found",subtitle:"Please check your post-id. Or try to login.",author:{nickname:""},darkTitle:!1,tags:[],created:new Date,lastEdit:new Date}},setDigest:function(){this.postDigest=Array.from(this.$refs.content.querySelectorAll("h1,h2,h3")).map((function(t,e){return t.classList.add("scrollspy"),t.classList.add("section"),t.id=t.id||"section-".concat(e),{hash:t.id,title:t.innerText,element:t}}))},getPostByShared:function(t){var e=this;st.fetchJSON(st.apiFor("post","get-shared",t)).then((function(t){if(!t)return Promise.reject("");e.postData=Bn({},e.notFoundData(),{},y(t)),e.processContent()})).catch((function(t){e.postData=e.notFoundData()}))},sharePost:function(){var t=this;this.share.shareId="",this.postData.secret&&st.fetchJSONWithSuccess(st.apiFor("post","share"),"post",{pid:this.postData.id}).then((function(e){t.share.shareId=e})),this.share.open=!0},mouseMoveHandler:function(t){this.preview.show&&(this.preview.x=t.clientX+10,this.preview.y=t.clientY+10)},renderPreviewByServer:function(){var t=Object(kt["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("preview"===this.postData.id&&this.postData.markdownContent){t.next=2;break}return t.abrupt("return");case 2:return this.loading=!0,t.prev=3,t.next=6,st.fetchJSONWithSuccess(st.apiFor("post","render-markdown"),"POST",{markdown:this.postData.markdownContent});case 6:e=t.sent,this.$emit("postUnload"),this.postData.content=e,this.postData.serverRendered=!0,this.processContent();case 11:return t.prev=11,this.loading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[3,,11,14]])})));function e(){return t.apply(this,arguments)}return e}(),getAdjacentPostMeta:function(){var t=this;this.prevMeta=null,this.postData.prev>0&&st.fetchJSONWithSuccess(st.apiFor("post","meta","id",this.postData.prev)).then((function(e){t.prevMeta=e})),this.nextMeta=null,this.postData.next>0&&st.fetchJSONWithSuccess(st.apiFor("post","meta","id",this.postData.next)).then((function(e){t.nextMeta=e}))}},computed:{hasDigest:function(){return this.$vuetify.breakpoint.smAndUp&&this.postDigest.length>0},isTokenExpired:function(){return st.isTokenExpired(this.userData&&this.userData.token)},titleClass:function(){return"".concat(["white","black"][+this.postData.darkTitle],"--text")},isEditable:function(){return!(!this.postData.author||!this.userData)&&this.userData.role>=this.postData.author.role},isPostFound:function(){return this.postData.id>0},isShared:function(){return!!this.$route.params.shareId},sharePath:function(){if(!this.postData.secret||!this.share.shareId)return location.href;var t=this.$router.resolve({name:"sharedPost",params:{shareId:this.share.shareId}}).href,e=document.createElement("a");return e.href=t,e.href},shouldDisplayAdjacentMeta:function(){return this.$vuetify.breakpoint.mdAndUp}},mounted:function(){var t=this;if(this.renderer=kn.createRenderer(this),this.$route.params.shareId?this.getPostByShared(this.$route.params.shareId):this.loadContent(),!window.MathJax){var e=document.createElement("script");e.async=!0,e.src="https://cdn.bootcss.com/mathjax/2.7.3/latest.js?config=TeX-MML-AM_CHTML";var n=document.createElement("script");n.type="text/x-mathjax-config",n.innerHTML="MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});",document.body.appendChild(n),document.body.appendChild(e)}var a=function(e){-1!==e&&t.$router.push({name:"post",query:{p:e}})};$t({"Utilities.ShowNext":function(){a(this.postData.prev)},"Utilities.ShowPrevious":function(){a(this.postData.next)},edit:function(){this.$router.push({name:"edit",query:{post:this.postData.id}})},delete:function(){this.$router.push({name:"edit",params:{deletePost:!0,title:this.postData.title},query:{post:this.postData.id}})}},this)},beforeRouteUpdate:function(t,e,n){return t.params.doNotLoad?n():t.query.p===e.query.p&&t.params.postLink==e.params.postLink?n():(this.$vuetify.goTo(0),this.$emit("postUnload"),this.loadContent(t.query.p,t),void n())},destroyed:function(){this.$emit("postUnload"),this.$emit("postDestroyed"),At()},watch:{userData:function(){!this.userData&&this.postData.secret&&(this.postData=this.notFoundData()),-1===this.postData.id&&this.loadContent()},"window.MathJax":function(){this.renderWithMathJax()}}},Jn=qn,Wn=(n("6801"),n("e449")),Hn=Object(I["a"])(Jn,Ue,Re,!1,null,"dd18108c",null),Yn=Hn.exports;R()(Hn,{VAlert:me["a"],VAvatar:Nt["a"],VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardText:Bt["b"],VCardTitle:Bt["c"],VChip:qt["a"],VCol:ht["a"],VContainer:mt["a"],VDialog:ve["a"],VDivider:ft["a"],VIcon:Jt["a"],VImg:Wt["a"],VMenu:Wn["a"],VParallax:Gt["a"],VProgressLinear:Ve["a"],VRow:vt["a"],VSlideXTransition:M["f"],VSpacer:Kt["a"],VTextField:_e["a"]});var Gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("blog-toolbar",{attrs:{userData:t.userData}}),n("v-container",{attrs:{"grid-list-md":"",fluid:"","fill-height":""}},[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"8","offset-sm":"2"}},[n("h1",{staticClass:"display-3"},[t._v(t._s(t.realTitle))]),n("v-layout",[n("v-spacer"),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[n("v-btn",t._g({attrs:{color:"secondary",fab:"",small:"",to:{name:"post",params:{data:t.getPreviewData()}}}},a),[n("v-icon",[t._v("visibility")])],1)]}}])},[n("span",[t._v("Preview the post. Note that the link can be used only once.")])])],1),n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{label:"Title","prepend-icon":"title",required:"",rules:[function(t){return!!t||"Title is required"}]},model:{value:t.postData.title,callback:function(e){t.$set(t.postData,"title",e)},expression:"postData.title"}}),n("v-text-field",{attrs:{label:"Subtitle","prepend-icon":"subtitles"},model:{value:t.postData.subtitle,callback:function(e){t.$set(t.postData,"subtitle",e)},expression:"postData.subtitle"}}),n("v-text-field",{attrs:{label:"Eternal link","prepend-icon":"link"},model:{value:t.postData.displayId,callback:function(e){t.$set(t.postData,"displayId",e)},expression:"postData.displayId"}}),n("span",[n("v-icon",[t._v("fab fa-"+t._s(t.markdown?"markdown":"html5"))]),t._v(" Language ")],1),n("v-switch",{attrs:{color:"accent",label:t.markdown?"Markdown":"HTML"},model:{value:t.markdown,callback:function(e){t.markdown=e},expression:"markdown"}}),t.markdown||t.addPost?t._e():n("v-btn",{attrs:{color:"info"},on:{click:t.loadContent}},[t._v("Edit raw HTML")]),n("v-slider",{attrs:{step:"1",min:"0",max:t.userData.role+1,ticks:"","thumb-label":"",label:"Secret level","prepend-icon":t.lockIcon},model:{value:t.postData.secret,callback:function(e){t.$set(t.postData,"secret",e)},expression:"postData.secret"}}),n("span",[n("v-icon",[t._v("visibility"+t._s(t.postData.hidden?"_off":""))]),t._v(" Hidden? ")],1),n("v-switch",{attrs:{color:"accent",label:t.postData.hidden?"Hidden":"Public"},model:{value:t.postData.hidden,callback:function(e){t.$set(t.postData,"hidden",e)},expression:"postData.hidden"}}),n("span",[t._v("Comment")]),n("v-switch",{attrs:{color:"accent",label:t.postData.enableComment?"Enabled":"Disabled"},model:{value:t.postData.enableComment,callback:function(e){t.$set(t.postData,"enableComment",e)},expression:"postData.enableComment"}}),n("span",[t._v("Color of Title")]),n("v-switch",{attrs:{color:"accent",label:t.postData.darkTitle?"Dark":"Light"},model:{value:t.postData.darkTitle,callback:function(e){t.$set(t.postData,"darkTitle",e)},expression:"postData.darkTitle"}}),t.richPostExtensions.length?n("v-btn",{attrs:{round:"",color:"primary"},on:{click:function(e){t.explorerOpen=!0}}},[t._v(" +"),n("v-icon",[t._v("extension")]),t._v("Plugins ")],1):t._e(),n("v-combobox",{attrs:{"hide-selected":"",label:"Tags","prepend-icon":"label",multiple:"",chips:"","deletable-chips":""},on:{input:t.changeTags},model:{value:t.postData.tags,callback:function(e){t.$set(t.postData,"tags",e)},expression:"postData.tags"}}),n("v-text-field",{attrs:{label:"Banner Image","prepend-icon":"image"},model:{value:t.postData.img,callback:function(e){t.$set(t.postData,"img",e)},expression:"postData.img"}}),n("span",[t._v("Content")]),n("markdown-editor",{ref:"markdownEditor",attrs:{id:"markdownEditor",highlight:!0,configs:t.configs},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"s",void 0,e.key,void 0)?null:e.ctrlKey?(e.preventDefault(),t.saveDraft(e)):null}},model:{value:t.postData.content,callback:function(e){t.$set(t.postData,"content",e)},expression:"postData.content"}}),n("v-card-actions",[n("v-spacer"),t.loading?n("div",[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):n("div",[n("v-layout",[t.addPost?t._e():n("v-btn",{attrs:{color:"info"},on:{click:t.reloadPost}},[n("v-icon",[t._v("refresh")])],1),t.addPost?t._e():n("v-btn",{attrs:{color:"error"},on:{click:function(e){t.deleteDialog=!0}}},[n("v-icon",[t._v("delete")])],1),n("v-btn",{attrs:{color:"secondary",loading:t.loading},on:{click:t.saveDraft}},[n("v-icon",[t._v("archive")])],1),n("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.doEditPost}},[n("v-icon",[t._v("cloud_upload")]),t.isMobile?t._e():n("span",[t._v("("+t._s(t.commandText)+"+Shift+S)")])],1)],1)],1)],1)],1)],1)],1),n("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.realTitle,expression:"realTitle"}]}),n("v-dialog",{attrs:{"max-width":"500"},model:{value:t.deleteDialog,callback:function(e){t.deleteDialog=e},expression:"deleteDialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Are you sure?")]),n("v-card-text",[t._v(" You are deleting "+t._s(t.postData.title)+" "),n("br"),t._v(" This post will be deleted, and can NOT be undone. ")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"info",flat:"flat"},on:{click:function(e){t.deleteDialog=!1}}},[t._v(" No ")]),n("v-btn",{attrs:{color:"error",flat:"flat",loading:t.loading},on:{click:t.deletePost}},[t._v(" Yes, delete"),n("v-icon",[t._v("delete")])],1)],1)],1)],1),n("plugin-explorer",{attrs:{plugins:t.richPostExtensions.map((function(t){return{name:t.name,component:t.editPage}}))},model:{value:t.explorerOpen,callback:function(e){t.explorerOpen=e},expression:"explorerOpen"}})],1),n("toast",t._b({on:{showChange:t.changeToast}},"toast",t.toast,!1)),t.isMac?n("GlobalEvents",{on:{"!keyup":function(e){return(e.type.indexOf("key")||83===e.keyCode)&&e.metaKey?(e.preventDefault(),t.doEditPost(e)):null}}}):t._e(),n("GlobalEvents",{on:{"!keyup":function(e){return(e.type.indexOf("key")||83===e.keyCode)&&e.ctrlKey?(e.preventDefault(),t.doEditPost(e)):null}}}),n("blog-footer")],1)},zn=[],Kn=(n("1487"),n("bdfa"));n("b116"),n("e4cb"),n("8159");function Xn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Zn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xn(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xn(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qn={ie:"Trident",opera:"Presto",webKit:"AppleWebkit",fireFox:["Gecko","KHTML"],mobile:function(t){return!!t.match(/AppleWebKit.*Mobile.*/)},iOS:function(t){return!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)},android:["Android","Adr"],iPhone:"iPhone",iPad:"iPad",weChat:"MicroMessenger",macOS:"Mac OS X"},ta=g((function(t){var e=navigator.userAgent,n=function t(n){return"function"===typeof n?n(e):"string"===typeof n?e.indexOf(n)>-1:Array.isArray(n)?n.some(t):null};return n(t)}))(Qn),ea=Zn({},ta),na=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-toolbar",{attrs:{dark:"",color:"primary"}},[n("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){t.dialog=!1}}},[n("v-icon",[t._v("close")])],1),n("v-toolbar-title",[t._v("Plugins")]),n("v-spacer")],1),n("div",[n("v-subheader",[t._v("Select Plugin")]),n("v-select",{attrs:{items:t.items,label:"Plugin...","prepend-icon":"extension","return-object":""},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),n("v-divider"),n("div",[n("v-subheader",[t._v(t._s(t.selected.text))]),n(t.currentComponent,{tag:"component"})],1)],1)],1)},aa=[],ra={name:"plugin-explorer",model:{prop:"open",event:"change"},props:{open:Boolean,plugins:Array},data:function(){return{selected:{}}},computed:{items:function(){return this.plugins.map((function(t){return{text:t.name,value:t.component}}))},dialog:{get:function(){return this.open},set:function(t){this.$emit("change",t)}},currentComponent:function(){return this.selected.value}}},oa=ra,sa=n("b974"),ia=n("e0c7"),ca=Object(I["a"])(oa,na,aa,!1,null,null,null),la=ca.exports;R()(ca,{VBtn:dt["a"],VCard:Mt["a"],VDialog:ve["a"],VDivider:ft["a"],VIcon:Jt["a"],VSelect:sa["a"],VSpacer:Kt["a"],VSubheader:ia["a"],VToolbar:De["a"],VToolbarTitle:xe["b"]});var ua={richPostPlugin:[]};function da(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ha(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?da(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):da(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ma={components:{BlogToolbar:Oe,markdownEditor:Kn["a"],PluginExplorer:la,GlobalEvents:re["a"]},name:"post-edit",data:function(){return{postData:{img:"",id:0,content:"",secret:0,title:"",subtitle:"",hidden:!1,enableComment:!0,darkTitle:!1,displayId:"",tags:[]},toast:{show:!1,text:"",color:""},deleteDialog:!1,valid:!0,markdown:!0,addPost:0,loading:!1,configs:{spellChecker:!1,hideIcons:["guide"]},uploadImages:[],doNotSave:!1,explorerOpen:!1}},props:{userData:Object},methods:{showToast:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.toast.text=t,this.toast.color=e,this.toast.show=!0},changeToast:function(t){this.toast.show=t},makeRedirect:function(t){st.setRedirect(this.$route.fullPath),st.redirectTo(t)},changeTags:function(){this.postData.tags=this.postData.tags.map((function(t){return t.replace(/ /g,"-")}))},getPostNum:function(){return this.$route.query.post},getPostData:function(){return this.changeTags(),{markdown:this.markdown,data:this.postData,uploadImages:this.uploadImages}},getPostDraft:function(t){return JSON.parse(window.localStorage.getItem("postDraft#".concat(t||0)))},saveDraft:function(){window.localStorage.setItem("postDraft#".concat(this.postData.id||0),JSON.stringify(this.getPostData())),this.showToast("Draft saved!")},deleteDraft:function(){window.localStorage.removeItem("postDraft#".concat(this.postData.id||0))},getRequestForm:function(){var t=ha({},this.postData,{id:void 0,next:void 0,prev:void 0,lastEdit:void 0,author:void 0,created:void 0});return{postID:this.addPost?void 0:this.postData.id,data:w(t),markdown:this.markdown}},loadDraft:function(){var t=this.getPostNum()||0,e=this.getPostDraft(t);return e&&(this.markdown=e.markdown,this.postData=e.data),!!e},preload:function(){var t=this.loadDraft();return t&&this.showToast("Draft loaded!"),t},loadContent:function(){var t=this,e=this.getPostNum();e&&(this.loading=!0,st.fetchJSON(st.apiFor("post",e),"GET",{markdown:this.markdown}).then((function(e){t.loading=!1,e?t.postData=y(e):t.addPost=!0})).catch((function(e){t.showToast(e,"error")})))},doEditPost:function(){var t=this;if(this.valid)return this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("add"),"POST",this.getRequestForm()).then((function(e){t.showToast("Success!","success"),t.leave()})).catch((function(e){if(t.$Progress.fail(),"expired"===e)return st.refreshToken().then((function(e){return t.doEditPost()})).catch((function(e){t.showToast("Token Expired!","warning"),t.makeRedirect({name:"login"})}));t.showToast(e,"error")})).finally((function(){t.deleteDialog=!1,t.loading=!1}))},deletePost:function(){var t=this,e=this.getPostNum();if(e){var n=st.getLoginData();n&&n.role?st.fetchJSONWithSuccess(st.apiFor("remove"),"POST",{postID:e}).then((function(e){t.showToast("Success!","success"),t.leave(!0)})).catch((function(e){"expired"===e?(t.showToast("Token Expired!","warning"),t.$router.push({name:"login"})):t.showToast(e,"error")})):this.showToast("You are not supposed to do this.","warning")}},reloadPost:function(){this.markdown=!0,this.loadContent()},doNotDelete:function(){this.deleteDialog=!1,this.leave()},leave:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&this.deleteDraft(),this.doNotSave=t,this.$route.params.deletePost?this.$router.go(-1):st.redirectTo({name:"index"})},simplemde:function(){var t=this.$refs.markdownEditor;return t?t.simplemde:{markdown:function(t){return t}}},getPreviewData:function(){return ha({},this.postData,{id:"preview",content:this.markdown?this.simplemde().markdown(this.postData.content):this.postData.content,markdownContent:this.markdown?this.postData.content:void 0})}},computed:{realTitle:function(){return this.addPost?"Add a post":"Edit: ".concat(this.postData.title)},operationVerb:function(){return this.addPost?"add":"edit"},lockIcon:function(){return this.postData.secret?"lock":"lock_open"},isMac:function(){return ea.macOS},isMobile:function(){return ea.mobile},commandText:function(){return this.isMac?"":"Ctrl"},richPostExtensions:function(){return ua.richPostPlugin}},mounted:function(){var t=this;if(!this.userData)return this.makeRedirect({name:"login",params:{logout:!0,message:"Login to ".concat(this.operationVerb," a post")}});if(!this.userData.role)return this.showToast("You are not supposed to do this."),void st.redirectTo({name:"index"});if(this.$route.params.deletePost){this.deleteDialog=!0,this.postData.title=this.$route.params.title;var e=this.$watch("deleteDialog",(function(n){e(),t.doNotDelete()}))}else{this.addPost=!this.getPostNum();var n=this.preload();n||this.addPost||this.loadContent(),window.addEventListener("beforeunload",(function(e){return t.saveDraft()})),this.$emit("forceSwitchToLight",!0),$t({"Utilities.FinishTask":this.doEditPost,"Utilities.Confirm":this.doEditPost,"Utilities.Cancel":this.leave,save:this.doEditPost},this)}},watch:{userData:function(t){t||this.makeRedirect({name:"login"})}},beforeDestroy:function(){this.doNotSave||this.saveDraft()},destroyed:function(){var t=this;this.$emit("forceSwitchToLight"),removeEventListener("beforeunload",(function(e){return t.saveDraft()})),At()}},fa=ma,pa=n("2b5d"),va=n("ba0d"),ga=n("b73d"),ba=n("3a2f"),ya=Object(I["a"])(fa,Gn,zn,!1,null,"5faf77c1",null),wa=ya.exports;R()(ya,{VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardText:Bt["b"],VCardTitle:Bt["c"],VCol:ht["a"],VCombobox:pa["a"],VContainer:mt["a"],VDialog:ve["a"],VForm:Le["a"],VIcon:Jt["a"],VLayout:Ht["a"],VProgressCircular:pt["a"],VRow:vt["a"],VSlider:va["a"],VSpacer:Kt["a"],VSwitch:ga["a"],VTextField:_e["a"],VTooltip:ba["a"]});var ka=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"top-details"},[n("aside",{staticClass:"exception-logo"}),n("header",{staticClass:"exception-info"},[n("h5",{staticClass:"struct blog-text"},[t._v(" RoseliaBlog.Router."+t._s(t.errorCode)+"Error "),n("small",[t._v("at "+t._s(t.method))]),n("small",{staticClass:"path"},[t._v(t._s(t.path))])]),n("h1",{staticClass:"title blog-text"},[t._v("an error found for "+t._s(t.method)+" "+t._s(t.path)+" (RoseliaBlog.Router)")])]),n("div",{staticClass:"code-explorer"},[n("div",{staticClass:"code-snippets"},[n("div",{staticClass:"frame-info -active",attrs:{"data-index":"0",role:"stack-trace-details"}},[t._m(0),n("pre",{staticClass:"black--text code code-block"},[t._m(1),t._v("\n                      "),t._m(2),t._v("\n                      "),t._m(3),t._v("\n                      "),t._m(4),t._v("\n                      "),t._m(5),t._v("\n                      "),t._m(6),t._v("\n                      "),n("span",{staticClass:"line -highlight"},[n("span",{staticClass:"ln"},[t._v("666")]),n("span",{staticClass:"code"},[t._v('    case "'+t._s(t.path)+'" => '+t._s(t.errorTaunt))])]),t._v("\n                      "),t._m(7),t._v("\n                      "),t._m(8),t._v("\n                  ")]),t._m(9)])]),n("div",{staticClass:"stack-trace"},[n("ul",{staticClass:"stack-trace-list -show-all",attrs:{role:"stack-trace-list"}},[t._m(10),n("li",[n("router-link",{staticClass:"stack-trace-item",attrs:{to:"/",role:"stack-trace-item","data-index":"0"}},[n("span",{staticClass:"left"},[n("span",{staticClass:"app"},[t._v("RoseliaBlog")]),n("span",{staticClass:"filename"},[t._v(" Bring me back ")])]),n("span",{staticClass:"info"},[t._v('_ => RoseliaBlog.Router.route("index")')])])],1)])])])]),n("div",{staticClass:"conn-info"},[n("details",{staticClass:"conn-details"},[n("summary",[t._v("Known info")]),n("dl",[n("dt",[t._v("Instance:")]),n("dd",{staticClass:"code-quote"},[t._v(t._s(t.title))])]),n("dl",[n("dt",[t._v("URI:")]),n("dd",{staticClass:"code-quote"},[t._v(t._s(t.path))])]),n("dl",[n("dt",[t._v("Description:")]),n("dd",{staticClass:"code-quote"},[t._v(t._s(t.motto))])]),n("dl",[n("dt",[t._v("Error:")]),n("dd",{staticClass:"code-quote"},[t._v(t._s(t.errorCode)+" - "+t._s(t.errorTaunt))])])])])])},_a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"file"},[n("a",{attrs:{href:""}},[t._v("lib/roselia_blog/router")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line"},[n("span",{staticClass:"ln"},[t._v("1")]),n("span",{staticClass:"code"},[t._v("class RoseliaBlog.Router extends Router{")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line "},[n("span",{staticClass:"ln"},[t._v("2")]),n("span",{staticClass:"code"},[t._v("  ...")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line "},[n("span",{staticClass:"ln"},[t._v("3")]),n("span",{staticClass:"code"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line "},[n("span",{staticClass:"ln"},[t._v("233")]),n("span",{staticClass:"code"},[t._v("  def route(path: String): Request => Response = path match {")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line "},[n("span",{staticClass:"ln"},[t._v("234")]),n("span",{staticClass:"code"},[t._v('    case "/" => Controller.index')])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line "},[n("span",{staticClass:"ln"},[t._v("235")]),n("span",{staticClass:"code"},[t._v("    ...")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line "},[n("span",{staticClass:"ln"},[t._v("667")]),n("span",{staticClass:"code"},[t._v("  }")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"line "},[n("span",{staticClass:"ln"},[t._v("668")]),n("span",{staticClass:"code"},[t._v("  def scope(scop: String)(f: Request => Response): Request => Response = {")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"meta"},[n("div",{staticClass:"frame-mfa"},[t._v(" RoseliaBlog.Router.route: (path: String): Request => Response "),n("a",{staticClass:"docs right blog-text",attrs:{href:"/"}},[t._v("index")]),n("span",{staticClass:"app right"},[t._v("RoseliaBlog")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("button",{staticClass:"stack-trace-item -app -active",attrs:{role:"stack-trace-item","data-index":"0"}},[n("span",{staticClass:"left"},[n("span",{staticClass:"app"},[t._v("RoseliaBlog")]),n("span",{staticClass:"filename"},[t._v(" lib/roselia_blog/router"),n("span",{staticClass:"line"},[t._v(":666")])])]),n("span",{staticClass:"info"},[t._v("RoseliaBlog.Router.route: (path: String): Request => Response")])])])}],Da={name:"blog-error",data:function(){return{errorCode:"404NotFound",errorTaunt:"Maybe Marisa has stolen something important",title:Z.title,motto:Z.motto,link:this.$router.resolve({name:"index"}),path:this.$route.fullPath,method:"GET"}}},xa=Da,Ca=(n("8cd6"),n("86f9"),Object(I["a"])(xa,ka,_a,!1,null,"c4e27986",null)),Oa=Ca.exports,Ta=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{dark:!t.currentColorScheme}},[n("blog-toolbar",{attrs:{userData:t.userData,noDrawer:!0}},[n("v-app-bar-nav-icon",{attrs:{dark:""},nativeOn:{click:function(e){t.drawer=!t.drawer}}})],1),n("v-navigation-drawer",{attrs:{fixed:"",clipped:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-list",{attrs:{dense:""}},[t._l(t.items,(function(e,a){return[e.heading?n("v-row",{key:a,attrs:{row:"","align-center":""}},[n("v-col",[e.heading?n("v-subheader",{attrs:{inset:""}},[t._v(" "+t._s(e.heading)+" ")]):t._e()],1)],1):e.divider?n("v-divider",{key:a,staticClass:"my-3",attrs:{dark:""}}):e.click?n("v-list-item",{key:a,attrs:{ripple:""},on:{click:e.click}},[n("v-list-item-icon",[n("v-icon",[t._v(t._s(e.icon))])],1),n("v-list-item-content",[n("v-list-item-title",{staticClass:"grey--text"},[t._v(" "+t._s(e.text)+" ")])],1)],1):n("v-list-item",{key:a,attrs:{ripple:"",to:e.to}},[n("v-list-item-icon",[n("v-icon",[t._v(t._s(e.icon))])],1),n("v-list-item-content",[n("v-list-item-title",{staticClass:"grey--text"},[t._v(" "+t._s(e.text)+" ")])],1)],1)]}))],2)],1),n("v-content",[n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-row",{attrs:{justify:"center",align:"center"}},[n("v-col",{staticClass:"shrink",attrs:{cols:"10"}},[n("v-alert",{attrs:{type:t.toast.color,transition:"scale-transition"},model:{value:t.toast.show,callback:function(e){t.$set(t.toast,"show",e)},expression:"toast.show"}},[t._v(" "+t._s(t.toast.text)+" ")]),n("v-slide-x-transition",{attrs:{"hide-on-leave":""}},[n("router-view",{attrs:{userData:t.userData,toast:t.showToast}})],1)],1)],1)],1)],1),n("toast",t._b({on:{showChange:t.changeToast}},"toast",t.toast,!1))],1)},Pa=[],Sa={components:{BlogToolbar:Oe},name:"blog-user-space",data:function(){return{toast:{show:!1,text:"",color:""},drawer:null,removeListener:null}},props:{currentColorScheme:Boolean,userData:Object},computed:{items:function(){return[{icon:"home",text:"Home",to:{name:"console-index"}},{divider:!0},{heading:"Articles"},{icon:"add_circle",text:"Write a new post",to:{name:"edit"},cond:this.userData.role},{icon:"archive",text:"Manage Drafts",to:{name:"manageDrafts",cond:this.userData.role}},{icon:"list_alt",text:"My Timeline",to:{name:"userTimeline",params:{username:this.userData.username}}},{divider:!0},{heading:"My Account"},{icon:"account_box",text:"Account Settings",to:{name:"setNickname"}},{icon:"account_circle",text:"OAuth Accounts",to:{name:"oauthAccounts"}},{icon:"security",text:"Two Step Auth",to:{name:"twoStepAuth"}},{divider:!0},{heading:"Management"},{icon:"lock",text:"Change Password",to:{name:"changePassword"}},{icon:"people",text:"Manage User",to:{name:"userManagement"},cond:this.userData.role},{icon:"computer",text:"System Monitor",to:{name:"systemMonitor"},cond:this.userData.role>1},{divider:!0},{heading:"My Session"},{icon:"refresh",text:"Token Refresh",to:{name:"tokenRefresh"},cond:this.userData.rftoken},{icon:"verified_user",text:"Remote Login",to:{name:"remoteLogin"}},{divider:!0},{icon:"exit_to_app",text:"Log Out",to:{name:"login",params:{logout:!0}}}].filter((function(t){return!t.hasOwnProperty("cond")||t.cond}))}},methods:{showToast:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.toast=this.toast||{},this.toast.show=!1,this.toast.text=t.toString(),this.toast.color=e,this.toast.show=!0},changeToast:function(t){this.toast.show=t},ensureLoggedIn:function(){this.userData||this.$router.push({name:"login",params:{logout:!0,message:"Login to manage",alert:{color:"warning",text:"Please login first"},redirect:this.$route.fullPath}})},removeAllDraft:function(){var t=window.localStorage;Array.from(Array(t.length).keys()).map(t.key.bind(t)).filter((function(t){return t.startsWith("postDraft")})).forEach((function(e){t.removeItem(e)})),this.showToast("Draft Cleaned!")}},mounted:function(){this.ensureLoggedIn()},destroyed:function(){st.removeSUToken(),this.removeListener&&this.removeListener()},watch:{userData:function(){this.ensureLoggedIn()}}},ja=Sa,La=n("34c3"),Va=Object(I["a"])(ja,Ta,Pa,!1,null,"ad7a6620",null),Ea=Va.exports;R()(Va,{VAlert:me["a"],VApp:F["a"],VAppBarNavIcon:pe["a"],VCol:ht["a"],VContainer:mt["a"],VContent:N["a"],VDivider:ft["a"],VIcon:Jt["a"],VList:ge["a"],VListItem:be["a"],VListItemContent:we["a"],VListItemIcon:La["a"],VListItemTitle:we["b"],VNavigationDrawer:ke["a"],VRow:vt["a"],VSlideXTransition:M["f"],VSubheader:ia["a"]});var $a=n("7876"),Aa=n.n($a),Ia=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card-action",[n("h2",{staticClass:"flex text--secondary"},[t._v("Change Password for "+t._s(t.userData.username))]),n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{name:"oldPassword",label:"Old Password",type:"password",autofocus:"",rules:t.rules},model:{value:t.oldPassword,callback:function(e){t.oldPassword=e},expression:"oldPassword"}}),n("v-text-field",{attrs:{name:"newPassword",label:"New Password",type:"password",rules:t.rules},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),n("v-text-field",{attrs:{name:"repeatPassword",label:"Repeat Password",type:"password",rules:t.repeatRules},model:{value:t.repeatPassword,callback:function(e){t.repeatPassword=e},expression:"repeatPassword"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"warning",loading:t.loading,disabled:!t.valid},on:{click:t.changePassword}},[t._v("Change")])],1)],1)},Ua=[],Ra=[function(t){return!!t||"Required"},function(t){return t&&t.length>4&&t.length<20||"Length is not valid"}],Fa={name:"change-password",props:["userData","toast"],data:function(){var t=this;return{loading:!1,oldPassword:"",newPassword:"",repeatPassword:"",valid:!1,rules:Ra,repeatRules:Ra.concat([function(e){return e===t.newPassword||"Repeat password should equal to new password"}])}},methods:{changePassword:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","change"),"POST",{username:this.userData.username,oldPassword:this.oldPassword,newPassword:this.newPassword},!1).then((function(e){t.toast("Success!","success"),t.$router.go(-1)})).catch((function(e){t.toast(e,"error")})).finally((function(e){t.loading=!1})))}}},Na=Fa,Ma=Object(I["a"])(Na,Ia,Ua,!1,null,"d19c8c56",null),Ba=Ma.exports;R()(Ma,{VBtn:dt["a"],VCardActions:Bt["a"],VForm:Le["a"],VSpacer:Kt["a"],VTextField:_e["a"]});var qa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card-action",[n("h2",{staticClass:"flex text--secondary"},[t._v("Remote Login")]),n("v-form",{ref:"form",on:{submit:function(t){t.preventDefault()}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{name:"loginCode",label:"Login Code",type:"number",autofocus:"",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.scanCode(e)}},model:{value:t.loginCode,callback:function(e){t.loginCode=e},expression:"loginCode"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.scanCode}},[t._v("Login")])],1),n("v-dialog",{attrs:{persistent:"","max-width":"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Remote Login")]),n("v-card-text",[t._v("Will login at "+t._s(t.loginMeta.os)+" "+t._s(t.loginMeta.browser)+" device on "+t._s(t.loginMeta.ip))]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"error",text:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("Nope")]),n("v-btn",{attrs:{color:"info",text:""},on:{click:t.confirmCode}},[t._v("OK")])],1)],1)],1)],1)},Ja=[],Wa={name:"remote-login",props:["userData","toast"],data:function(){return{loginCode:"",valid:!1,loading:!1,rules:[function(t){return!!t||"Required"},function(t){return[].every.call(t,(function(t){return!isNaN(parseInt(t))}))||"Code should be digits"},function(t){return t&&6===t.length||"Length should be 6"}],dialog:!1,loginMeta:{os:"",browser:"",ip:""}}},methods:{scanCode:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,st.fetchJSON(st.apiFor("login","code","scan",this.loginCode),"POST").then((function(e){if(!e.success)return t.toast(e.msg,"error"),void(t.loading=!1);t.loginMeta=e.msg,t.dialog=!0,t.loading=!1})).catch((function(e){t.loading=!1,t.toast("Network error.","error")})))},confirmCode:function(){var t=this;this.loading=!0,st.fetchJSON(st.apiFor("login","code","confirm",this.loginCode),"POST").then((function(e){e.success||t.toast(e.msg,"error"),t.toast("I assume that you are teleported to another device","success"),t.dialog=!1,st.redirectTo({name:"userspace"})})).catch((function(e){t.toast("Network error","error")}))}},watch:{dialog:function(t){t||(this.loading=!1)}}},Ha=Wa,Ya=Object(I["a"])(Ha,qa,Ja,!1,null,"a8460596",null),Ga=Ya.exports;R()(Ya,{VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardText:Bt["b"],VCardTitle:Bt["c"],VDialog:ve["a"],VForm:Le["a"],VSpacer:Kt["a"],VTextField:_e["a"]});var za=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-btn",{attrs:{text:""},nativeOn:{click:function(e){t.addUser.form=!0}}},[n("v-icon",[t._v("person_add")])],1),n("v-data-table",{staticClass:"elevation-1",attrs:{items:t.userList,loading:t.loading,headers:t.headers},scopedSlots:t._u([{key:"item.role",fn:function(e){return[n("v-btn",{attrs:{icon:"",small:"",disabled:e.item.role<=0},on:{click:function(n){return t.shiftRole(e.item,-1)}}},[t._v("-")]),t._v(" "+t._s(e.item.role)+" "),n("v-btn",{attrs:{icon:"",small:"",disabled:e.item.role+1>=t.userData.role},on:{click:function(n){return t.shiftRole(e.item,1)}}},[t._v("+")])]}},{key:"item.action",fn:function(e){return[n("v-btn",{attrs:{icon:"",color:"secondary"},on:{click:function(n){return t.setPasswordForm(e.item.username)}}},[n("v-icon",[t._v("edit")])],1),n("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(n){return t.deleteUserForm(e.item.username)}}},[n("v-icon",[t._v("delete")])],1)]}},{key:"no-data",fn:function(){return[n("div",[t._v("I am sorry to announce that you can manage nobody. :(")])]},proxy:!0}])},[n("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1),n("v-layout",{attrs:{row:"","justify-center":""}},[n("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.addUser.form,callback:function(e){t.$set(t.addUser,"form",e)},expression:"addUser.form"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[t._v("Add User")])]),n("v-card-text",[n("v-form",{model:{value:t.addUser.valid,callback:function(e){t.$set(t.addUser,"valid",e)},expression:"addUser.valid"}},[n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{rules:t.addUser.rules,label:"Username",required:""},model:{value:t.addUser.username,callback:function(e){t.$set(t.addUser,"username",e)},expression:"addUser.username"}})],1),n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{rules:t.addUser.rules,label:"Password",type:"password",required:""},model:{value:t.addUser.password,callback:function(e){t.$set(t.addUser,"password",e)},expression:"addUser.password"}})],1),n("v-flex",{attrs:{xs12:"",sm6:""}},[n("v-select",{attrs:{items:t.addUser.items,label:"Permission Level",required:""},model:{value:t.addUser.role,callback:function(e){t.$set(t.addUser,"role",e)},expression:"addUser.role"}})],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},nativeOn:{click:function(e){t.addUser.form=!1}}},[t._v("Close")]),n("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:!t.addUser.valid,loading:t.loading},on:{click:t.doAddUser}},[t._v("Add")])],1)],1)],1),n("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.loginForm,callback:function(e){t.loginForm=e},expression:"loginForm"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[t._v("Enter Password")])]),n("v-card-text",[n("h4",[t._v("For your safety, please input your password.")]),n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{label:"Password",type:"password",required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getSUToken(e)}},model:{value:t.loginPassword,callback:function(e){t.loginPassword=e},expression:"loginPassword"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:t.leave}},[t._v("Close")]),n("v-btn",{attrs:{color:"info",text:""},on:{click:t.getSUToken}},[t._v("OK")])],1)],1)],1)],1),n("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.setPassword.form,callback:function(e){t.$set(t.setPassword,"form",e)},expression:"setPassword.form"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[t._v("Set Password of "+t._s(t.setPassword.username))])]),n("v-card-text",[n("v-form",{on:{submit:function(t){t.preventDefault()}},model:{value:t.setPassword.valid,callback:function(e){t.$set(t.setPassword,"valid",e)},expression:"setPassword.valid"}},[n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{rules:t.addUser.rules,label:"Password",type:"password",required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSetPassword(e)}},model:{value:t.setPassword.password,callback:function(e){t.$set(t.setPassword,"password",e)},expression:"setPassword.password"}})],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},nativeOn:{click:function(e){t.setPassword.form=!1}}},[t._v("Close")]),n("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:!t.setPassword.valid,loading:t.loading},on:{click:t.doSetPassword}},[t._v("Set")])],1)],1)],1),n("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.deleteUser.form,callback:function(e){t.$set(t.deleteUser,"form",e)},expression:"deleteUser.form"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline error--text"},[t._v("Delete "+t._s(t.deleteUser.username))])]),n("v-card-text",[n("span",[t._v("Please make sure by retyping username")]),n("v-form",{on:{submit:function(t){t.preventDefault()}},model:{value:t.deleteUser.valid,callback:function(e){t.$set(t.deleteUser,"valid",e)},expression:"deleteUser.valid"}},[n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{rules:t.deleteUser.rules,label:"Retype Username",required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doDeleteUser(e)}},model:{value:t.deleteUser.typedUsername,callback:function(e){t.$set(t.deleteUser,"typedUsername",e)},expression:"deleteUser.typedUsername"}})],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},nativeOn:{click:function(e){t.deleteUser.form=!1}}},[t._v("Close")]),n("v-btn",{attrs:{color:"error",text:"",disabled:!t.deleteUser.valid,loading:t.loading},on:{click:t.doDeleteUser}},[t._v("Delete")])],1)],1)],1)],1)},Ka=[],Xa={name:"user-management",props:["userData","toast"],data:function(){var t=this;return{suToken:"",loading:!1,userList:[],headers:[{text:"Username",align:"left",sortable:!0,value:"username"},{text:"Role Level",value:"role"},{text:"Action",value:"action"}],loginForm:!1,addUser:{form:!1,username:"",password:"",role:0,items:Array.from(Array(this.userData.role).keys()).map((function(t,e){return{text:"Level ".concat(e),value:e}})),rules:[function(t){return!!t||"Required"},function(t){return t&&t.length>4&&t.length<20||"Length is not valid"}],valid:!1},setPassword:{form:!1,valid:!1,username:"",password:""},deleteUser:{form:!1,valid:!1,username:"",typedUsername:"",rules:[function(e){return e&&e.toLowerCase()===t.deleteUser.username.toLowerCase()||"Username should be same to target user"}]},loginPassword:""}},methods:{leave:function(){this.$router.go(-1)},getSUToken:function(){var t=this;this.loading=!0,st.fetchJSON(st.apiFor("user","su"),"POST",{password:this.loginPassword}).then((function(e){if(t.loading=!1,!e.success)return t.toast("Wrong Password","error"),void(t.loginPassword="");t.loginForm=!1,t.suToken=e.token,st.saveSUToken(e.token),t.loadUser()}))},loadUser:function(){var t=this;this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","list")).then((function(e){t.loading=!1,t.userList=e})).catch((function(e){t.toast(e,"error"),t.leave()}))},doAddUser:function(){var t=this;this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","add"),"POST",{username:this.addUser.username,password:this.addUser.password,role:this.addUser.role,token:this.suToken},!1).then((function(e){t.addUser.form=!1,t.addUser.username="",t.addUser.password="",t.loadUser()})).catch((function(e){t.toast(e,"error")})).finally((function(e){t.loading=!1}))},setPasswordForm:function(t){this.setPassword.username=t,this.setPassword.form=!0},doSetPassword:function(){var t=this;this.setPassword.valid&&(this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","change"),"POST",{username:this.setPassword.username,newPassword:this.setPassword.password,token:this.suToken},!1).then((function(e){t.toast("Why must you change the password?","success"),t.setPassword.form=!1})).catch((function(e){t.toast(e,"error")})).finally((function(e){t.loading=!1})))},deleteUserForm:function(t){this.deleteUser.username=t,this.deleteUser.form=!0},doDeleteUser:function(){var t=this;this.deleteUser.valid&&(this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","remove"),"POST",{username:this.deleteUser.username,token:this.suToken},!1).then((function(e){t.toast("Success!","success"),t.deleteUser.form=!1,t.loadUser()})).catch((function(e){t.toast(e,"error")})).finally((function(e){t.loading=!1})))},shiftRole:function(t,e){var n=this,a=t.role+e;this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","change-role"),"POST",{username:t.username,role:a,token:this.suToken},!1,!1).then((function(){t.role=a,n.loading=!1,n.toast("It feels good to change privileges, right?","success")})).catch((function(t){n.loading=!1,n.toast("There must be something wrong","error")}))}},mounted:function(){var t=st.getSUToken();if(!this.userData.role)return this.toast("You are not supposed to do this.","warning"),this.leave();this.suToken=t,t?this.loadUser():this.loginForm=!0,this.$route.params.firstRun&&(this.addUser.form=!0)},watch:{"setPassword.form":function(){this.setPassword.password=""},"deleteUser.form":function(){this.deleteUser.password=""}}},Za=Xa,Qa=n("8fea"),tr=n("0e8f"),er=Object(I["a"])(Za,za,Ka,!1,null,"1b4fcb0e",null),nr=er.exports;R()(er,{VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardText:Bt["b"],VCardTitle:Bt["c"],VContainer:mt["a"],VDataTable:Qa["a"],VDialog:ve["a"],VFlex:tr["a"],VForm:Le["a"],VIcon:Jt["a"],VLayout:Ht["a"],VProgressLinear:Ve["a"],VSelect:sa["a"],VSpacer:Kt["a"],VTextField:_e["a"]});var ar=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card-action",[n("h1",{staticClass:"primary--text display-1"},[t._v("Well met, "+t._s(t.userData.nickname)+"("+t._s(t.userData.username)+")!")]),n("p",[t._v("There are "+t._s(t.posts)+" posts from your perspective.")]),n("p",[t._v("Take it easy casuse I will NOT break your legs in this page.")])])},rr=[],or={name:"ConsoleIndex",props:["userData","toast"],data:function(){return{posts:"Loading..."}},methods:{loadPostCount:function(){var t=this;st.fetchJSON(st.apiFor("posts"),"GET",{limit:1}).then((function(e){t.posts=e.total}))}},mounted:function(){this.loadPostCount()}},sr=or,ir=Object(I["a"])(sr,ar,rr,!1,null,null,null),cr=ir.exports,lr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:"",sm12:""}},[t.isTokenExpired?n("div",[n("h1",[t._v("Your token has expired")])]):n("div",[n("h1",[t._v("Your token will be expired @")]),n("v-time-picker",{attrs:{landscape:"",readonly:"",format:"24h"},model:{value:t.tokenExpiryTime,callback:function(e){t.tokenExpiryTime=e},expression:"tokenExpiryTime"}})],1),t.userData.rftoken?n("div",[t.isRefreshTokenExpired?n("div",[n("h1",[t._v("Your refresh token has expired")]),n("v-btn",{attrs:{to:{name:"login",params:{logout:!0}},color:"warning"}},[n("v-icon",[t._v("exit_to_app")]),t._v("Re-Login ")],1)],1):n("div",[n("h1",[t._v("Your refresh token will be expired @")]),n("v-flex",{attrs:{md12:"",lg12:""}},[n("v-date-picker",{attrs:{readonly:"",color:"accent","header-color":"primary"},model:{value:t.rfTokenExpiryDate,callback:function(e){t.rfTokenExpiryDate=e},expression:"rfTokenExpiryDate"}}),n("v-time-picker",{attrs:{readonly:"",color:"primary",format:"24h"},model:{value:t.rfTokenExpiryTime,callback:function(e){t.rfTokenExpiryTime=e},expression:"rfTokenExpiryTime"}})],1),n("v-btn",{attrs:{color:"primary"},on:{click:t.refreshToken}},[n("v-icon",[t._v("refresh")]),t._v("Refresh ")],1)],1)]):t._e()])],1)},ur=[],dr={props:["userData","toast"],data:function(){return{get rfToken(){return st.getLoginData().rftoken}}},computed:{tokenExpiryTime:function(){return this.getTimeOf(this.tokenExpiryDatetime)},tokenExpiryDatetime:function(){return st.getTokenExpiryTime(this.loginToken)},rfTokenExpiryDatetime:function(){return st.getTokenExpiryTime(this.rfToken)},rfTokenExpiryDate:function(){var t=this.rfTokenExpiryDatetime;return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate())},rfTokenExpiryTime:function(){var t=this.rfTokenExpiryDatetime;return this.getTimeOf(t)},isRefreshTokenExpired:function(){return this.rfTokenExpiryDatetime<new Date},isTokenExpired:function(){return this.tokenExpiryDatetime<new Date},loginToken:{get:function(){return st.getLoginData().token},set:function(){return 0}}},methods:{makeRedirect:function(t){st.setRedirect(this.$route.fullPath),st.redirectTo(t)},refreshToken:function(){var t=this;st.refreshToken().then((function(e){t.toast("+1h O..O","success"),++t.loginToken})).catch((function(e){t.toast(e,"error"),t.makeRedirect({name:"login"})}))},getTimeOf:function(t){return"".concat(t.getHours(),":").concat(t.getMinutes())}}},hr=dr,mr=n("2e4b"),fr=n("c964"),pr=Object(I["a"])(hr,lr,ur,!1,null,null,null),vr=pr.exports;R()(pr,{VBtn:dt["a"],VDatePicker:mr["a"],VFlex:tr["a"],VIcon:Jt["a"],VLayout:Ht["a"],VTimePicker:fr["b"]});var gr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nav-bar",{attrs:{userData:t.userData,route:this.$route.fullPath}}),n("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.realWindowTitle,expression:"realWindowTitle"}]}),n("v-parallax",{attrs:{dark:"",src:t.bannerImage}},[n("v-row",{attrs:{align:"center",column:"",justify:"center"}},[n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[t.userInfo.avatar?n("div",[n("v-avatar",{staticClass:"elevation-7",attrs:{size:"128px"}},[n("v-img",{attrs:{src:t.userInfo.avatar,alt:t.userInfo.username}})],1),n("br"),n("br")],1):t._e(),n("h1",{staticClass:"display-2 font-weight-regular mb-3"},[t._v(t._s(t.realTitle))]),t.userFound?n("h2",{staticClass:"subtitle-1"},[t._v(" "+t._s(t.mottoText)+" ")]):n("h2",{staticClass:"subtitle-1"},[t._v(" This guy is a mystery. ")])])],1)],1),n("v-container",[n("v-card-text",{staticClass:"py-0"},[n("v-timeline",{attrs:{dense:t.$vuetify.breakpoint.smAndDown}},[n("v-slide-x-transition",{attrs:{group:""}},t._l(t.postData,(function(e){return n("v-timeline-item",{key:e.id,attrs:{"fill-dot":"",color:"accent"}},[!t.userInfo.username&&e.author&&e.author.avatar?n("v-avatar",{attrs:{slot:"icon"},slot:"icon"},[n("v-img",{attrs:{src:e.author.avatar}})],1):t._e(),n("div",{staticClass:"headline font-weight-bold",attrs:{slot:"opposite"},slot:"opposite"},[n("h4",[t._v(t._s(e.datetime.toLocaleDateString()))]),t.userInfo.username?t._e():n("h3",{staticClass:"secondary-text"},[t._v(t._s(e.author&&e.author.nickname))]),t._l(e.tags,(function(e){return n("router-link",{key:e,attrs:{to:{name:"index",params:{tag:e},query:{tag:e}}}},[n("v-chip",[t._v(t._s(e))])],1)})),e.secret?n("v-chip",{attrs:{color:"success","text-color":"white"}},[n("v-avatar",{attrs:{left:""}},[n("v-icon",[t._v("lock")]),t._v(t._s(e.secret)+" ")],1),t._v(" Secret ")],1):t._e()],2),n("div",{staticClass:"py-3",class:{scale:e.clicked,"scale-finished":1===e.clicked,"scale-back":-1===e.clicked}},[n("v-card",{attrs:{dark:"",color:"primary",elevation:"2"}},[n("v-card-title",{staticClass:"title"},[t._v(t._s(e.title))]),n("v-card-text",[n("p",[t._v(t._s(e.subtitle))]),n("v-btn",{staticClass:"mx-0",attrs:{outlined:"",rounded:"",color:"secondary"},on:{click:function(n){return t.manuallyLoadPost(e)}}},[n("v-icon",[t._v("unfold_more")])],1)],1)],1)],1)],1)})),1)],1),n("v-row",{attrs:{align:"center",column:"",justify:"center"}},[n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.loadNextPage,expression:"loadNextPage"}]},[t.currentPage<t.totalPages?n("div",[n("v-btn",{attrs:{loading:t.loading,small:"",block:"",color:"secondary",dark:""},on:{click:t.loadNextPage}},[n("v-icon",[t._v("keyboard_arrow_down")])],1)],1):t.loading?n("div",[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):t.postData.length?n("div",[n("v-divider"),t._v(" Tiro Finale ")],1):t._e()])])],1)],1),n("blog-footer")],1)},br=[];function yr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function wr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yr(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yr(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var kr={data:function(){return{currentPage:1,totalPages:1,postData:[],loading:!1,hasLeft:!1,fromPost:0,userInfo:{username:"",avatar:"",nickname:"",banner:"",motto:""},userFound:!0}},props:{userData:Object},methods:{getPostData:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t=t||this.currentPage;var a={page:t,limit:6};this.loading=!0,st.fetchJSON(this.userInfo.username?st.apiFor("post","user",this.userInfo.username):st.apiFor("posts"),"GET",a).then((function(t){var a=t.data.map(y).map((function(t){return wr({},t,{datetime:new Date(t.created),clicked:!1})}));if(e.postData=n?e.postData.concat(a):a,e.totalPages=parseInt(t.pages),e.fromPost){var r=e.findPostBy(e.fromPost);r&&(r.clicked=-1,e.fromPost=0,setTimeout((function(){r.clicked=!1}),1e3))}e.loading=!1})).catch((function(t){console.error(t),e.loading=!1}))},manuallyLoadPost:function(t){var e=this;t.clicked=!0,st.fetchJSON(st.apiFor("post",t.id)).then((function(n){if(!n)return Promise.reject(ReferenceError("NPE"));var a=y(n);t.clicked=1,e.$router.push({name:"post",params:{changeRoute:!!t.displayId,data:a},query:{p:t.id}})})).catch((function(n){t.clicked=1,e.$router.push({name:"post",query:{p:t.id}})}))},loadNextPage:function(){this.currentPage>=this.totalPages||this.getPostData(++this.currentPage)},findPostBy:function(t){return this.postData.find((function(e){return e.id==t||e.displayId===t}))},getUserMeta:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("user","user-meta"),"GET",{username:this.userInfo.username}).then((function(e){t.userInfo=y(e)})).catch((function(e){t.userFound=!1,t.userInfo.nickname="John Appleseed"}))}},mounted:function(){this.$route.params.username&&(this.userInfo.username=this.userInfo.nickname=this.$route.params.username,this.getUserMeta()),this.getPostData(1,!1)},watch:{userData:function(){this.currentPage=1,this.totalPages=1,this.getPostData(1,!1)}},computed:{realTitle:function(){return this.userInfo.nickname||this.userInfo.username||this.$route.meta.title},bannerImage:function(){return this.userInfo&&this.userInfo.banner||this.config.images.timelineBannerImage},mottoText:function(){return this.userInfo.motto||"The fate of a person, of course, depends on self-strengthening, but also on the journey of the history."},realWindowTitle:function(){return this.userInfo.username?"".concat(this.userInfo.nickname,"'s Timeline"):this.$route.meta.title}},beforeRouteEnter:function(t,e,n){n((function(t){t.fromPost=e.query.p||e.params.postLink}))}},_r=kr,Dr=(n("217c"),Object(I["a"])(_r,gr,br,!1,null,"07f36b9c",null)),xr=Dr.exports;R()(Dr,{VAvatar:Nt["a"],VBtn:dt["a"],VCard:Mt["a"],VCardText:Bt["b"],VCardTitle:Bt["c"],VChip:qt["a"],VCol:ht["a"],VContainer:mt["a"],VDivider:ft["a"],VIcon:Jt["a"],VImg:Wt["a"],VParallax:Gt["a"],VProgressCircular:pt["a"],VRow:vt["a"],VSlideXTransition:M["f"],VTimeline:oe["a"],VTimelineItem:se["a"]});var Cr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("div",[n("h2",{staticClass:"flex text--secondary"},[t._v("Nickname")]),n("v-form",{ref:"form",on:{submit:function(t){t.preventDefault()}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{name:"nickname",label:"Nickname",type:"text",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeNickname(e)}},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.changeNickname}},[n("v-icon",[t._v("check")])],1)],1)],1),n("div",[n("h2",{staticClass:"flex text--secondary"},[t._v("Motto")]),n("v-form",{on:{submit:function(t){t.preventDefault()}}},[n("v-text-field",{attrs:{name:"motto",label:"Motto",type:"text",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeMotto(e)}},model:{value:t.motto,callback:function(e){t.motto=e},expression:"motto"}})],1),n("v-card-actions",[n("v-spacer"),t.motto?n("v-btn",{attrs:{color:"primary",loading:t.loading},on:{click:t.changeMotto}},[n("v-icon",[t._v("check")])],1):n("v-btn",{attrs:{color:"error",loading:t.loading},on:{click:t.changeMotto}},[n("v-icon",[t._v("remove_circle")])],1)],1)],1),n("div",[n("h2",{staticClass:"flex text--secondary"},[t._v("Avatar")]),n("v-form",{ref:"formA",on:{submit:function(t){t.preventDefault()}},model:{value:t.avatarValid,callback:function(e){t.avatarValid=e},expression:"avatarValid"}},[n("v-text-field",{attrs:{name:"avatar",label:"Avatar Image URL",type:"text",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeAvatar(!1)}},model:{value:t.avatar,callback:function(e){t.avatar=e},expression:"avatar"}})],1),n("v-card-actions",[t.avatar?n("div",[n("v-avatar",{staticClass:"elevation-7",attrs:{size:"64px"}},[n("img",{attrs:{src:t.avatar},on:{load:function(e){t.avatarValid=!0}}})]),n("br"),n("br")],1):n("v-btn",{attrs:{color:"error",loading:t.loading},on:{click:function(e){return t.changeAvatar(!0)}}},[n("v-icon",[t._v("remove_circle")])],1),n("v-spacer"),n("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.avatar||!t.avatarValid},on:{click:t.changeAvatar}},[n("v-icon",[t._v("check")])],1)],1)],1),n("div",[n("h2",{staticClass:"flex text--secondary"},[t._v("Banner Image")]),n("v-form",[n("v-text-field",{attrs:{name:"banner",label:"Banner Image URL",type:"text",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeBanner(!1)}},model:{value:t.banner,callback:function(e){t.banner=e},expression:"banner"}})],1),n("div",[t.banner?n("v-img",{attrs:{src:t.banner},on:{load:function(e){t.bannerValid=!0}}}):n("v-btn",{attrs:{color:"error",loading:t.loading},on:{click:function(e){return t.changeBanner(!0)}}},[n("v-icon",[t._v("remove_circle")])],1),n("v-spacer"),n("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.banner||!t.bannerValid},on:{click:t.changeBanner}},[n("v-icon",[t._v("check")])],1)],1)],1)])},Or=[];function Tr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Pr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tr(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tr(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Sr={name:"remote-login",props:["userData","toast"],data:function(){return{nickname:"",avatar:"",banner:"",motto:"",loading:!1,rules:[function(t){return!!t||"Required"}],valid:!1,avatarValid:!1,bannerValid:!1}},methods:{performChangeUserMeta:function(t,e){var n=this;return this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","change-meta"),"POST",{changes:Object(l["a"])({},t,e)}).then((function(t){return n.loading=!1,t})).catch((function(t){return n.loading=!1,Promise.reject(t)}))},changeNickname:function(){var t=this;if(this.valid)return this.loading=!0,this.changeInfo("nickname",this.nickname).then((function(e){t.userData.nickname=t.nickname,st.updateLoginData((function(e){return Pr({},e,{nickname:t.nickname})})),t.nickname=""}))},changeMotto:function(){return this.changeInfo("motto",this.motto)},changeAvatar:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||this.avatarValid&&this.avatar)return this.changeInfo("avatar",this.avatar).then((function(e){t.avatar=""}))},changeBanner:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||this.bannerValid&&this.banner)return this.changeInfo("banner",this.banner).then((function(e){t.banner=""}))},changeInfo:function(t,e){var n=this;return this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","change-meta"),"POST",{changes:Object(l["a"])({},t,e)}).then((function(e){return n.toast("Your ".concat(t," has changed!"),"success"),n.loading=!1,e})).catch((function(t){return n.loading=!1,n.toast("Emmm... Something is strange","error"),Promise.reject(t)}))},getUserMeta:function(){var t=this;this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("user","user-meta"),"GET",{username:this.userData.username}).then((function(e){t.loading=!1,t.nickname=e.nickname,t.avatar=e.avatar,t.banner=e.banner||"",t.motto=e.motto||""})).catch((function(e){t.loading=!1,t.toast(e,"error")}))}},watch:{avatar:function(){this.avatarValid=!1},banner:function(){this.bannerValid=!1}},mounted:function(){this.getUserMeta()}},jr=Sr,Lr=Object(I["a"])(jr,Cr,Or,!1,null,"130b2f96",null),Vr=Lr.exports;R()(Lr,{VAvatar:Nt["a"],VBtn:dt["a"],VCardActions:Bt["a"],VContainer:mt["a"],VForm:Le["a"],VIcon:Jt["a"],VImg:Wt["a"],VSpacer:Kt["a"],VTextField:_e["a"]});var Er=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("h2",[t._v("OAuth Accounts")])]),n("v-card-actions",t._l(t.adapterList,(function(e){var a=e.adapter,r=e.isBound,o=e.bindUser;return n("v-flex",{key:a},[r?n("div",[t.$vuetify.icons.values.brand[a]?n("v-icon",[t._v(t._s(t.$vuetify.icons.values.brand[a]))]):n("span",[t._v(t._s(a))]),t._v(" : "),n("span",[t._v(t._s(o))]),n("v-btn",{attrs:{icon:"",small:"",text:"",color:"error"},on:{click:function(e){return t.removeAdapter(a)}}},[n("v-icon",[t._v("clear")])],1)],1):n("v-btn",{attrs:{rounded:"",color:"accent",dark:"",loading:t.loading},on:{click:function(e){return t.goToBind(a)}}},[t.$vuetify.icons.values.brand[a]?n("v-icon",[t._v(t._s(t.$vuetify.icons.values.brand[a]))]):n("span",[t._v(t._s(a))])],1)],1)})),1)],1)],1)},$r=[];n("07ac");function Ar(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Ir(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ar(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ar(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ur={props:["userData","toast"],data:function(){return{loading:!1,adapters:[],myAdapters:[]}},methods:{getAdapters:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("login","oauth","adapters")).then((function(e){t.adapters=e})).catch((function(e){t.toast(e,"error")}))},getMyAdapters:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("oauth","list-bind-adapters")).then((function(e){t.myAdapters=e})).catch((function(e){t.toast(e,"error")}))},mergeAvailableAdapters:function(){var t=v(this.adapters.map((function(t){return[t,{adapter:t,isBound:!1,bindUser:null}]})));return this.myAdapters.forEach((function(e){var n=e.adapter,a=e.user;t[n]&&(t[n]=Ir({},t[n],{isBound:!0,bindUser:a}))})),Object.values(t)},goToBind:function(t){var e=this;this.loading=!0,st.fetchJSONWithSuccess(st.apiFor("oauth","bind",t,"url")).then((function(n){e.toast("We are now going to ".concat(t,"..."),"info"),location.href=n})).catch((function(t){e.loading=!1,e.toast("Oops! Failed.","error")}))},removeAdapter:function(t){var e=this;st.fetchJSONWithSuccess(st.apiFor("oauth","remove-adapter",t),"POST").then((function(){e.myAdapters=e.myAdapters.filter((function(e){return e.adapter!==t})),e.toast("Account Removed","success")})).catch((function(t){e.toast("Something is strange","error")}))}},computed:{adapterList:function(){return this.mergeAvailableAdapters()}},mounted:function(){if(this.getAdapters(),this.getMyAdapters(),this.$route.query.succeed||this.$route.query.error){var t=this.$route.query,e=t.succeed,n=t.error;this.$router.replace(Ir({},this.$route,{query:Ir({},this.$route.query,{succeed:void 0,error:void 0}),params:Ir({},this.$route.params,{succeed:e,error:n})}))}if(this.$route.params.succeed||this.$route.params.error){var a=this.$route.params,r=a.succeed,o=a.error;r?this.toast("Bind succeed: "+r,"success"):this.toast("Bind error: "+o,"error")}}},Rr=Ur,Fr=Object(I["a"])(Rr,Er,$r,!1,null,null,null),Nr=Fr.exports;R()(Fr,{VBtn:dt["a"],VCardActions:Bt["a"],VContainer:mt["a"],VFlex:tr["a"],VIcon:Jt["a"],VLayout:Ht["a"]});var Mr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card-action",[n("h2",{staticClass:"flex text--secondary"},[t._v("Two Step Auth")]),t.enabled?n("div",[n("h3",[t._v("You have enabled two step auth!")]),t.totpCode?n("div",[n("v-alert",{attrs:{type:"warning",value:!0}},[t._v(" Please make sure to keep this because it will display only once. ")]),n("h4",[t._v("Account: "+t._s(t.userData.username))]),n("h4",[t._v("Code: "+t._s(t.totpCode))]),n("p",[n("v-btn",{attrs:{small:"",rounded:"",href:t.totpUri,color:"primary"}},[t._v("Bind Now")]),n("v-btn",{attrs:{small:"",rounded:"",color:"primary"},on:{click:t.downloadAuthFile}},[t._v("Save")])],1),n("vue-qrcode",{attrs:{value:t.totpUri}})],1):t._e(),n("v-btn",{attrs:{color:"warning"},on:{click:t.handleDelete}},[t._v("Disable")])],1):n("div",[n("h3",[t._v("Two step auth is disabled")]),n("v-btn",{on:{click:t.enableTwoStepAuth}},[t._v("Enable")])],1),n("v-card-actions",[n("v-spacer")],1),n("v-dialog",{attrs:{persistent:"","max-width":"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("You need to confirm by typing code.")]),n("v-container",[n("v-form",{ref:"form",on:{submit:function(t){t.preventDefault()}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{name:"loginCode",label:"Auth Code",type:"number",autofocus:"",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.removeTwoStepAuth(e)}},model:{value:t.authCode,callback:function(e){t.authCode=e},expression:"authCode"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"error",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("Nope")]),n("v-btn",{attrs:{color:"info",flat:""},on:{click:t.removeTwoStepAuth}},[t._v("OK")])],1)],1)],1)],1)},Br=[],qr=(n("2b3d"),n("d56f")),Jr={components:{VueQrcode:qr["a"]},props:["userData","toast"],data:function(){return{enabled:!1,dialog:!1,totpCode:"",totpUri:"",authCode:"",nextCode:""}},methods:{enableTwoStepAuth:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("user","two-step-auth","bind"),"POST",{}).then((function(e){t.totpUri=e.url,t.totpCode=e.code,t.nextCode=e.nextCode,t.enabled=!0})).catch((function(e){t.toast("Oops, try again.","error")}))},checkTwoStepAuth:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("user","user-meta"),"GET",{username:this.userData.username}).then((function(e){t.enabled=e.totp})).catch((function(e){t.toast("Oops!","error")}))},removeTwoStepAuth:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("user","two-step-auth","remove"),"POST",{code:this.nextCode||this.authCode}).then((function(e){t.toast("Great! You are unsafe now!","success"),t.enabled=!1,t.dialog=!1})).catch((function(e){if(t.nextCode)return t.nextCode="",void(t.dialog=!0);t.toast("Somehow your code is wrong.","error")}))},handleDelete:function(){if(this.nextCode)return this.removeTwoStepAuth();this.dialog=!0},downloadAuthFile:function(){var t="\n      Account: ".concat(this.userData.username,"\n      Key: ").concat(this.totpCode,",\n      BindURL: ").concat(this.totpUri,"\n      ").split("\n").map((function(t){return t.trim()})).join("\n"),e=new Blob([t]),n=URL.createObjectURL(e),a=document.createElement("a");a.download="".concat(this.userData.username," - Roselia Blog.txt"),a.href=n,a.click(),setTimeout((function(){return URL.revokeObjectURL(n)}),4e4)}},mounted:function(){this.checkTwoStepAuth()}},Wr=Jr,Hr=Object(I["a"])(Wr,Mr,Br,!1,null,null,null),Yr=Hr.exports;R()(Hr,{VAlert:me["a"],VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardTitle:Bt["c"],VContainer:mt["a"],VDialog:ve["a"],VForm:Le["a"],VSpacer:Kt["a"],VTextField:_e["a"]});var Gr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{wrap:""}},[n("v-col",{attrs:{xs:"12",sm:"12"}},[n("div",[n("h1",[t._v("System Monitor")])]),n("v-card",{staticClass:"round-corner-card elevation-5 primary-card-gradient",attrs:{dark:"",shaped:""}},[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("div",{staticClass:"headline"},[t._v("Platform")]),n("h2",[t._v(" "+t._s(t.basic.os.node)+" ")]),n("span",{staticClass:"subtitle-1"},[n("v-icon",[t._v("desktop_mac")]),t._v(" "+t._s(t.basic.os.name)+" "+t._s(t.basic.os.version)+" ("+t._s(t.basic.os.platform)+") ")],1),n("p",[t._v(t._s(t.basic.os.serverInterpreter))]),n("v-divider"),t._v(" Refresh Loop: "),t.mainTimer?n("span",{staticClass:"subtitle-2"},[t._v(" On "),n("v-btn",{attrs:{icon:"",flat:"",dark:""},on:{click:t.stopLoop}},[n("v-icon",[t._v("pause")])],1)],1):n("span",{staticClass:"subtitle-2"},[t._v(" Off "),n("v-btn",{attrs:{icon:"",flat:"",dark:""},on:{click:t.startLoop}},[n("v-icon",[t._v("play_arrow")])],1)],1)],1)])],1),n("v-card",{staticClass:"round-corner-card elevation-5 secondary-card-gradient",attrs:{dark:"",shaped:""}},[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("div",{staticClass:"headline"},[t._v("CPU")]),n("h2",[t._v(" "+t._s(t.basic.cpu.name)+" ")]),n("span",{staticClass:"subtitle-1"},[t._v(" "+t._s(t.basic.cpu.totalCore)+" Cores "+t._s(t.basic.cpu.logicalCore)+" Threads ")])])]),n("v-divider"),n("v-card-title",[n("div",[n("v-progress-circular",{attrs:{rotate:-90,size:150,width:15,value:t.dynamic.cpu.total}},[n("span",{staticClass:"subtitle-1"},[t._v("Total: "+t._s(t.dynamic.cpu.total)+" %")])])],1),t.dynamic.cpu.logic.length>1?n("div",t._l(t.dynamic.cpu.logic,(function(e,a){return n("v-progress-circular",{key:a,attrs:{rotate:-90,size:100,width:15,value:e}},[n("span",{staticClass:"caption"},[t._v("Core"+t._s(a)+": "+t._s(e)+" % ")])])})),1):t._e()])],1),n("v-card",{staticClass:"round-corner-card elevation-5 secondary-card-gradient",attrs:{dark:"",shaped:""}},[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("div",{staticClass:"headline"},[t._v("Memory")]),n("h3",[t._v(" Virtual Memory ")]),n("p",{staticClass:"subtitle-1"},[t._v(t._s(t.usedMemory)+" Used")]),n("p",{staticClass:"subtitle-1"},[t._v(t._s(t.availableMemory)+" Available")]),n("p",{staticClass:"subtitle-1"},[t._v(t._s(t.totalMemory)+" Total")]),n("v-icon",[t._v("memory")]),t._v(" "+t._s(t.dynamic.memory.percent)+" % "),n("v-progress-linear",{attrs:{"background-color":"info",color:"warning",value:t.dynamic.memory.percent}})],1)])],1),n("div",[n("div",[n("h1",[t._v("Revoke All Issued Tokens")]),n("v-col",{attrs:{rows:"12"}},[n("v-alert",{attrs:{value:!0,type:"warning"}},[t._v(" This will revoke all issued tokens, and you will be logged out after that. ")])],1),n("v-btn",{attrs:{color:"warning"},on:{click:t.refreshSalt,mouseleave:function(e){t.confirmRefresh=!1}}},[n("v-icon",[t._v("cloud_off")]),t._v(" "+t._s(t.confirmRefresh?"Confirm ":"")+"Revoke ")],1)],1)])],1)],1)],1)},zr=[],Kr=(n("b680"),{props:["userData","toast"],data:function(){return{basic:{cpu:{logicalCore:0,totalCore:0,name:""},os:{name:"",node:"",platform:"",version:"",serverInterpreter:""}},dynamic:{cpu:{total:0,logic:[]},memory:{percent:0,total:0,used:0,available:0}},mainTimer:0,removeBlurListener:null,removeFocusListener:null,confirmRefresh:!1}},computed:{usedMemory:function(){return this.readableMemory(this.dynamic.memory.used)},availableMemory:function(){return this.readableMemory(this.dynamic.memory.available)},totalMemory:function(){return this.readableMemory(this.dynamic.memory.total)}},methods:{getBasicInfo:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("system","basic-info")).then(y).then((function(e){t.basic=e})).catch((function(e){t.toast("You can not access such info.","error")}))},getDynamicInfo:function(){var t=this;st.fetchJSONWithSuccess(st.apiFor("system","dynamic-info")).then(y).then((function(e){t.dynamic=e})).catch((function(e){t.destroyTimer(),t.toast("You can not access such info.","error")}))},readableMemory:function(t){var e=["B","KB","MB","GB","TB","TB"],n=e.reduce((function(t){var e=Object(u["a"])(t,2),n=e[0],a=e[1];return n<1024?[n,a]:[n/1024,a+1]}),[t,0]),a=Object(u["a"])(n,2),r=a[0],o=a[1];return r.toFixed(2)+e[o]},refreshSalt:function(){var t=this;this.confirmRefresh?(this.confirmRefresh=!1,st.fetchJSONWithSuccess(st.apiFor("system","refresh-salt"),"POST").then((function(){t.toast("Tokens revoked","success"),t.$router.push({name:"login",params:{logout:!0,alert:{color:"info",text:"All tokens revoked, so is your token, please login again."}}})})).error((function(e){t.toast("Something is wrong","error")}))):this.confirmRefresh=!0},setListenerByVisibility:function(){document.hidden?this.destroyTimer():this.createTimer()},createTimer:function(){this.mainTimer||(this.mainTimer=setInterval(this.getDynamicInfo,2e3))},destroyTimer:function(){this.mainTimer&&(clearInterval(this.mainTimer),this.mainTimer=null)},setFocusTriggers:function(){this.removeBlurListener||(this.removeBlurListener=st.addEventListener("blur",this.destroyTimer)),this.removeFocusListener||(this.removeFocusListener=st.addEventListener("focus",this.createTimer))},destroyFocusTriggers:function(){this.removeBlurListener&&this.removeBlurListener(),this.removeFocusListener&&this.removeFocusListener(),this.removeBlurListener=this.removeFocusListener=null},startLoop:function(){this.createTimer(),this.setFocusTriggers()},stopLoop:function(){this.destroyFocusTriggers(),this.destroyTimer()}},mounted:function(){this.getBasicInfo(),this.getDynamicInfo(),this.createTimer(),this.setFocusTriggers()},beforeDestroy:function(){this.destroyTimer(),this.destroyFocusTriggers()}}),Xr=Kr,Zr=(n("84f6"),Object(I["a"])(Xr,Gr,zr,!1,null,"249aef01",null)),Qr=Zr.exports;R()(Zr,{VAlert:me["a"],VBtn:dt["a"],VCard:Mt["a"],VCardTitle:Bt["c"],VCol:ht["a"],VContainer:mt["a"],VDivider:ft["a"],VIcon:Jt["a"],VProgressCircular:pt["a"],VProgressLinear:Ve["a"],VRow:vt["a"]});var to=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{wrap:""}},[n("div",[n("div",[n("h1",[t._v("Clear All Drafts")]),n("v-col",{attrs:{md:"12",lg:"12"}},[n("v-alert",{attrs:{value:!0,type:"warning"}},[t._v(" This will remove all post drafts and this action can not be undone. ")])],1),n("v-btn",{attrs:{color:"warning"},on:{click:t.removeDrafts,mouseleave:function(e){t.confirmClear=!1}}},[n("v-icon",[t._v("delete_sweep")]),t._v(" "+t._s(t.confirmClear?"Yes, ":"")+"Clear ")],1)],1)]),n("v-col",{attrs:{xs:"12",sm:"12"}},[t.drafts.length?n("div",[n("h1",[t._v("Manage Drafts")])]):t._e(),n("v-row",{attrs:{wrap:""}},[n("v-col",{attrs:{md:"6",sm:"12"}},t._l(t.drafts,(function(e){return n("v-scale-transition",{key:e.id},[n("v-card",{staticClass:"round-corner-card primary-card-gradient",attrs:{hover:"",dark:"",shaped:""}},[e.img?n("v-img",{attrs:{src:e.img}}):t._e(),n("v-card-title",{attrs:{"primary-title":""}},[n("div",[e.id?n("span",[t._v("#"+t._s(e.id))]):n("span",[t._v("New Post")]),n("h1",{staticClass:"headline"},[t._v(t._s(e.title||"Untitled"))]),n("h2",[t._v(" "+t._s(e.subtitle)+" ")]),e.author?n("span",[t._v(" "+t._s(e.author.nickname)+" ")]):n("span",[t._v(t._s(t.userData.nickname))])])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{icon:"",to:{name:"edit",query:{post:e.id}}}},[n("v-icon",[t._v("mode_edit")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(n){return t.removeDraft(e.id)}}},[n("v-icon",[t._v("delete")])],1)],1)],1)],1)})),1)],1)],1)],1)],1)},eo=[],no={name:"DraftManage",props:{toast:Function,userData:Object},data:function(){return{drafts:[],confirmClear:!1}},methods:{removeDrafts:function(){if(this.confirmClear){this.confirmClear=!1;var t=localStorage;Array.from(Array(t.length).keys()).map(t.key.bind(t)).filter((function(t){return t.startsWith("postDraft")})).forEach((function(e){t.removeItem(e)})),this.toast("Drafts cleaned!","success"),this.loadDrafts()}else this.confirmClear=!0},loadDrafts:function(){var t=localStorage;this.drafts=Array.from(Array(t.length).keys()).map(t.key.bind(t)).filter((function(t){return t.startsWith("postDraft")})).map((function(e){return JSON.parse(t.getItem(e)).data}))},removeDraft:function(t){localStorage.removeItem("postDraft#".concat(t)),this.loadDrafts()}},computed:{},mounted:function(){this.loadDrafts()}},ao=no,ro=(n("6155"),Object(I["a"])(ao,to,eo,!1,null,"4d4a5867",null)),oo=ro.exports;R()(ro,{VAlert:me["a"],VBtn:dt["a"],VCard:Mt["a"],VCardActions:Bt["a"],VCardTitle:Bt["c"],VCol:ht["a"],VContainer:mt["a"],VIcon:Jt["a"],VImg:Wt["a"],VRow:vt["a"],VScaleTransition:M["e"],VSpacer:Kt["a"]}),a["default"].use(J["a"]),a["default"].use(Aa.a);var so=new J["a"]({mode:"history",base:Z.urlPrefix,routes:[{path:"/hello",name:"helloWorld",component:bt},{path:"/",name:"index",component:Zt,meta:{title:Z.title}},{path:"/login",name:"login",component:Ie,meta:{title:"Login"}},{path:"/post",name:"post",component:Yn,children:[{path:"shared/:shareId",name:"sharedPost",component:Yn},{path:":postLink",name:"postWithEternalLink",component:Yn}]},{path:"/edit",alias:"/add",name:"edit",component:wa},{path:"/userspace",alias:"/me",name:"userspace",component:Ea,meta:{title:"Console"},children:[{path:"change-password",name:"changePassword",component:Ba,meta:{title:"Change Password"}},{path:"remote-login",name:"remoteLogin",component:Ga,meta:{title:"Remote Login"}},{path:"user-management",name:"userManagement",component:nr,meta:{title:"Manage Users"}},{path:"token-refresh",name:"tokenRefresh",component:vr,meta:{title:"Refresh Tokens"}},{path:"account-settings",name:"setNickname",component:Vr,meta:{title:"Account Settings"}},{path:"oauth-accounts",name:"oauthAccounts",component:Nr,meta:{title:"OAuth Accounts"}},{path:"2-step-auth",name:"twoStepAuth",component:Yr,meta:{title:"Two Factor Authentication"}},{path:"system-monitor",name:"systemMonitor",component:Qr,meta:{title:"System Monitor"}},{path:"manage-drafts",name:"manageDrafts",component:oo,meta:{title:"Draft Management"}},{path:"/",name:"console-index",component:cr,meta:{title:"Roselia-Blog Console"}}]},{path:"/timeline",name:"timeline",component:xr,meta:{title:"Timeline"},children:[{name:"userTimeline",path:":username",component:xr}]},{path:"*",name:"notFound",alias:"/404",component:Oa,meta:{title:"404 Not Found"}}]}),io=n("f309"),co=n("25a2");a["default"].use(io["a"]);var lo=new io["a"]({theme:{themes:{light:Z.theme,dark:{}},options:{customProperties:!0}},customProperties:!0,lang:{locales:{zhHans:co["a"]},current:"zh-Hans"},icons:{values:{brand:new Proxy({},{get:function(t,e){return Reflect.has(t,e)?Reflect.get(t,e):"string"===typeof e?"fab fa-".concat(e):void 0}})},iconfont:"md"}});function uo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ho(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?uo(n,!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uo(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}a["default"].use(xn["a"]);var mo=new xn["a"].Store({state:{commentDraft:{}},mutations:{setCommentDraft:function(t,e){t.commentDraft=ho({},t.commentDraft,Object(l["a"])({},e.commentId,e.comment))},removeCommentDraft:function(t,e){t.commentDraft=ho({},t.commentDraft,Object(l["a"])({},e,void 0))}},actions:{},getters:{}}),fo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-snackbar",{attrs:{color:t.color,top:"",right:"",timeout:6e3},model:{value:t.showSelf,callback:function(e){t.showSelf=e},expression:"showSelf"}},[t._v(" "+t._s(t.text)+" "),n("v-btn",{attrs:{text:""},on:{click:function(e){t.showSelf=!1}}},[t._v(" Close ")])],1)},po=[],vo={name:"toast",props:["show","text","color"],model:{prop:"show",event:"showChange"},computed:{showSelf:{get:function(){return this.show},set:function(t){this.$emit("showChange",t)}}}},go=vo,bo=n("2db4"),yo=Object(I["a"])(go,fo,po,!1,null,"2c18f844",null),wo=yo.exports;R()(yo,{VBtn:dt["a"],VSnackbar:bo["a"]});var ko=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-footer",{staticClass:"oneness",attrs:{height:"auto"}},[n("v-row",{attrs:{justify:"center",wrap:""}},[n("v-col",{staticClass:"themed-text text-center lighten-2 py-3",attrs:{cols:"12"}},[t._v(" "+t._s(t.year)+"  "),n("strong",[t._v(t._s(t.name))])])],1)],1)},_o=[],Do={name:"blog-footer",data:function(){return{year:(new Date).getFullYear(),title:Z.title,motto:Z.motto,name:Z.footerName}}},xo=Do,Co=(n("38c8"),n("553a")),Oo=Object(I["a"])(xo,ko,_o,!1,null,"1787f854",null),To=Oo.exports;R()(Oo,{VCol:ht["a"],VFooter:Co["a"],VRow:vt["a"]});var Po=n("26b9"),So=n.n(Po),jo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{directives:[{name:"scroll",rawName:"v-scroll",value:t.recordScroll,expression:"recordScroll"},{name:"resize",rawName:"v-resize",value:t.recordHeight,expression:"recordHeight"}]},[n("v-fab-transition",[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.showButton,expression:"showButton"}],staticClass:"fixed-action-btn",style:{bottom:t.$vuetify.breakpoint.smOnly?"64px":""},attrs:{color:"secondary",fab:"",fixed:"",bottom:"",right:""},on:{click:t.goTop}},[n("v-icon",[t._v("keyboard_arrow_up")])],1)],1)],1)},Lo=[],Vo=n("9d93"),Eo={name:"gotop-button",directives:Vo["default"],data:function(){return{height:0,offsetTop:0}},methods:{recordHeight:function(){this.height=window.innerHeight},recordScroll:function(){this.offsetTop=window.pageYOffset||document.documentElement.scrollTop},goTop:function(){this.$vuetify.goTo(0)}},mounted:function(){this.recordHeight(),this.recordScroll()},computed:{showButton:function(){return this.offsetTop>=this.height}}},$o=Eo,Ao=n("269a"),Io=n.n(Ao),Uo=n("dc22"),Ro=n("f977"),Fo=Object(I["a"])($o,jo,Lo,!1,null,"0451dc4d",null),No=Fo.exports;R()(Fo,{VBtn:dt["a"],VFabTransition:M["c"],VIcon:Jt["a"],VLayout:Ht["a"]}),Io()(Fo,{Resize:Uo["a"],Scroll:Ro["b"]});n("15f5");var Mo=n("85fe");a["default"].prototype.config=Z,a["default"].use(So.a,{color:Z.theme.secondary,failedColor:Z.theme.error,thickness:"4px"}),a["default"].directive("observe-visibility",Mo["a"]),a["default"].component("toast",wo),a["default"].component("nav-bar",Oe),a["default"].component("blog-footer",To),a["default"].component("go-top-btn",No),a["default"].directive("focus",{update:function(t,e){var n=e.value;n&&t.focus()}}),a["default"].config.productionTip=!1;var Bo=e["default"]=new a["default"]({router:so,store:mo,vuetify:lo,render:function(t){return t(q)}}).$mount("#black-shout")}});
//# sourceMappingURL=app.a5b464d1.js.map