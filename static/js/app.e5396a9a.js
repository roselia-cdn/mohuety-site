(function(t){function e(e){for(var n,i,s=e[0],c=e[1],l=e[2],d=0,h=[];d<s.length;d++)i=s[d],o[i]&&h.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,s=1;s<a.length;s++){var c=a[s];0!==o[c]&&(n=!1)}n&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},o={app:0},r=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},"034f":function(t,e,a){"use strict";var n=a("1356"),o=a.n(n);o.a},"0813":function(t,e,a){"use strict";var n=a("2dfb"),o=a.n(n);o.a},1:function(t,e){},1356:function(t,e,a){},2751:function(t,e,a){"use strict";var n=a("d3b1"),o=a.n(n);o.a},"2dfb":function(t,e,a){},6428:function(t,e,a){},"66fe":function(t,e,a){},7878:function(t,e,a){},"86f9":function(t,e,a){"use strict";var n=a("7878"),o=a.n(n);o.a},"8cd6":function(t,e,a){"use strict";var n=a("efa2"),o=a.n(n);o.a},"8d3a":function(t,e,a){"use strict";var n=a("6428"),o=a.n(n);o.a},9009:function(t,e,a){},c293:function(t,e,a){"use strict";var n=a("d8c9"),o=a.n(n);o.a},cd49:function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var n=a("2b0e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.$route.meta.title,expression:"$route.meta.title"}]}),a("theme-listener",{model:{value:t.preferedLight,callback:function(e){t.preferedLight=e},expression:"preferedLight"}}),a("v-app",{attrs:{dark:t.isNight}},[a("v-content",[a("v-slide-x-transition",{attrs:{"hide-on-leave":""}},[a("router-view",{attrs:{currentColorScheme:!t.isNight,userData:t.userData},on:{forceSwitchToLight:t.switchToLight,forceSwitchToDark:t.switchToDark}})],1)],1)],1),a("vue-progress-bar"),a("go-top-btn")],1)},r=[],i=n["default"].extend({mounted:function(){this.checkScheme()},methods:{setState:function(t){this.$emit("change",t)},checkScheme:function(){var t=this,e=matchMedia("(prefers-color-scheme: dark)"),a=matchMedia("(prefers-color-scheme: light)");e.matches||a.matches?(this.setState(a.matches),e.addListener(function(e){return t.setState(!e.matches)}),a.addListener(function(e){return t.setState(e.matches)})):this.setState(void 0)}},model:{prop:"scheme",event:"change"},props:{scheme:Boolean},render:function(t){return t()}}),s=(a("28a5"),a("f559"),a("e814")),c=a.n(s),l=(a("4917"),a("7618")),u=a("5176"),d=a.n(u),h=a("75fc"),m=a("bd86"),f=a("cebc"),v=a("768b"),p=a("2d1f"),g=a.n(p),b=(a("a481"),function(t){return t.replace(/([A-Z])/g,"_$1").toLowerCase()}),y=function(t){return t.replace(/_([a-zA-Z])/g,function(t,e){return e.toUpperCase()})},w=function(t){return function(e){return g()(e).map(function(e){var a=Object(v["a"])(e,2),n=a[0],o=a[1];return t(n,o)})}},k=function(t){return t.reduce(function(t,e){return Object(f["a"])({},t,Object(m["a"])({},e[0],e[1]))},{})};function _(t){return function(e){return d.a.apply(Object,[{}].concat(Object(h["a"])(g()(e).map(function(e){var a=Object(v["a"])(e,2),n=a[0],o=a[1];return Object(m["a"])({},n,t(o))}))))}}var x=function t(e){return function(a){return a instanceof Array?a.map(t(e)):a&&"object"===Object(l["a"])(a)?k(w(function(a,n){return[e(a),t(e)(n)]})(a)):a}},D=x(y),C=x(b),T=function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];return function(t){return e.reduce(function(t,e){return"undefined"===typeof t?void 0:t[e]},t)}},S=function(t,e){return t===e||!(!t||!e)&&t.toLowerCase()===e.toLowerCase()},P=function(t,e,a){return(299*t+587*e+114*a)/1e3},L=function(t){return t.match(/\d+/g).map(function(t){return c()(t,10)})},O=function(t){if(t){var e,a=t.toLowerCase();if(a.startsWith("rgb")){var n=L(a);e=P(n[0],n[1],n[2])}else{var o=a.substring(1);if(3===o.length&&(o=o.split("").map(function(t){return t+t}).join("")),6!==o.length)return;var r=o.replace(/(..)(?=.)/g,"$1-").split("-").map(function(t){return c()(t,16)});e=P(r[0],r[1],r[2])}return e>=128}};function V(t,e,a,n){var o=O(t);return"undefined"===typeof o?n:o?e:a}var $=a("f499"),E=a.n($),j=(a("ac6a"),a("d225")),A=a("b0b4"),F=function(){function t(e){var a=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:localStorage;Object(j["a"])(this,t),this.changeListeners=[],this.key=e,this.storage=n,this.addStorageEventListener(function(){return a.onStorageChanged()})}return Object(A["a"])(t,[{key:"onStorageChanged",value:function(){var t=this.payload;this.changeListeners.forEach(function(e){return e(t)})}},{key:"addChangeListener",value:function(t){var e=this;return this.changeListeners.push(t),function(){e.changeListeners=e.changeListeners.filter(function(e){return e!==t})}}},{key:"getItem",value:function(t){var e=this.payload;return e&&e[t]}},{key:"getPayload",value:function(){return this.payload}},{key:"setPayload",value:function(t){this.payload=t}},{key:"updatePayload",value:function(t){this.setPayload(Object(f["a"])({},t,this.payload))}},{key:"clear",value:function(){this.storage.removeItem(this.key),this.onStorageChanged()}},{key:"addStorageEventListener",value:function(t){var e=this;addEventListener("storage",function(a){a.key===e.key&&t(e.payload)})}},{key:"isEmpty",value:function(){return!this.payload}},{key:"payload",get:function(){return JSON.parse(this.storage.getItem(this.key)||"null")},set:function(t){this.storage.setItem(this.key,E()(t)),this.onStorageChanged()}}]),t}(),U=new F("loginData"),I={name:"App",components:{"theme-listener":i},mounted:function(){this.$Progress.finish(),this.$watch("$vuetify.theme",function(t){document.body.style.setProperty("--theme-color",t.primary),document.body.style.setProperty("--theme-secondary-color",t.secondary),document.body.style.setProperty("--themed-text-color",V(t.primary,"#000000","#ffffff","#ffffff"))},{immediate:!0,deep:!0})},created:function(){var t=this;U.addChangeListener(function(e){t.userData=e})},methods:{switchToLight:function(t){this.forceLight=!!t},switchToDark:function(t){this.forceDark=!!t}},data:function(){return{forceLight:!1,forceDark:!1,forceTitle:"",preferedLight:void 0,userData:U.getPayload()}},computed:{isNight:function(){var t=(new Date).getHours(),e=t>6&&t<18;return this.forceDark||!(this.forceLight||e)}},watch:{preferedLight:function(t){if("undefined"!==typeof t){var e=!t;this.forceLight=!e,this.forceDark=e}else this.forceLight=this.forceDark=!1}}},R=I,N=(a("034f"),a("2877")),M=a("6544"),B=a.n(M),q=a("7496"),J=a("549c"),W=a("0789"),H=Object(N["a"])(R,o,r,!1,null,null,null),Y=H.exports;B()(H,{VApp:q["a"],VContent:J["a"],VSlideXTransition:W["e"]});var z=a("8c4f"),G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":"","text-xs-center":"","fill-height":""}},[a("v-responsive",[a("v-layout",{attrs:{row:"",wrap:"","justify-center":"","align-center":""}},[a("v-flex",{attrs:{xs12:""}},[a("h3",{staticClass:"display-3"},[t._v("Welcome to "),a("strong",{staticClass:"primary--text"},[t._v(t._s(t.title))])]),a("span",{staticClass:"subheading"},[t._v(t._s(t.motto))]),a("v-divider",{staticClass:"my-3"}),t.loading?a("div",[a("div",{staticClass:"title mb-3"},[t._v("Please standby...")]),a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):t.isFirstRun?a("div",[a("div",{staticClass:"title mb-3"},[t._v("Add first user to continue.")]),a("v-btn",{staticClass:"mx-0",attrs:{color:"primary",large:"",to:{name:"userManagement",params:{firstRun:!0}}}},[t._v("\n            Add user\n          ")])],1):a("div",[a("div",{staticClass:"title mb-3"},[t._v("Great! You are now prepared to "),a("strong",{staticClass:"primary--text"},[t._v(t._s(t.title))])]),a("v-btn",{staticClass:"mx-0",attrs:{color:"secondary",large:"",to:{name:"index"}}},[t._v("\n            Go to "+t._s(t.title)+"\n          ")])],1)],1)],1)],1)],1)},K=[],X="Somainer's Blog",Z="Do what you want to do, be who you want to be.",Q="https://roselia.moe/blog/api",tt="/blog",et={primary:"#0288d1",secondary:"#6292E9",accent:"#E08696",error:"#FB5458",warning:"#FE9952",info:"#95CAEE",success:"#61BF99"},at={title:X,motto:Z,apiBase:Q,theme:et,enableRoseliaScript:!0,urlPrefix:tt,images:{indexBannerImage:tt+"/static/img/bg_n3.jpg",postBannerImage:tt+"/static/img/nest.png",lazyloadImage:tt+"/static/img/observe.jpg",timelineBannerImage:tt+"/static/img/bg_n0.png"}},nt=(a("6b54"),a("795b")),ot=a.n(nt),rt=(a("386d"),a("bc3a")),it=a.n(rt),st=it.a.create();st.interceptors.request.use(function(t){return kr.$Progress.start(),t}),st.interceptors.response.use(function(t){return 200===t.status?kr.$Progress.finish():kr.$Progress.fail(),t},function(t){return kr.$Progress.fail(),ot.a.reject(t)});var ct=st,lt=a("2ef0"),ut=a.n(lt),dt={};dt.apiBase=at.apiBase,dt.getArguments=function(){return this.$route.query},dt.setRedirect=function(t){window.sessionStorage.setItem("redirectURL",E()(t||dt.getAbsPath()))},dt.getRedirect=function(){return JSON.parse(window.sessionStorage.getItem("redirectURL"))},dt.cleanRedirect=function(){window.sessionStorage.removeItem("redirectURL")},dt.getAbsPath=function(){return window.location.pathname+window.location.search+window.location.hash},dt.redirectTo=function(t){Mo.push(t||"./")},dt.getLoginData=function(){return U.getPayload()},dt.setLoginData=function(t){U.setPayload(t)},dt.updateLoginData=function(t){return dt.setLoginData(t(dt.getLoginData()))},dt.removeLoginData=function(){return U.clear()},dt.saveSUToken=function(t){window.sessionStorage.setItem("suToken",t)},dt.getSUToken=function(){return window.sessionStorage.getItem("suToken")},dt.removeSUToken=function(){window.sessionStorage.removeItem("suToken")},dt.getPosts=function(t){return this.fetchJSON(this.apiFor("posts")).then(t)},dt.refreshToken=function(t){if(!t){var e=dt.getLoginData();t=e&&e.rftoken}return t?dt.fetchJSON(dt.apiFor("login","token","refresh"),"POST",{token:t},!1,!1).then(function(t){if(t.success){var e=dt.getLoginData();return e&&(e.token=t.token)&&dt.setLoginData(e),e}return dt.removeLoginData(),ot.a.reject(t.msg)}):ot.a.reject("No token")},dt.formatDate=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var a=new Date(t);return e?a.toLocaleString():a.toLocaleDateString()}catch(n){return}},dt.getPostsData=function(){return JSON.parse(window.localStorage.postData||"null")},dt.deleteDraft=function(){return window.localStorage.removeItem("postDraft")},dt.setPosts=function(t){window.localStorage.postData=E()(t)},dt.apiFor=function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];return"".concat(dt.apiBase,"/").concat(e.join("/"))},dt.encodeArgs=function(t){return ut.a.map(t,function(t,e){return"".concat(e,"=").concat(t)}).join("&")},dt.processPosts=function(t){var e=window.localStorage.postData;return e?t(JSON.parse(e)):dt.getPosts(t),!1},dt.ajaxPromised=function(t){return ct(t).then(function(t){return t.data})},dt.fetchJSON=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=this.getLoginData(),i=r?r.token:"";e=e.toUpperCase(),o&&(a["__timestamp"]=(new Date).getTime());var s=n?d()({},a,{token:i}):a;return"GET"===e&&(s={params:s}),ct[e.toLowerCase()](t,s).then(function(t){return t.data}).catch(function(t){return ot.a.reject(t)})},dt.fetchJSONWithSuccess=function(){return this.fetchJSON.apply(this,arguments).then(function(t){return t.success?t.result||t.data||t:ot.a.reject(t.msg)})},dt.getTokenExpiryTime=function(t){try{var e=t.split(".")[0],a=JSON.parse(window.atob(e)),n=a.exp;return new Date(1e3*n)}catch(o){return console.error(o),new Date}},dt.isTokenExpired=function(t){return dt.getTokenExpiryTime(t||this.getLoginData().token)<new Date},dt.showToast=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.toast.show=!1,this.toast.text=t.toString(),this.toast.color=e,this.toast.show=!0},dt.getToastOption=function(){return{show:!1,text:"",color:""}},dt.addEventListener=function(t,e){return addEventListener(t,e),function(){removeEventListener(t,e)}},dt.addStorageListener=function(t){return dt.addEventListener("storage",t)};var ht=dt,mt={name:"HelloWorld",data:function(){return{title:at.title,motto:at.motto,loading:!0,isFirstRun:!1}},methods:{getFirstRunData:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("firstrun")).then(function(e){t.isFirstRun=!0,ht.setLoginData(Object(f["a"])({nickname:"Minato Yukina"},e,{su_token:void 0})),ht.saveSUToken(e.su_token)}).finally(function(e){t.loading=!1})}},mounted:function(){this.getFirstRunData()}},ft=mt,vt=a("8336"),pt=a("a523"),gt=a("ce7e6"),bt=a("0e8f"),yt=a("a722"),wt=a("490a"),kt=a("6b53"),_t=Object(N["a"])(ft,G,K,!1,null,"4d05a275",null),xt=_t.exports;B()(_t,{VBtn:vt["a"],VContainer:pt["a"],VDivider:gt["a"],VFlex:bt["a"],VLayout:yt["a"],VProgressCircular:wt["a"],VResponsive:kt["a"]});var Dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar",{attrs:{userData:t.userData,route:this.$route.fullPath}}),a("v-parallax",{attrs:{dark:"",src:t.meta.images.indexBannerImage}},[a("v-layout",{attrs:{"align-center":"",column:"","justify-center":""}},[a("h1",{staticClass:"display-2 font-weight-thin mb-3"},[t._v(t._s(t.realTitle||t.meta.title))]),a("h4",{staticClass:"subheading"},[t._v(t._s(t.realSubtitle||t.meta.motto))])])],1),a("v-layout",[a("v-container",{attrs:{fluid:"","grid-list-lg":""}},[a("v-layout",{attrs:{row:"",wrap:""}},t._l(t.posts,function(e){return a("v-flex",{key:e.id,attrs:{xs12:"",sm8:"","offset-sm2":""}},[a("v-card",{class:{"round-corner-card":t.$vuetify.breakpoint.smAndUp},attrs:{hover:"",to:t.getRoute(e)}},[e.img?a("v-img",{attrs:{src:e.img,"lazy-src":t.meta.images.lazyloadBannerImage,ripple:"true"}},[a("v-container",{attrs:{"fill-height":"",fluid:""}},[a("v-layout",{attrs:{"align-end":"","fill-height":""}},[a("v-flex",{attrs:{xs12:"","align-end":"",flexbox:""}},[t._l(e.tags,function(e){return a("router-link",{key:e,attrs:{to:{name:"index",params:{tag:e},query:{tag:e}}}},[a("v-chip",[t._v(t._s(e))])],1)}),e.secret?a("v-chip",{attrs:{color:"success","text-color":"white"}},[a("v-avatar",[a("v-icon",[t._v("lock")]),t._v(t._s(e.secret)+"\n                      ")],1),t._v("\n                      Secret\n                    ")],1):t._e(),e.hidden?a("v-chip",{attrs:{color:"grey","text-color":"white"}},[a("v-avatar",[a("v-icon",[t._v("visibility_off")])],1),t._v("\n                      Hidden\n                    ")],1):t._e()],2)],1)],1)],1):t._e(),a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("div",{staticClass:"headline"},[t._v(t._s(e.title))]),a("span",{staticClass:"grey--text"},[t._v(t._s(e.subtitle))])]),a("v-spacer"),a("span",{staticClass:"right"},[t._v(t._s(t.formatDate(e.created)||e.date))])],1),e.img?t._e():a("v-flex",{attrs:{xs12:"","align-end":"",flexbox:""}},[t._l(e.tags,function(e){return a("router-link",{key:e,attrs:{to:{name:"index",params:{tag:e},query:{tag:e}}}},[a("v-chip",[t._v(t._s(e))])],1)}),e.secret?a("v-chip",{attrs:{color:"success","text-color":"white"}},[a("v-avatar",[a("v-icon",[t._v("lock")]),t._v(t._s(e.secret)+"\n                ")],1),t._v("\n                Secret\n              ")],1):t._e(),e.hidden?a("v-chip",{attrs:{color:"grey","text-color":"white"}},[a("v-avatar",[a("v-icon",[t._v("visibility_off")])],1),t._v("\n                Hidden\n              ")],1):t._e()],2),a("v-card-title",[a("span",{staticClass:"grey--text"},[t._v(t._s(e.author.nickname))])]),t.userData&&t.userData.role&&t.userData.role>=e.author.role?a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{small:"",fab:"",color:"error",to:{name:"edit",query:{post:e.id},params:{deletePost:!0,title:e.title}}}},[a("v-icon",[t._v("delete")])],1),a("v-btn",{attrs:{small:"",fab:"",color:"primary",to:{name:"edit",query:{post:e.id}}}},[a("v-icon",[t._v("mode_edit")])],1)],1):t._e()],1)],1)}),1)],1)],1),a("v-container",[a("div",{staticClass:"text-xs-center"},[a("v-pagination",{attrs:{length:t.pages,circle:""},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)]),a("toast",t._b({on:{showChange:t.changeToast}},"toast",t.toast,!1)),a("blog-footer"),a("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.windowTitle,expression:"windowTitle"}]})],1)},Ct=[],Tt={name:"blog-index",data:function(){return{currentPage:1,prevPage:0,nextPage:0,pages:0,toast:ht.getToastOption(),posts:[],meta:at,realTitle:"",realSubtitle:"",windowTitle:""}},props:{userData:Object},methods:{makeDirect:function(t){ht.setRedirect(ht.getAbsPath()),this.$router.push(t)},getTag:function(){return this.getArguments().tag||null},getArguments:function(){return this.$route.query},getPageOffset:function(t){var e=c()(this.getArguments().page)||1,a=e+t;return a>0&&a<=this.pages?a:-1},formatDate:function(t){return ht.formatDate(t)},shiftPage:function(t){var e=this.getPageOffset(t);-1!==e&&(this.$vuetify.goTo(0),this.$router.push({name:"index",params:{page:e}}))},showToast:function(t,e){return ht.showToast.call(this,t,e)},changeToast:function(t){this.toast.show=t},getPostsOnContext:function(t){return t=t||this.getArguments(),this.getPosts(t.page,!1,t.tag)},getPosts:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;t=t||1;var o={page:t,limit:6};n?(this.windowTitle="".concat(this.meta.title," - Tag: ").concat(n),this.realTitle=n,this.realSubtitle="Posts for tag: ".concat(n),o.tag=n):(this.realTitle="",this.realSubtitle="",this.windowTitle="".concat(this.meta.title," - #").concat(t)),ht.fetchJSON(ht.apiFor("posts"),"GET",o).then(function(n){n.valid||!e.userData||a||ht.refreshToken().then(function(a){e.userData=a,e.getPosts(t,!0)}).catch(function(t){e.showToast(t,"warning"),e.userData=null,ht.removeLoginData()}),n.total||ht.fetchJSONWithSuccess(ht.apiFor("firstrun")).then(function(t){e.$router.push({name:"helloWorld"})}),e.posts=n.data.map(function(t){return t.deleted=!1,t}),e.pages=c()(n.pages),e.currentPage=c()(t),e.nextPage=e.getPageOffset(1),e.prevPage=e.getPageOffset(-1),e.$emit("roselia-load")}).catch(function(t){console.log(t)})},getRoute:function(t){return t=D(t),t.displayId?{name:"postWithEternalLink",params:{postLink:t.displayId}}:{name:"post",query:{p:t.id}}}},mounted:function(){this.getPostsOnContext()},computed:{},watch:{userData:function(){this.pages&&this.getPosts()},currentPage:function(t){this.$router.push(Object(f["a"])({},this.$route,{query:Object(f["a"])({},this.$route.query,{page:1===t?void 0:t})}))}},beforeRouteUpdate:function(t,e,a){this.$vuetify.goTo(0);var n=t.query;this.getPostsOnContext(n),a()}},St=Tt,Pt=(a("2751"),a("8212")),Lt=a("b0af"),Ot=a("99d9"),Vt=a("12b2"),$t=a("cc20"),Et=a("132d"),jt=a("adda"),At=a("891e"),Ft=a("8b9c"),Ut=a("9910"),It=Object(N["a"])(St,Dt,Ct,!1,null,"dff7d676",null),Rt=It.exports;B()(It,{VAvatar:Pt["a"],VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardTitle:Vt["a"],VChip:$t["a"],VContainer:pt["a"],VFlex:bt["a"],VIcon:Et["a"],VImg:jt["a"],VLayout:yt["a"],VPagination:At["a"],VParallax:Ft["a"],VSpacer:Ut["a"]});var Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",{attrs:{dark:"",color:"primary"}},[this.$route.query.ported?a("v-btn",{attrs:{flat:"",fab:"",onclick:"window.self.close()"}},[a("v-icon",[t._v("close")])],1):a("v-btn",{attrs:{flat:"",fab:"",to:"/"}},[a("v-icon",[t._v("arrow_back")])],1),a("v-toolbar-title",[t._v(t._s(t.title))]),a("v-spacer")],1),a("v-card-text",[a("v-alert",{attrs:{type:t.toast.color,transition:"scale-transition",dismissible:""},model:{value:t.toast.show,callback:function(e){t.$set(t.toast,"show",e)},expression:"toast.show"}},[t._v("\n            "+t._s(t.toast.text)+"\n          ")]),a("h2",{staticClass:"flex text--secondary"},[t._v(t._s(t.message))]),a("v-window",{attrs:{value:t.currentLayer,touchless:""}},[a("v-window-item",{attrs:{value:2}},[t.loading&&!t.loginCode?a("div",[a("h3",{staticClass:"display-1"},[t._v("Please standby...")]),a("v-progress-linear",{attrs:{indeterminate:"",color:"accent"}})],1):t._e()]),a("v-window-item",{attrs:{value:0}},[t.loading||t.loginCode?t._e():a("v-form",{model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{"prepend-icon":"person",name:"username",label:"Username",type:"text",autofocus:"",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.focusPassword(e)}},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),a("v-text-field",{ref:"passWord",attrs:{id:"password","prepend-icon":"lock",name:"password",label:"Password",type:"password",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),a("v-window-item",{attrs:{value:1}},[t.loginCode?a("v-container",[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[t.scannedUsername?a("div",[a("h6",{staticClass:"display-1"},[t._v("Welcome, please confirm:")]),a("h1",{staticClass:"info--text display-3"},[t._v(t._s(t.scannedUsername))])]):a("div",[a("h6",{staticClass:"display-1"},[t._v("Your login code:")]),a("h1",{staticClass:"primary--text display-3"},[t._v(t._s(t.loginCode))])])])],1):t._e()],1),a("v-window-item",{attrs:{value:3}},[a("v-container",[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("div",[a("h6",[t._v("One more step")]),a("v-text-field",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.authLoginCode,callback:function(e){t.authLoginCode=e},expression:"authLoginCode"}}),a("v-btn",{attrs:{color:"primary",small:"",round:""},nativeOn:{click:function(e){t.forceStep=null}}},[t._v("Give Up")])],1)])],1)],1)],1),!t.loading&&t.hasOauthAdapter?a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("h4",[t._v("Login using")]),a("div",[a("div",{staticClass:"text-xs-center"},t._l(t.oauthLogin.adapters,function(e){return a("v-btn",{key:e,attrs:{round:"",color:"accent",dark:"",loading:t.oauthLogin.loading},on:{click:function(a){return t.redirectOauthLogin(e)}}},[t.$vuetify.icons.brand[e]?a("v-icon",[t._v(t._s(t.$vuetify.icons.brand[e]))]):a("span",[t._v(t._s(e))])],1)}),1)])]):t._e()],1),a("v-card-actions",[t.oauthLogin.loading?t._e():a("div",[t.loginCode?a("v-btn",{attrs:{color:"info"},on:{click:t.codeLoginCleanUp}},[t._v("With username")]):a("v-btn",{attrs:{color:"secondary"},on:{click:t.codeLogin}},[t._v("With access code")])],1),a("v-spacer"),a("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1),a("toast",t._b({directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],on:{showChange:t.changeToast}},"toast",t.toast,!1))],1)},Mt=[],Bt=a("a8db"),qt={data:function(){return{loading:!1,title:at.title,toast:{show:!1,text:"",color:""},username:"",password:"",rules:[function(t){return!!t||"Required"},function(t){return t&&t.length>4&&t.length<20||"Length is not valid"}],valid:!1,loginCode:"",scannedUsername:"",focusAt:!1,oauthLogin:{loading:!1,adapters:[]},authLoginCode:"",forceStep:0,redirectLock:!1}},props:{userData:Object},methods:{login:function(){var t=this;this.valid&&(this.$emit("beforeLogin"),this.loading=!0,ht.fetchJSON(ht.apiFor("login"),"POST",{username:this.username,password:this.password,code:this.authLoginCode},!1).then(function(e){if(!e.success)return e.totp&&(t.forceStep=3,!t.authLoginCode)?ot.a.reject({msg:"Please enter two step authentication code",color:"info"}):ot.a.reject(e.msg);t.setLoginData({username:t.username,token:e.token,role:e.role,rftoken:e.rftoken}).then(function(){return t.redirectBack()})}).catch(function(e){e.color?t.showToast(e.msg,e.color):t.showToast(e,"error"),t.loading=!1}))},redirectBack:function(){this.redirectLock||(this.$router.push(this.redirection),this.redirectLock=!0)},showToast:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.toast.show=!1,this.toast.text=t.toString(),this.toast.color=e,this.toast.show=!0},changeToast:function(t){this.toast.show=t},cleanUp:function(){ht.cleanRedirect(),window.sessionStorage.removeItem("message")},setLoginData:function(t){var e=t.username,a=Object(Bt["a"])(t,["username"]);return ht.fetchJSONWithSuccess(ht.apiFor("user","user-meta"),"GET",{username:e}).then(function(t){var e=t.username,n=t.nickname;ht.setLoginData(Object(f["a"])({username:e,nickname:n},a))}).catch(function(t){ht.setLoginData(Object(f["a"])({username:e,nickname:e},a))})},tokenLogin:function(t){var e=this;return this.loading=!0,ht.fetchJSON(ht.apiFor("login","token"),"POST",{token:t},!1).then(function(a){if(!a.success)return ot.a.reject(a.msg);e.setLoginData({username:a.payload.username,token:t,role:a.payload.role}).then(function(){return e.redirectBack()})}).catch(function(t){return e.loading=!1,e.showToast(t,"error"),ot.a.reject(t)}).finally(this.cleanUp)},getLoginCode:function(){return ht.fetchJSON(ht.apiFor("login","code","gen")).then(function(t){return t.code})},codeLoginTriggers:function(){var t=this;this.codeChecker=setInterval(function(){t.loginCode&&ht.fetchJSON(ht.apiFor("login","code",t.loginCode),"POST",{},!1).then(function(e){if(e.success){var a=e.data;a.username&&(t.scannedUsername=a.username),a.token&&t.setLoginData({username:a.username,role:a.role,token:a.token}).then(function(){return t.redirectBack()})}}).catch(function(e){t.showToast("Unstable network may affect remote login.","warning")})},3e3),this.codeLoginCleaner=setTimeout(function(){return t.codeLoginCleanUp()},6e4)},codeLogin:function(){var t=this;this.loading=!0,this.loginCode="Loading...",this.getLoginCode().then(function(e){t.loginCode=(Array(6).join("0")+e).slice(-6)}).then(function(e){t.codeLoginTriggers()}).catch(function(e){t.showToast(e,"error"),t.codeLoginCleanUp()})},codeLoginCleanUp:function(){this.codeChecker&&clearInterval(this.codeChecker),this.codeLoginCleaner&&clearTimeout(this.codeLoginCleaner),this.loading=!1,this.loginCode="",this.scannedUsername=""},focusPassword:function(){var t=this;this.rules.map(function(e){return e(t.username)}).every(function(t){return!0===t})&&this.$refs.passWord.focus()},getAdapters:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("login","oauth","adapters")).then(function(e){t.oauthLogin.adapters=e}).catch(function(e){t.showToast(e,"error")})},redirectOauthLogin:function(t){var e=this;this.oauthLogin.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("login","oauth",t,"url"),"GET",{base:window.location.href.split("?")[0],redirect:this.redirection}).then(function(t){e.loading=!0,window.location.href=t}).catch(function(t){e.oauthLogin.loading=!1,e.showToast(t,"error")})}},computed:{redirection:function(){return this.$route.params.redirect||this.$route.query.redirect||ht.getRedirect()||"/"},message:function(){return window.sessionStorage.getItem("message")||this.$route.params.message||"Login"},hasOauthAdapter:function(){return this.oauthLogin.adapters.length>0},currentLayer:function(){var t=!!this.loading<<1|!!this.loginCode;return this.forceStep||1&t||2&t}},mounted:function(){var t=this;if(this.userData&&(this.$route.params.logout?(ht.removeLoginData(),this.showToast("Logged out!")):this.redirectBack()),this.$route.query.alertText){var e=this.$route.query,a=e.alertText,n=e.alertColor;this.$router.replace(Object(f["a"])({},this.$route,{params:Object(f["a"])({},this.$route.params,{alert:{text:a,color:n}}),query:Object(f["a"])({},this.$route.query,{alertColor:void 0,alertText:void 0})})),this.showToast(a,n)}if(this.$route.params.alert){var o=this.$route.params.alert,r=o.color,i=o.text;this.showToast(i,r)}var s=ht.getArguments.call(this).token;s&&this.tokenLogin(s).catch(function(e){t.getAdapters(),t.$router.replace(Object(f["a"])({},t.$route,{query:Object(f["a"])({},t.$route.query,{token:void 0})}))}),s||this.getAdapters()},watch:{userData:function(t){t&&this.redirectBack()}},destroyed:function(){this.oauthLogin.loading||this.cleanUp(),this.codeLoginCleanUp()}},Jt=qt,Wt=a("0798"),Ht=a("4bd4"),Yt=a("8e36"),zt=a("2677"),Gt=a("71d9"),Kt=a("2a7f"),Xt=a("f665"),Zt=a("1e6c"),Qt=Object(N["a"])(Jt,Nt,Mt,!1,null,null,null),te=Qt.exports;B()(Qt,{VAlert:Wt["a"],VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardText:Ot["b"],VContainer:pt["a"],VFlex:bt["a"],VForm:Ht["a"],VIcon:Et["a"],VLayout:yt["a"],VProgressLinear:Yt["a"],VSpacer:Ut["a"],VTextField:zt["a"],VToolbar:Gt["a"],VToolbarTitle:Kt["b"],VWindow:Xt["a"],VWindowItem:Zt["a"]});var ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"post"}},[a("nav-bar",{attrs:{userData:t.userData,route:t.$route.fullPath}}),a("v-parallax",{attrs:{id:"main-pic",dark:"",src:t.postData.img||t.config.images.postBannerImage}},[a("v-layout",{class:t.titleClass,attrs:{"align-center":"",column:"","justify-center":""}},[a("h1",{staticClass:"display-2 font-weight-thin mb-3",attrs:{id:"title"}},[t._v(t._s(t.postData.title))]),a("h4",{staticClass:"subheading",attrs:{id:"subtitle"}},[t._v(t._s(t.postData.subtitle))]),a("h4",{staticClass:"subheading",attrs:{id:"date"}},[t._v(t._s(t.formatDate(t.postData.created)||t.postData.date))]),a("h4",{staticClass:"subheading",attrs:{id:"author"}},[t._v(t._s(t.postData.author.nickname))])])],1),a("v-container",{attrs:{"grid-list-md":"",fluid:"","fill-height":""}},[a("v-layout",[a("v-flex",{attrs:{wrap:"",row:"",xs12:"",sm10:"","offset-sm2":""}},[a("v-layout",[t._l(t.postData.tags,function(e){return a("router-link",{key:e,attrs:{to:{name:"index",params:{tag:e},query:{tag:e}}}},[a("v-chip",[t._v(t._s(e))])],1)}),t.postData.secret?a("v-chip",{attrs:{color:"success","text-color":"white"}},[a("v-avatar",[a("v-icon",[t._v("lock")]),t._v(t._s(t.postData.secret)+"\n            ")],1),t._v("\n            Secret\n          ")],1):t._e(),-1===t.postData.id?a("v-chip",{attrs:{color:"warning","text-color":"white"}},[a("v-avatar",[a("v-icon",[t._v("error")])],1),t._v("\n            404\n          ")],1):t._e(),t.postData.hidden?a("v-chip",{attrs:{color:"grey","text-color":"white"}},[a("v-avatar",[a("v-icon",[t._v("visibility_off")])],1),t._v("\n            Hidden\n          ")],1):t._e()],2),a("v-flex",{attrs:{xs10:"",offset:"",xs2:""}},[t.cachedData?a("v-btn",{attrs:{color:"secondary",fab:"",small:""},on:{click:function(e){return t.$router.go(-1)}}},[a("v-icon",[t._v("arrow_back")])],1):t._e(),a("v-layout",[a("v-spacer"),"preview"!==t.postData.id&&-1!==t.postData.id&&t.isEditable?a("div",[a("v-btn",{attrs:{color:"error",fab:"",small:"",to:{name:"edit",params:{deletePost:!0,title:t.postData.title},query:{post:t.postData.id}}}},[a("v-icon",[t._v("delete")])],1),a("v-btn",{attrs:{color:"primary",fab:"",small:"",to:{name:"edit",query:{post:t.postData.id}}}},[a("v-icon",[t._v("mode_edit")])],1)],1):t._e(),t.isPostFound&&!t.isShared?a("v-btn",{attrs:{fab:"",small:"",color:"secondary"},on:{click:t.sharePost}},[a("v-icon",[t._v("share")])],1):t._e()],1)],1),a("v-layout",[a("v-flex",{class:{sm8:t.hasDigest,sm10:!t.hasDigest}},[a("div",{ref:"content",staticClass:"flow-text responsive-img",attrs:{id:"content"}},[t.rsRendered?a("div",{ref:"rhodonite"}):a("div",{domProps:{innerHTML:t._s(t.postData.content)}})]),t.postData.id<0?a("div",{staticClass:"flow-text"},[a("p",[t._v("Oops, we can not show you the post.")]),a("p",[a("strong",[t._v("This may because:")])]),a("ol",[a("li",[t._v("Your post ID is invalid.")]),a("li",[t._v("This post is secret"),t.userData?a("strong",[t._v(" and even beyond your permission level")]):t._e(),t._v(".")]),t.userData&&t.isTokenExpired?a("li",{staticClass:"warning--text"},[a("v-icon",{attrs:{color:"warning"}},[t._v("warning")]),t._v("Your session is expired.")],1):t._e(),a("li",[t._v("Your network condition is poor.")])]),a("p",[a("strong",[t._v("All you need to do is check your input, refresh your token or try to login again.")])])]):t._e()]),t.hasDigest?a("v-flex",{attrs:{sm2:""}},[a("blog-digest-nav",{attrs:{items:t.postDigest,offset:"500",threshold:"500"}})],1):t._e()],1),a("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.postData.title,expression:"postData.title"}]})],1)],1)],1),t.postData.author?a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"","justify-center":""}},[t.postData.author.avatar?a("div",[a("v-avatar",{staticClass:"elevation-7"},[a("v-img",{attrs:{src:t.postData.author.avatar,alt:t.postData.author.username}})],1)],1):t._e(),t.postData.author&&t.postData.author.username?a("div",[a("router-link",{attrs:{to:{name:"userTimeline",params:{username:t.postData.author.username}}}},[a("v-chip",[t._v("\n            @"+t._s(t.postData.author.username)+" ("+t._s(t.postData.author.nickname)+")\n          ")])],1)],1):t._e()])],1):t._e(),a("v-container",[a("div",{staticClass:"text-xs-center"},[a("h4",{staticClass:"subheading grey--text"},[t._v("Last edit at: "+t._s(t.formatDate(t.postData.lastEdit,!0)))])])]),a("v-container",[a("v-flex",{attrs:{row:"",xs12:"",sm10:"","offset-sm1":""}},[a("v-layout",[-1!==t.postData.next?a("v-btn",{attrs:{color:"primary",fab:"",small:"",to:{name:"post",query:{p:t.postData.next}}}},[a("v-icon",[t._v("chevron_left")])],1):t._e(),a("v-spacer"),-1!==t.postData.prev?a("v-btn",{attrs:{color:"primary",fab:"",small:"",to:{name:"post",query:{p:t.postData.prev}}}},[a("v-icon",[t._v("chevron_right")])],1):t._e()],1)],1),t.isPostFound?a("blog-comments",{attrs:{userData:t.userData,postData:t.postData,toast:t.showToast,renderer:t.renderer}}):t._e()],1),a("v-dialog",{attrs:{"hide-overlay":"",width:"300",lazy:!0,attach:t.preview.attach,origin:t.preview.origin},model:{value:t.preview.show,callback:function(e){t.$set(t.preview,"show",e)},expression:"preview.show"}},[a("v-card",{attrs:{color:t.preview.color,dark:""}},[t.preview.img?a("v-img",{attrs:{src:t.preview.img}}):t._e(),a("v-card-text",[t.preview.loading?t._e():a("div",[a("h1",{staticClass:"title"},[a("strong",[t._v(t._s(t.preview.title))])]),a("v-spacer"),a("h6",{staticClass:"subheading text-truncate"},[t._v(t._s(t.preview.subtitle))])],1),t.preview.loading?a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}}):t._e()],1)],1)],1),a("toast",t._b({on:{showChange:t.changeToast}},"toast",t.toast,!1)),a("blog-footer"),a("v-dialog",{attrs:{width:"500"},model:{value:t.share.open,callback:function(e){t.$set(t.share,"open",e)},expression:"share.open"}},[a("v-card",[a("v-card-title",{staticClass:"headline primary",attrs:{"primary-title":""}},[t._v("\n        Share "+t._s(t.postData.title)+"\n      ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"Address",outline:"",value:t.sharePath,readonly:""}}),a("a",{attrs:{href:t.sharePath}},[t._v("Shared_"+t._s(t.postData.title))]),t._v(" <- Right click and copy link.\n        "),a("p",[t._v("This post will be visible regardless of the user privileges.")])],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"accent",flat:""},on:{click:function(e){t.share.open=!1}}},[t._v("\n          Done\n        ")])],1)],1)],1)],1)},ae=[],ne=(a("3b2b"),a("774e")),oe=a.n(ne),re=(a("96cf"),a("3b8d")),ie=(a("c5f6"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"digestNav",staticClass:"hide-on-small-only pushpin",attrs:{id:"digest-nav"}},[a("ul",{staticClass:"section table-of-contents"},t._l(t.items,function(e){var n=e.hash,o=e.title;return a("li",{key:n},[a("a",{attrs:{href:"#"+n,to:{hash:n,query:t.$route.query}}},[t._v(t._s(o))])])}),0)])}),se=[],ce=a("4d5c"),le=a.n(ce),ue={name:"blog-digest-nav",data:function(){return{}},props:{items:Array},methods:{onCreate:function(){var t=this;this.$nextTick(function(e){return t.processDigest()})},processDigest:function(){var t=document.querySelectorAll(".scrollspy"),e=document.getElementById("content");this.instance=le.a.ScrollSpy.init(t),le.a.Pushpin.init(document.querySelectorAll(".pushpin"),{top:e.offsetTop,offset:150,bottom:e.offsetHeight+e.offsetTop-this.$refs.digestNav.offsetHeight})},getInstance:function(){return le.a.ScrollSpy.getInstance(this.targetElements())}},computed:{targetElements:function(){return this.items.map(function(t){return t.element})}},mounted:function(){this.onCreate()},destroyed:function(){this.getInstance().destroy()},watch:{items:function(){this.onCreate()}}},de=ue,he=(a("c389"),a("c293"),Object(N["a"])(de,ie,se,!1,null,"6e2088a0",null)),me=he.exports,fe=(a("7f7f"),a("0a0d")),ve=a.n(fe),pe=a("2d7d"),ge=a.n(pe),be=a("67bb"),ye=a.n(be),we=a("6609"),ke=a.n(we),_e=a("8feb"),xe=a.n(_e),De=a("1b81"),Ce=a.n(De),Te=(a("aef6"),function t(e,a){Object(j["a"])(this,t),this.template=e,this.returnValue=a}),Se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{width:"400"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v(t._s(t.title))]),a("v-card-text",[t._v("\n        "+t._s(t.message)+"\n      ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.commitReject}},[t._v("\n          Disagree\n        ")]),a("v-btn",{attrs:{color:"primary",flat:""},on:{click:t.commitConfirm}},[t._v("\n          Agree\n        ")])],1)],1)],1)],1)},Pe=[],Le=a("308d"),Oe=a("6bb5"),Ve=a("4e2b"),$e=a("9ab4"),Ee=a("60a3"),je=function(t){function e(){var t;return Object(j["a"])(this,e),t=Object(Le["a"])(this,Object(Oe["a"])(e).apply(this,arguments)),t.dialog=!0,t.isConfirmed=!1,t}return Object(Ve["a"])(e,t),Object(A["a"])(e,[{key:"onDialogChanged",value:function(t,e){e||(this.isConfirmed||this.onReject(),this.$destroy(),this.cleanUp&&this.cleanUp())}},{key:"commitConfirm",value:function(){this.isConfirmed=!0,this.onConfirm(),this.dialog=!1}},{key:"commitReject",value:function(){this.isConfirmed=!1,this.onReject(),this.dialog=!1}}]),e}(Ee["c"]);$e["a"]([Object(Ee["b"])(Function)],je.prototype,"onConfirm",void 0),$e["a"]([Object(Ee["b"])(Function)],je.prototype,"onReject",void 0),$e["a"]([Object(Ee["b"])(Function)],je.prototype,"cleanUp",void 0),$e["a"]([Object(Ee["b"])(String)],je.prototype,"title",void 0),$e["a"]([Object(Ee["b"])(String)],je.prototype,"message",void 0),$e["a"]([Object(Ee["d"])("dialog")],je.prototype,"onDialogChanged",null),je=$e["a"]([Ee["a"]],je);var Ae=je,Fe=Ae,Ue=a("169a"),Ie=Object(N["a"])(Fe,Se,Pe,!1,null,null,null),Re=Ie.exports;B()(Ie,{VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardText:Ot["b"],VCardTitle:Vt["a"],VDialog:Ue["a"],VLayout:yt["a"],VSpacer:Ut["a"]});var Ne=function(t,e){return new n["default"]({render:function(e){return e(Re,{props:t})}}).$mount(e)};function Me(t){if(!window.APlayer){var e=document.createElement("script"),a=document.createElement("link");a.rel="stylesheet",a.href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css",e.async=!0,e.onload=t||null,e.src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js",document.head.appendChild(a),document.body.appendChild(e)}}function Be(t){var e=document.createElement("div");return e.innerHTML=t.replace(/<em>(.*?)<\/em>/,function(t,e){return"*".concat(e,"*")}),e.innerText||e.textContent}function qe(t){return t instanceof Array?t.map(qe).join(""):(t instanceof Te&&(t=t.template),t instanceof HTMLElement?t.outerHTML:lt["isNumber"](t)||lt["isString"](t)?t:"")}function Je(t,e,a){return t.replace(new RegExp((e||["{{","}}"]).join("\\s*?(([\\s\\S]+?))\\s*?"),"gm"),a)}function We(t,e,a){var n=function(t){return"with(data) { with(functions) {return (".concat(t,");}}")},o=function(t){if(!at.enableRoseliaScript)return"<pre><code>".concat(t,"</code></pre>");try{var a,o=/([a-zA-Z_$]+[a-zA-Z_0-9]*){([\s\S]+)}/.exec(t),r=!1;if(o){var i=Object(v["a"])(o,3),s=(i[0],i[1]),c=i[2],l=e[s]||e.functions[s];lt["isFunction"](l)&&(a=l(Be(c)),r=!0)}return r||(t=Be(t),a=new Function("data",n(t))(e)),qe(a)}catch(u){return console.log("On rendering:",t),console.error(u),t}};return Je(t,a,function(t,e){var a=e.trim(),n=!a.endsWith(";"),r=n?a:a.substring(0,a.length-1),i=o(r);return n?i:""})}function He(t,e){var a=new Ce.a;if(e){var n=function(t){return new Proxy({},{get:function(){return null}})};e.forEach(function(e){return t[e]=n(e)})}var o={get:function(t,e){var n=xe()(t,e);return lt["isFunction"](n)?(a.has(n)||a.set(n,n.bind(t)),a.get(n)):n}};return new Proxy(t,o)}function Ye(t){return new Proxy(t,{has:function(t,e){return!0},get:function(t,e){if(e!==ke.a)return xe()(t,e)}})}var ze=ye()("yukina"),Ge=Object(f["a"])({},at.theme),Ke=function(){function t(e){Object(j["a"])(this,t),this.app=e,this.scriptEvaluator=new Xe(e),this.context=Ye(He(this.scriptEvaluator))}return Object(A["a"])(t,[{key:"render",value:function(e){this.scriptEvaluator.pendingFunctions=[];try{this.toInject=this.app;var a=We(e,this.context,t.roseliaScriptDelim);return a}catch(n){return console.error(n),e}}},{key:"cleanScript",value:function(e){return Je(e,t.roseliaScriptDelim,function(t){return""})}},{key:"renderAsync",value:function(){var t=Object(re["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new ot.a(function(t){return t(a.render(e))}).then(function(t){return t}));case 1:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderVue",value:function(t){var e=this,a=this.scriptEvaluator.randomID(),o=new n["default"]({template:'<div id="'.concat(a,'">')+this.render(t)+"</div>",data:this.scriptEvaluator.functions,delimiters:["v{{","}}"]});return this.toInject=o,Object.defineProperty(o,"autoInject",{value:function(){o.$mount(document.getElementById(a)),o.$nextTick(function(){return e.injectEvents()})}}),o}},{key:"renderVueAsync",value:function(){var t=Object(re["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new ot.a(function(t){return t(a.renderVue(e))}));case 1:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"injectEvents",value:function(){this.scriptEvaluator.injectEventsOn(this.toInject)}},{key:"pushContext",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"context";return this.scriptEvaluator.def(a,t),function(){e.scriptEvaluator.undef(a)}}},{key:"pushMethod",value:function(t,e){var a=this;return this.pushContext(function(){return t(a.context).apply(void 0,arguments)},e)}}]),t}();Ke.roseliaScriptDelim=["(?:Roselia|roselia|r|R){{","}}"];var Xe=function(){function t(e){var a=this;Object(j["a"])(this,t),this.Y=function(t){return function(t){return t(t)}(function(e){return t(function(t){return e(e)(t)})})},this.request={get:function(t,e){return a.askForAccess("fetch","This post would like to fetch data","It wants to access ".concat(t,".")).then(function(){return ct.get(t,{params:e}).then(function(t){return t.data})})}},this.app=e,this.customFunctions={app:null},this.functions=He(this.customFunctions),this.app.$on("postUnload",function(){a.customFunctions={app:null},a.functions=He(a.customFunctions),a.mounted=!1}),this.askAccess=new ge.a,this.pendingFunctions=[],this.mounted=!1}return Object(A["a"])(t,[{key:"then",value:function(t){this.mounted?this.app.$nextTick(t):this.pendingFunctions.push(t)}},{key:"injectEventsOn",value:function(t){this.pendingFunctions.forEach(function(){var e=Object(re["a"])(regeneratorRuntime.mark(function e(a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.$nextTick(a));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.pendingFunctions=[],this.mounted=!0}},{key:"music",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;Me(function(){return e.app.$emit("aPlayerLoaded")});var o,r=this.randomID();return this.then(function(){var i=function(){var e=document.getElementById(r);o=new window.APlayer({container:e,narrow:!1,autoplay:a,mutex:!0,theme:at.theme.accent,mode:"circulation",showlrc:1,preload:"metadata",audio:t}),o.on("loadstart",function(){oe()(e.getElementsByClassName("aplayer-title")).forEach(function(t){t&&(t.style.color=at.theme.secondary)}),n&&n(o)})};window.APlayer?e.then(i):e.app.$once("aPlayerLoaded",function(){e.then(i)}),e.app.$once("postUnload",function(){o.destroy()})}),new Te('<div id="'.concat(r,'"></div>'),o)}},{key:"heimu",value:function(t){var e=this.randomID();return new Te('<span class="heimu" id="'.concat(e,'">').concat(t,"</span>"),e)}},{key:"cite",value:function(t,e){return'<a href="post?p='.concat(e,'">').concat(t,"</a>")}},{key:"randomID",value:function(t){return Number(Math.random().toString().substring(3,t)+ve()()).toString(36)}},{key:"onceLoad",value:function(t){this.app.$once("postLoaded",t)}},{key:"onceUnload",value:function(t){this.app.$once("postUnload",t)}},{key:"extendAttributes",value:function(t,e){this.element(t).then(function(t){lt["merge"](t,e)})}},{key:"btn",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3?arguments[3]:void 0,o=this.randomID();return a instanceof Array&&(a=a.join(" ")),e&&this.then(function(){document.getElementById(o).addEventListener("click",e)}),n&&this.extendAttributes(o,n),new Te('<button id="'.concat(o,'" class="v-btn ').concat(a,'">').concat(t,"</button>"),o)}},{key:"toast",value:function(t,e){this.app.showToast(t,e||"info")}},{key:"formula",value:function(t){return"$ ".concat(t," $")}},{key:"formulation",value:function(t){return"$$ ".concat(t," $$")}},{key:"formulationEscape",value:function(){var t=this,e=[["$$","$$"],["$","$"],["\\(","\\)"]];e.map(function(t){return t.map(function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}).join("\\s*(.*?)\\s*")}).map(function(t){return new RegExp(t,"gms")}).forEach(function(e){t.app.postData.content=t.app.postData.content.replace(e,function(t,e){return Be(e)})})}},{key:"importJS",value:function(t,e){var a=document.createElement("script");a.onload=e,a.async=!0,a.src=t,document.body.appendChild(a)}},{key:"def",value:function(t,e){return e instanceof Te?(this.customFunctions[t]=e.returnValue,e.template):(this.customFunctions[t]=e,lt["isString"](e)||e instanceof HTMLElement?e:void 0)}},{key:"undef",value:function(t){this.customFunctions[t]=void 0}},{key:"audio",value:function(t){var e=this.randomID();return new Te("<audio id='".concat(e,"' src='").concat(t,"' hidden='true'/>"),e)}},{key:"getElement",value:function(t){if(t instanceof HTMLElement&&(t=t.id),t instanceof Te&&(t=lt["isString"](t.returnValue)?t.returnValue:t.template),lt["isString"](t)){var e=/id=['"]([a-zA-Z0-9-]+)['"]/.exec(t);e&&(t=e[1])}t instanceof HTMLElement&&(t=t.id);var a=t in this.functions?this.functions[t]:t;return document.getElementById(a instanceof Element?a.id:a)}},{key:"raw",value:function(t){return"<pre>Roselia{{".concat(t,"}}</pre>")}},{key:"previewColor",value:function(t){var e=this,a=this.app.preview.color;this.app.preview.color=t,this.onceUnload(function(){e.app.preview.color=a})}},{key:"element",value:function(t){var e=this;return new ot.a(function(a,n){e.then(function(){var o=e.getElement(t);o?a(o):n()})})}},{key:"createElement",value:function(t,e){var a=document.createElement(t);return a.id=this.randomID(),e&&this.extendAttributes(a,e),a}},{key:"setPreview",value:function(t,e){var a=this;this.element(t).then(function(t){t.addEventListener("mouseover",function(n){n.preventDefault(),a.app.preview.show=!0,a.app.preview.attach=t,a.app.preview.cacheData=null,a.app.preview.current=a.app.postData.id,["title","subtitle","img","color"].forEach(function(t){var n=e[t];lt["isNil"](n)||(a.app.preview[t]=n)})}),t.addEventListener("mouseout",function(t){t.preventDefault(),a.app.preview.show=!1}),lt["isNil"](e.goTo)||t.addEventListener("click",function(t){t.preventDefault();try{a.app.$vuetify.goTo(lt["isNumber"](e.goTo)?e.goTo:a.getElement(e.goTo),{offset:-200})}catch(n){lt["isString"](e.goTo)?location.href=e.goTo:a.app.$router.push(e.goTo),console.error(n)}})})}},{key:"previewed",value:function(t,e){return this.setPreview(t,e),t}},{key:"doTo",value:function(t,e){return this.element(t).then(e),t}},{key:"icon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e instanceof Array&&(e=e.join(" ")),t.startsWith("fa")){var a=t.split("-"),n=Object(v["a"])(a,2),o=n[0],r=n[1];return'<i aria-hidden="true" class="v-icon '.concat(o," fa-").concat(r," ").concat(e,'"></i>')}return'<i aria-hidden="true" class="v-icon material-icons '.concat(e,'">').concat(t,"</i>")}},{key:"askForAccess",value:function(t,e,a){var n=this;return new ot.a(function(o,r){if(n.onceUnload(function(){return n.askAccess.clear()}),n.askAccess.has(t))n.askAccess.get(t)?o():r();else{var i=n.createElement("div");document.getElementById("content").appendChild(i),Ne({onConfirm:function(){o(),n.askAccess.set(t,!0)},onReject:function(){r(),n.askAccess.set(t,!1)},cleanUp:function(){document.getElementById("content").removeChild(i)},title:e,message:a},i)}}).then(function(){n.toast("Operation ".concat(t," granted"),"success")}).catch(function(){return n.toast("Operation ".concat(t," rejected"),"error"),ot.a.reject(new Error("User rejected"))})}},{key:"askForToken",value:function(){return this.askForAccess("token","This post wish to access your personal info","This post needs to access your token to make requests.")}},{key:"roseliaApi",value:function(){for(var t=this,e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];return function(){var e=Object(re["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.askForToken();case 2:return e.abrupt("return",ht.fetchJSON(ht.apiFor.apply(ht,a),"GET",n));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},{key:"nil",value:function(){return null}},{key:"forceChangeTheme",value:function(t,e){e===ze&&d()(this.app.$vuetify.theme,t)}},{key:"currentTheme",value:function(){return Object(f["a"])({},this.app.$vuetify.theme)}},{key:"changeTheme",value:function(t){var e=this;this.askForAccess("theme","This post would like to change your theme","Changes will discard after refresh").then(function(){e.forceChangeTheme(t,ze),Ge=Object(f["a"])({},Ge,t)})}},{key:"changeThemeOnce",value:function(t){var e=this;d()(this.app.$vuetify.theme,t),this.onceUnload(function(){e.forceChangeTheme(Ge,ze)})}},{key:"resetTheme",value:function(){this.changeThemeOnce(at.theme)}},{key:"saveCurrentTheme",value:function(){var t=this,e=this.currentTheme();this.askForAccess("theme","This post would like to save your current theme.","Changes will discard after refresh").then(function(){Ge=Object(f["a"])({},Ge,e),t.onceUnload(function(){t.forceChangeTheme(e,ze)})})}},{key:"forceSwitchToColorMode",value:function(){var t=Object(re["a"])(regeneratorRuntime.mark(function t(e,a){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(a===ze){t.next=3;break}return t.next=3,this.askForAccess("colorMode","This post would like to change your color scheme.","Changes will discard after refresh,");case 3:this.app.$emit("forceSwitchToLight",!!e),this.app.$emit("forceSwitchToDark",!e);case 5:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"switchToColorMode",value:function(t){var e=this;this.forceSwitchToColorMode(t,ze),this.onceUnload(function(){return e.resetColorMode()})}},{key:"resetColorMode",value:function(){this.app.$emit("forceSwitchToLight",!1),this.app.$emit("forceSwitchToDark",!1)}}]),t}(),Ze={RoseliaRenderer:Ke,createRenderer:function(t){return new Ke(t)}},Qe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("lazy-component",{attrs:{text:"Load comment"}},[a("v-container",[a("v-flex",{attrs:{xs12:"",sm8:"","offset-sm2":""}},[a("v-badge",[t.commentCount?a("span",{attrs:{slot:"badge"},slot:"badge"},[t._v(t._s(t.commentCount))]):t._e(),a("v-icon",[t._v("\n          mode_comment\n        ")])],1),a("v-divider",{staticClass:"my-3"})],1),t.canAddComment?a("v-flex",{attrs:{xs12:"",sm8:"","offset-sm2":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[t.replyToComment?a("v-chip",{attrs:{close:"",color:"secondary",dark:""},model:{value:t.chip,callback:function(e){t.chip=e},expression:"chip"}},[t._v("\n          @"+t._s(t.atToNickname)+"\n        ")]):t._e(),a("v-spacer"),a("v-btn",{attrs:{color:"accent",icon:""},on:{click:t.switchPreviewMode}},[t.showPreview?a("v-icon",[t._v("mode_edit")]):a("v-icon",[t._v("visibility")])],1)],1),t.showPreview?a("div",[a("recursive-comment",{ref:"previewComment",attrs:{comments:[t.currentCommentObject],canAddComment:!1,canDeleteComment:function(){return!1},myUsername:t.userData&&t.userData.username}})],1):a("v-textarea",{ref:"commentText",attrs:{"auto-grow":"",outline:"",placeholder:t.commentPlaceholer,color:"primary",label:"Leave a comment"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[t.userData&&t.userData.nickname?a("span",[t._v(t._s(t.userData.nickname))]):a("v-text-field",{attrs:{small:"",label:"Nickname"},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}})],1),a("v-spacer"),a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{color:"primary",disabled:!this.isValid,loading:t.loading,round:""},on:{click:t.addComment}},[a("v-icon",[t._v("send")])],1)],1)],1)],1):t._e(),a("recursive-comment",{ref:"comments",attrs:{comments:t.recursiveCommentList,canAddComment:t.canAddComment,canDeleteComment:t.canDeleteComment,postAuthorUsername:t.postData.author&&t.postData.author.username,myUsername:t.userData&&t.userData.username},on:{"delete-comment":function(e){t.commentToDelete.id=e,t.commentToDelete.show=!0},"reply-comment":t.onReplyComment}}),a("v-layout",{attrs:{"align-center":"",column:"","justify-center":""}},[a("v-chip",{staticClass:"white--text ml-0 center-align",attrs:{color:"secondary",small:""},on:{click:function(e){return t.$vuetify.goTo(t.$refs.commentText)}}},[a("v-icon",[t._v("add_comment")])],1),t.currentPage<t.totalPages?a("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.loadNextPage,expression:"loadNextPage"}]},[a("v-btn",{attrs:{loading:t.loading,small:"",block:"",color:"secondary",dark:""},on:{click:t.loadNextPage}},[a("v-icon",[t._v("keyboard_arrow_down")])],1)],1):t.loading?a("div",[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):a("div",[a("v-divider"),t._v("\n        Tiro Finale\n      ")],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500",scrollable:""},model:{value:t.commentToDelete.show,callback:function(e){t.$set(t.commentToDelete,"show",e)},expression:"commentToDelete.show"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v("Are you sure?")]),a("v-divider"),a("v-card-text",[t._v("\n        You are deleting this comment:\n        "),a("br"),a("recursive-comment",{attrs:{comments:t.commentToDeleteList,canAddComment:!1,canDeleteComment:function(){return!1}}})],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"info",flat:"flat"},on:{click:function(e){t.commentToDelete.show=!1}}},[t._v("\n          No\n        ")]),a("v-btn",{attrs:{color:"error",flat:"flat"},on:{click:function(){t.deleteComment(t.commentToDelete.id),t.commentToDelete.show=!1,t.commentToDelete.id=0}}},[t._v("\n          Yes, delete"),a("v-icon",[t._v("delete")])],1)],1)],1)],1)],1)},ta=[],ea=(a("55dd"),a("d3d7")),aa=a.n(ea),na=a("2f62"),oa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.visible?a("div",[t._t("default")],2):a("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.setVisible,expression:"setVisible"}]},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-btn",{on:{click:t.setVisible}},[t._v(t._s(this.text))])],1)],1)])},ra=[],ia={props:["text"],name:"lazy-component",data:function(){return{visible:!1}},methods:{setVisible:function(){this.visible=!0}}},sa=ia,ca=Object(N["a"])(sa,oa,ra,!1,null,null,null),la=ca.exports;B()(ca,{VBtn:vt["a"],VLayout:yt["a"]});var ua=a("8414"),da=a("1e06"),ha=a("48d3");function ma(t){return fa(t)?t.author.nickname:t.nickname}function fa(t){return!!t.author}var va=ha["componentFactoryOf"]().create({name:"recursive-comment",props:{comments:{type:Array,required:!0},canAddComment:{type:Boolean,default:!0},canDeleteComment:{type:Function},postAuthorUsername:String,myUsername:String},render:function(){var t=arguments[0];return t(bt["a"],{attrs:{xs10:!0,sm7:!0,"offset-sm2":!0}},[this.renderComments(this.comments)])},methods:{renderComments:function(t){var e=this,a=this.$createElement;return a(ua["a"],{attrs:{dense:!0}},[a(W["e"],{attrs:{group:!0}},[t.map(function(t){return a(da["a"],{key:t.id,class:"mb-3",attrs:{"fill-dot":!0,color:t.color||(t.author?"accent":"#bbbbbb"),id:"comment-".concat(t.id)}},[t.author&&t.author.avatar?a(Pt["a"],{slot:"icon"},[a(jt["a"],{attrs:{src:t.author.avatar}})]):null,a(yt["a"],{attrs:{"justify-space-between":!0}},[a(bt["a"],{attrs:{xs7:!0}},[e.infoLabel(ma(t),t.color||(t.author?"secondary":"#bbbbbb"),!1,e.getUsername(t)?{name:"userTimeline",params:{username:e.getUsername(t)}}:void 0),e.myUsername&&S(e.getUsername(t),e.myUsername)?e.infoLabel("You","accent",!0):e.postAuthorUsername&&S(e.getUsername(t),e.postAuthorUsername)?e.infoLabel("Author","accent",!0):null,a("div",{domProps:{innerHTML:t.content}}),e.canAddComment&&a(vt["a"],{attrs:{flat:!0,icon:!0},on:{click:function(){return e.$emit("reply-comment",t.id)}}},[a(Et["a"],["reply"])]),e.canDeleteComment(t)?a(vt["a"],{attrs:{flat:!0,icon:!0,color:"error",small:!0},on:{click:function(){return e.$emit("delete-comment",t.id)}}},[a(Et["a"],["delete"])]):null]),a(bt["a"],{attrs:{xs5:!0,"text-xs-right":!0}},[ht.formatDate(t.createdAt)])]),a(bt["a"],[t.replies.length?a("div",[e.renderComments(t.replies)]):null])])})])])},getUsername:function(t){return function(t){return t.author&&t.author.username}(t)},infoLabel:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,o=this.$createElement,r=this.$vuetify.theme[e]||e,i=o($t["a"],{attrs:{small:!0,color:e,outline:a,to:n},class:{"ml-0":!0,"white--text":!a&&V(r,!1,!0,!0)}},[t]);return n?o("router-link",{attrs:{to:n}},[i]):i}}}),pa=a("ebfb"),ga=a.n(pa),ba={components:{lazyComponent:la,recursiveComment:va},props:["userData","postData","toast","renderer"],name:"blog-comment",data:function(){return{visible:!1,chip:!1,comment:"",nickname:"",commentLeft:!1,loading:!1,currentPage:0,totalPages:1,commentCount:0,commentList:[],replyToComment:void 0,hasUnsafedDraft:!1,commentToDelete:{id:0,show:!1},removeTokens:{},cachedDraft:{},userMeta:{},userMetaLoaded:!1,showPreview:!1}},methods:Object(f["a"])({},Object(na["b"])(["setCommentDraft","removeCommentDraft"]),{getCommentDraft:function(t){return this.$store.state.commentDraft[t]},setVisible:function(){this.visible=!0},formatDate:function(t){return ht.formatDate(t)},hightlightLanguage:function(){window.hljs&&(window.hljs.initHighlighting.called=!1,window.hljs.initHighlighting())},addComment:function(){var t=this;this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("comment","add"),"POST",this.addPostForm).then(D).then(function(e){t.toast("Well, you placed a comment!","success"),t.loading=!1,t.removeTokens[e.commentId]=e.removeToken,t.cachedDraft[e.commentId]={nickname:t.nickname,comment:t.comment,replyTo:t.replyToComment},t.removeCommentDraft(t.postData.id),t.cleanUp(),t.loadNextPage()}).catch(function(e){t.toast(e,"error"),t.loading=!1})},cleanUp:function(){this.currentPage=0,this.totalPages=1,this.commentCount=0,this.commentList=[],this.comment="",this.replyToComment=void 0,this.commentLeft=!1,this.showPreview=!1},deleteComment:function(t){var e=this;ht.fetchJSONWithSuccess(ht.apiFor("comment","delete"),"POST",C({comment:t,removeToken:this.removeTokens[t]})).then(function(a){if(e.commentList=e.commentList.filter(function(e){return e.id!==t}),--e.commentCount,e.removeTokens[t]=void 0,e.cachedDraft[t]){var n=e.cachedDraft[t],o=n.nickname,r=n.comment,i=n.replyTo;e.comment||(e.nickname=o,e.comment=r,e.replyToComment=i),e.cachedDraft[t]=void 0}}).catch(function(t){e.toast("Oops! Failed.","error")})},onReplyComment:function(t){this.replyToComment=t},canDeleteComment:function(t){return!!this.removeTokens[t.id]||!!this.isLoggedIn&&(!t.author||(t.author.username==this.userData.username||(t.author.role?t.author.role<=this.userData.role:!!this.userData)))},loadNextPage:function(){var t=this;this.loading||this.currentPage>=this.totalPages||(this.loading=!0,ht.fetchJSON(ht.apiFor("comment","comments"),"GET",{p:this.postData.id,page:this.currentPage+1,limit:10}).then(function(t){return t.success?t:ot.a.reject("Invalid postid")}).then(function(e){t.commentList=t.commentList.concat(e.result.map(D).map(function(t){return Object(f["a"])({},t,{showReply:!1})})),t.totalPages=e.pages,t.commentCount=e.total,++t.currentPage,t.loading=!1,t.renderScript(),t.$nextTick(function(){t.processComments(),t.hasUnsafedDraft=!1})}).catch(function(e){t.toast(e,"error"),t.loading=!1}))},getComment:function(t){return this.commentDict[t]},getCommentOrNotFound:function(t){var e=this.getComment(t);return e||(this.loadNextPage(),{id:0,nickname:"Anoymous",content:"This comment is gone.",createdAt:new Date})},getCommentNickname:function(t){return t.nickname||T("author","nickname")(t)},processComments:function(t){var e=this,a=t||this.$refs.comments.$el||this.$refs.comments,n=oe()(a.querySelectorAll("a")).filter(function(t){return!!t.href}),o=["mohuety.com","roselia.moe","roselia.xyz","lisa.moe","roselia.app"].map(function(t){return new RegExp(t)});n.filter(function(t){return!t.getAttribute("roselia-prevented")}).filter(function(t){return t.host!==location.host&&!o.some(function(e){return e.exec(t.host)})}).forEach(function(){var t=Object(re["a"])(regeneratorRuntime.mark(function t(a){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a.setAttribute("roselia-prevented",!0),a.addEventListener("click",function(t){t.preventDefault(),e.renderer.context.askForAccess(a.host,"This link wish to visit an unknown host ".concat(a.host),"The link is ".concat(a.href," please make sure it is safe.")).then(function(){window.open(a.href)})});case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());var r=a.querySelectorAll("img"),i=oe()(r);i.forEach(function(t){t.classList.add("responsive-img")}),le.a.Materialbox.init(r),this.hightlightLanguage()},renderScript:function(){var t=this;this.commentList.filter(function(t){return t.author}).filter(function(t){return!t.rendered}).forEach(function(e){t.forceRenderScript(e)})},forceRenderScript:function(t){Object.defineProperty(t,"id",{value:t.id,writable:!1}),t.author=new Proxy(t.author,{set:function(t,e,a){if("role"!==e)return aa()(t,e,a)}});var e=this.renderer.pushContext(t,"comment");t.cleanedContent=this.renderer.cleanScript(t.content);var a=this.renderer.render(t.content);t.content=a,t.rendered=!0,this.renderer.injectEvents(),e()},onExit:function(t){this.hasUnsafedDraft&&this.setCommentDraft({commentId:t||this.postData.id,comment:{comment:this.comment,nickname:this.nickname}})},loadDraft:function(t){var e=this.getCommentDraft(t||this.postData.id);e&&(this.comment=e.comment||this.comment,this.nickname=e.nickname||this.nickname)},ensureUserMeta:function(){var t=this;this.userData||(this.userMetaLoaded=!1,this.userMeta={}),this.userMetaLoaded&&this.userMeta.username===this.userData.username||(this.userMetaLoaded=!1,ht.fetchJSONWithSuccess(ht.apiFor("user","user-meta"),"GET",{username:this.userData.username}).then(function(e){t.userMeta=D(e),t.userMetaLoaded=!0,t.showPreview&&(t.showPreview=!1,t.$nextTick(function(){t.showPreview=!0}))}).catch(function(t){}))},switchPreviewMode:function(){var t=this;this.showPreview=!this.showPreview,this.showPreview&&(this.ensureUserMeta(),this.$nextTick(function(){t.processComments(t.$refs.previewComment.$el||t.$refs.previewComment)}))},highlightLanguage:function(){window.hljs&&(window.hljs.initHighlighting.called=!1,window.hljs.initHighlighting())}}),computed:{commentPlaceholer:function(){return this.commentLeft?"It is fine to keep silent, dear ".concat(this.currentNickname,"."):"Say something."},currentNickname:function(){return this.userData&&this.userData.nickname||this.nickname},isValid:function(){return this.comment&&this.currentNickname},isLoggedIn:function(){return!!this.userData},addPostForm:function(){return C({toPost:this.postData.id,content:this.comment,nickname:this.isLoggedIn?void 0:this.currentNickname,toComment:this.replyToComment||void 0})},canAddComment:function(){return!(!this.userData&&!this.postData.enableComment)},commentDict:function(){return this.commentList.reduce(function(t,e){return Object(f["a"])({},t,Object(m["a"])({},e.id,e))},{})},atToNickname:function(){var t=this.getComment(this.replyToComment);return t&&this.getCommentNickname(t)},recursiveCommentList:function(){var t=this,e=this.commentDict,a=this.commentList.filter(function(t){return!t.replyTo}).concat(this.commentList.filter(function(t){return t.replyTo}).filter(function(t){return!e[t.replyTo]}).map(function(a){var n=Object(f["a"])({},t.getCommentOrNotFound(a.replyTo),{id:a.replyTo});return e[a.replyTo]=n}));return g()(e).forEach(function(t){var a=Object(v["a"])(t,2),n=a[0],o=a[1];e[n]=Object(f["a"])({},o,{replies:[]})}),this.commentList.forEach(function(t){t.replyTo&&e[t.replyTo].replies.push(e[t.id])}),a.sort(function(t,e){return e.id-t.id}),a.map(function(t){return e[t.id]})},commentToDeleteList:function(){return[Object(f["a"])({},this.commentDict[this.commentToDelete.id],{replies:[]})]},currentCommentObject:function(){var t=function(t){return ga.a.prototype.markdown(t)},e={content:t(this.comment),color:"",createdAt:new Date,replies:[],author:this.userData?Object(f["a"])({},this.userMetaLoaded?this.userMeta:this.userData):void 0,nickname:this.userData?void 0:this.nickname,id:0};return this.showPreview&&this.userData&&this.forceRenderScript(e),e}},watch:{comment:function(){this.commentLeft=!0,this.hasUnsafedDraft=!0},replyToComment:function(t){t&&(this.$vuetify.goTo(this.$refs.commentText),this.chip=!0)},chip:function(t){t||(this.$vuetify.goTo("#comment-"+this.replyToComment),this.replyToComment=void 0)},postData:function(t,e){this.onExit(e.id),this.cleanUp(),this.loadDraft(t.id)},userData:function(){this.ensureUserMeta()}},mounted:function(){this.loadDraft()},beforeDestroy:function(){this.onExit()}},ya=ba,wa=a("4ca6"),ka=a("a844"),_a=Object(N["a"])(ya,Qe,ta,!1,null,null,null),xa=_a.exports;B()(_a,{VBadge:wa["a"],VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardText:Ot["b"],VCardTitle:Vt["a"],VChip:$t["a"],VContainer:pt["a"],VDialog:Ue["a"],VDivider:gt["a"],VFlex:bt["a"],VIcon:Et["a"],VLayout:yt["a"],VProgressCircular:wt["a"],VSpacer:Ut["a"],VTextField:zt["a"],VTextarea:ka["a"]});var Da={components:{BlogDigestNav:me,BlogComments:xa},name:"blog-post",props:{p:Number,currentColorScheme:Boolean,userData:Object},data:function(){return{postData:{img:"",id:0,displayId:"",content:"<p>Loading, please wait...</p>",author:{nickname:""},darkTitle:!1,next:-1,prev:-1,secret:0,title:"Loading...",subtitle:"",tags:[""],date:(new Date).toDateString()},postDigest:[],preview:{show:!1,loading:!1,current:0,title:"",subtitle:"",attach:"",origin:"center center",img:"",cacheData:null,color:"secondary"},cachedData:!1,renderer:null,toast:ht.getToastOption(),rsRendered:!1,share:{open:!1,shareId:""}}},methods:{showToast:function(t,e){return ht.showToast.call(this,t,e)},changeToast:function(t){this.toast.show=t},getArguments:function(){return this.$route.query},formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ht.formatDate(t,e)},loadContent:function(t,e){var a=this;if(t=t||this.getPostNum(),e=e||this.$route,e&&e.params.data){var n=e.params.data;if("preview"===n.id||n.id==t)return this.postData=Object(f["a"])({},this.notFoundData(),n),this.cachedData=!0,void this.processContent()}var o=e&&e.params.postLink;o&&(t=e.params.postLink),this.cachedData=!1,-1!==t?ht.fetchJSON(ht.apiFor(o?"post-link":"post",t)).then(function(t){return t?(a.postData=D(t),a.processContent()):ot.a.reject(ReferenceError("NPE"))}).catch(function(t){a.postData=a.notFoundData()}):this.postData=this.notFoundData()},processContent:function(){var t=this;this.postData.displayId&&(this.$route.params.changeRoute||this.$route.query.p&&!this.isShared)&&this.$router.replace({name:"postWithEternalLink",params:{postLink:this.postData.displayId,doNotLoad:!0}}),Object.defineProperty(this.postData,"id",{value:this.postData.id,writable:!1});var e=this.renderer.pushContext(this.postData,"post");this.renderer.renderAsync(this.postData.content).then(function(a){t.postData.content=a,t.$nextTick(function(){t.renderer.injectEvents(),e()})}).then(function(){return t.$nextTick(Object(re["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.afterContentMounted());case 1:case"end":return e.stop()}},e)})))})},afterContentMounted:function(){var t=this,e=this.$refs.content.querySelectorAll("img");oe()(e).forEach(function(t){t.classList.add("responsive-img")}),le.a.Materialbox.init(e),this.setDigest();var a=Object(lt["escapeRegExp"])(location.host),n=["".concat(a,"/.*\\?p=(\\d+)"),"".concat(a,"(?:/.*)?/post/([\\s\\S]*)")].map(function(t){return new RegExp(t)}),o=oe()(this.$refs.content.querySelectorAll("a")).filter(function(t){return!!t.href});o.filter(function(t){return t.host===location.host}).forEach(function(){var e=Object(re["a"])(regeneratorRuntime.mark(function e(a){var o,r,i,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:o=a.href,r=n[0].exec(o),i=n[1].exec(o),(r||i)&&(s=(r||i)[1],c=a.hash,a.addEventListener("click",function(e){e.preventDefault(),c?t.$vuetify.goTo(document.getElementById(a.hash.substring(1)),{offset:-200}):t.$router.push({name:r?"post":"postWithEternalLink",query:{p:r?s:void 0},params:{data:t.preview.current!=s||t.preview.loading?void 0:t.preview.cacheData,postLink:i?s:void 0}})},!0),a.addEventListener("mouseover",function(){var e=Object(re["a"])(regeneratorRuntime.mark(function e(n){var o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t.preview.show=!0,t.preview.attach=a,!c){e.next=10;break}return t.preview.cacheData=null,t.preview.current=s,o=document.getElementById(a.hash.substring(1)),t.preview.title=o.innerText,t.preview.img="",-1!==a.hash.indexOf("ref")?t.preview.subtitle=o.parentElement.innerText:t.preview.subtitle="",e.abrupt("return");case 10:if(t.preview.current!==s||t.preview.loading||!t.preview.cacheData){e.next=13;break}return t.preview.current=s,e.abrupt("return");case 13:t.preview.current=s,t.preview.loading=!0,t.preview.img="",ht.fetchJSON(ht.apiFor(r?"post":"post-link",s)).then(function(e){if(!e)return t.preview.loading=!1,t.preview.title="Oops! :(",t.preview.subtitle="This is a secret",void(t.preview.img="");t.preview.cacheData=D(e),t.preview.loading=!1,t.preview.title=e.title,t.preview.subtitle=e.subtitle,t.preview.img=e.img}).catch(function(e){t.preview.loading=!1,t.preview.cacheData=null,t.preview.title=":(",t.preview.subtitle=e.message,t.preview.img=""});case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),a.addEventListener("mouseout",function(e){t.preview.show=!1}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.highlightLanguage(),this.renderWithMathJax(),this.$emit("postLoaded")},highlightLanguage:function(){window.hljs&&(window.hljs.initHighlighting.called=!1,window.hljs.initHighlighting())},renderWithMathJax:function(){window.MathJax&&window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,"output"])},getPostNum:function(){return this.getArguments().p||-1},notFoundData:function(){return{img:"",id:-1,content:"",next:-1,prev:-1,secret:0,title:"Page Not Found",subtitle:"Please check your post-id. Or try to login.",author:{nickname:""},darkTitle:!1,tags:[],created:new Date,lastEdit:new Date}},setDigest:function(){this.postDigest=oe()(this.$refs.content.querySelectorAll("h1,h2,h3")).map(function(t,e){return t.classList.add("scrollspy"),t.classList.add("section"),t.id=t.id||"section-".concat(e),{hash:t.id,title:t.innerText,element:t}})},getPostByShared:function(t){var e=this;ht.fetchJSON(ht.apiFor("post","get-shared",t)).then(function(t){if(!t)return ot.a.reject("");e.postData=Object(f["a"])({},e.notFoundData(),D(t)),e.processContent()}).catch(function(t){e.postData=e.notFoundData()})},sharePost:function(){var t=this;this.share.shareId="",this.postData.secret&&ht.fetchJSONWithSuccess(ht.apiFor("post","share"),"post",{pid:this.postData.id}).then(function(e){t.share.shareId=e}),this.share.open=!0}},computed:{hasDigest:function(){return this.postDigest.length>0},isTokenExpired:function(){return ht.isTokenExpired(this.userData&&this.userData.token)},titleClass:function(){return"".concat(["white","black"][+this.postData.darkTitle],"--text")},isEditable:function(){return!(!this.postData.author||!this.userData)&&this.userData.role>=this.postData.author.role},isPostFound:function(){return this.postData.id>0},isShared:function(){return!!this.$route.params.shareId},sharePath:function(){if(!this.postData.secret||!this.share.shareId)return location.href;var t=this.$router.resolve({name:"sharedPost",params:{shareId:this.share.shareId}}).href,e=document.createElement("a");return e.href=t,e.href}},mounted:function(){if(this.renderer=Ze.createRenderer(this),this.$route.params.shareId?this.getPostByShared(this.$route.params.shareId):this.loadContent(),!window.MathJax){var t=document.createElement("script");t.async=!0,t.src="https://cdn.bootcss.com/mathjax/2.7.3/latest.js?config=TeX-MML-AM_CHTML";var e=document.createElement("script");e.type="text/x-mathjax-config",e.innerHTML="MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});",document.body.appendChild(e),document.body.appendChild(t)}},beforeRouteUpdate:function(t,e,a){return t.params.doNotLoad?a():t.query.p===e.query.p&&t.params.postLink==e.params.postLink?a():(this.$vuetify.goTo(0),this.$emit("postUnload"),this.loadContent(t.query.p,t),void a())},destroyed:function(){this.$emit("postUnload"),this.$emit("postDestroyed")},watch:{userData:function(){!this.userData&&this.postData.secret&&(this.postData=this.notFoundData()),-1===this.postData.id&&this.loadContent()},"window.MathJax":function(){this.renderWithMathJax()}}},Ca=Da,Ta=Object(N["a"])(Ca,ee,ae,!1,null,"28ff48f4",null),Sa=Ta.exports;B()(Ta,{VAvatar:Pt["a"],VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardText:Ot["b"],VCardTitle:Vt["a"],VChip:$t["a"],VContainer:pt["a"],VDialog:Ue["a"],VDivider:gt["a"],VFlex:bt["a"],VIcon:Et["a"],VImg:jt["a"],VLayout:yt["a"],VParallax:Ft["a"],VProgressLinear:Yt["a"],VSpacer:Ut["a"],VTextField:zt["a"]});var Pa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("blog-toolbar",{attrs:{userData:t.userData}}),a("v-container",{attrs:{"grid-list-md":"",fluid:"","fill-height":""}},[a("v-layout",[a("v-flex",{attrs:{xs12:"",sm8:"","offset-sm2":""}},[a("h1",{staticClass:"display-3"},[t._v(t._s(t.realTitle))]),a("v-layout",[a("v-spacer"),a("v-tooltip",{attrs:{bottom:""}},[a("v-btn",{attrs:{slot:"activator",color:"secondary",fab:"",small:"",to:{name:"post",params:{data:t.getPreviewData()}}},slot:"activator"},[a("v-icon",[t._v("visibility")])],1),a("span",[t._v("Preview the post. Note that the link can be used only once.")])],1)],1),a("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{label:"Title","prepend-icon":"title",required:"",rules:[function(t){return!!t||"Title is required"}]},model:{value:t.postData.title,callback:function(e){t.$set(t.postData,"title",e)},expression:"postData.title"}}),a("v-text-field",{attrs:{label:"Subtitle","prepend-icon":"subtitles"},model:{value:t.postData.subtitle,callback:function(e){t.$set(t.postData,"subtitle",e)},expression:"postData.subtitle"}}),a("v-text-field",{attrs:{label:"Eternal link","prepend-icon":"link"},model:{value:t.postData.displayId,callback:function(e){t.$set(t.postData,"displayId",e)},expression:"postData.displayId"}}),a("span",[t._v("Language")]),a("v-switch",{attrs:{color:"accent",label:t.markdown?"Markdown":"HTML"},model:{value:t.markdown,callback:function(e){t.markdown=e},expression:"markdown"}}),t.markdown||t.addPost?t._e():a("v-btn",{attrs:{color:"info"},on:{click:t.loadContent}},[t._v("Edit raw HTML")]),a("v-slider",{attrs:{step:"1",min:"0",max:t.userData.role+1,ticks:"","thumb-label":"",label:"Secret level","prepend-icon":t.lockIcon},model:{value:t.postData.secret,callback:function(e){t.$set(t.postData,"secret",e)},expression:"postData.secret"}}),a("span",[a("v-icon",[t._v("visibility"+t._s(t.postData.hidden?"_off":""))]),t._v("\n            Hidden?\n          ")],1),a("v-switch",{attrs:{color:"accent",label:t.postData.hidden?"Hidden":"Public"},model:{value:t.postData.hidden,callback:function(e){t.$set(t.postData,"hidden",e)},expression:"postData.hidden"}}),a("span",[t._v("Comment")]),a("v-switch",{attrs:{color:"accent",label:t.postData.enableComment?"Enabled":"Disabled"},model:{value:t.postData.enableComment,callback:function(e){t.$set(t.postData,"enableComment",e)},expression:"postData.enableComment"}}),a("span",[t._v("Color of Title")]),a("v-switch",{attrs:{color:"accent",label:t.postData.darkTitle?"Dark":"Light"},model:{value:t.postData.darkTitle,callback:function(e){t.$set(t.postData,"darkTitle",e)},expression:"postData.darkTitle"}}),a("v-combobox",{attrs:{"hide-selected":"",label:"Tags","prepend-icon":"label",multiple:"",chips:"","deletable-chips":""},on:{input:t.changeTags},model:{value:t.postData.tags,callback:function(e){t.$set(t.postData,"tags",e)},expression:"postData.tags"}}),a("v-text-field",{attrs:{label:"Banner Image","prepend-icon":"image"},model:{value:t.postData.img,callback:function(e){t.$set(t.postData,"img",e)},expression:"postData.img"}}),a("span",[t._v("Content")]),a("markdown-editor",{ref:"markdownEditor",attrs:{id:"markdownEditor",highlight:!0,configs:t.configs},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"s",void 0,e.key,void 0)?null:e.ctrlKey?(e.preventDefault(),t.saveDraft(e)):null}},model:{value:t.postData.content,callback:function(e){t.$set(t.postData,"content",e)},expression:"postData.content"}}),a("v-card-actions",[a("v-spacer"),t.loading?a("div",[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):a("div",[a("v-layout",[t.addPost?t._e():a("v-btn",{attrs:{color:"info"},on:{click:t.reloadPost}},[a("v-icon",[t._v("refresh")])],1),t.addPost?t._e():a("v-btn",{attrs:{color:"error"},on:{click:function(e){t.deleteDialog=!0}}},[a("v-icon",[t._v("delete")])],1),a("v-btn",{attrs:{color:"secondary",loading:t.loading},on:{click:t.saveDraft}},[a("v-icon",[t._v("archive")])],1),a("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.doEditPost}},[a("v-icon",[t._v("cloud_upload")])],1)],1)],1)],1)],1)],1)],1),a("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.realTitle,expression:"realTitle"}]}),a("v-dialog",{attrs:{"max-width":"500"},model:{value:t.deleteDialog,callback:function(e){t.deleteDialog=e},expression:"deleteDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v("Are you sure?")]),a("v-card-text",[t._v("\n          You are deleting "+t._s(t.postData.title)+"\n          "),a("br"),t._v("\n          This post will be deleted, and can NOT be undone.\n        ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"info",flat:"flat"},on:{click:function(e){t.deleteDialog=!1}}},[t._v("\n            No\n          ")]),a("v-btn",{attrs:{color:"error",flat:"flat",loading:t.loading},on:{click:t.deletePost}},[t._v("\n            Yes, delete"),a("v-icon",[t._v("delete")])],1)],1)],1)],1)],1),a("toast",t._b({on:{showChange:t.changeToast}},"toast",t.toast,!1)),a("blog-footer")],1)},La=[],Oa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-toolbar",{attrs:{color:"primary","scroll-toolbar-off-screen":""}},[t.shouldHaveToolbar?a("v-toolbar-side-icon",{attrs:{dark:""},nativeOn:{click:function(e){t.drawer=!t.drawer}}}):t._e(),t._t("default"),a("v-toolbar-title",[a("router-link",{staticClass:"themed-text no-deco",attrs:{to:{name:"index"}}},[t._v(t._s(t.title))])],1),a("v-spacer"),t.shouldHaveToolbar?t._e():a("v-toolbar-items",[a("v-btn",{attrs:{dark:"",flat:"",to:"/"}},[t._v("Index")]),a("v-btn",{attrs:{dark:"",flat:"",to:"/timeline"}},[t._v("Timeline")]),t.userData?a("v-btn",{attrs:{dark:"",flat:"",to:"/userspace"}},[t._v(t._s(t.userData.nickname))]):a("v-btn",{attrs:{dark:"",flat:"",tag:"a",to:{name:"login"}},on:{contextmenu:function(e){return t.portedLogin(e)}},nativeOn:{click:function(e){return t.setRedirect(e)}}},[t._v("Login")])],1)],2),t.shouldHaveToolbar?a("v-navigation-drawer",{attrs:{fixed:"",clipped:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-toolbar",{attrs:{flat:""}},[a("v-list",[a("v-list-tile",[a("v-list-tile-title",{staticClass:"title"},[t._v("\n            "+t._s(t.title)+"\n          ")])],1)],1)],1),a("v-divider"),a("v-list",{staticClass:"pt-0",attrs:{dense:""}},[a("v-list-tile",{attrs:{to:"/"}},[a("v-list-tile-action",[a("v-icon",[t._v("home")])],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v("Index")])],1)],1)],1),a("v-list",{staticClass:"pt-0",attrs:{dense:""}},[a("v-list-tile",{attrs:{to:"/timeline"}},[a("v-list-tile-action",[a("v-icon",[t._v("list_alt")])],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v("Timeline")])],1)],1)],1),t.userData?a("v-list",{staticClass:"pt-0",attrs:{dense:""}},[a("v-list-tile",{attrs:{to:"/userspace"}},[a("v-list-tile-action",[a("v-icon",[t._v("account_circle")])],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v(t._s(t.userData.nickname))])],1)],1)],1):a("v-list",{staticClass:"pt-0",attrs:{dense:""}},[a("v-list-tile",{attrs:{to:"/login"},on:{click:t.setRedirect}},[a("v-list-tile-action",[a("v-icon",[t._v("person")])],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v("Login")])],1)],1)],1)],1):t._e()],1)},Va=[],$a={name:"blog-toolbar",props:["userData","route","realTitle","noDrawer"],data:function(){return{drawer:!1}},methods:{setRedirect:function(){ht.setRedirect(this.route)},portedLogin:function(t){t.preventDefault();var e=window.open(this.$router.resolve({name:"login",query:{ported:!0}}).href,"loginWindow","height=400,width=400,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no"),a=this.$watch("userData",function(t){t&&(e.close(),a())});e.addEventListener("close",a)}},computed:{title:function(){return this.realTitle||at.title},shouldHaveToolbar:function(){return!this.noDrawer&&this.$vuetify.breakpoint.smAndDown}},watch:{shouldHaveToolbar:function(t){t||(this.drawer=!1)}}},Ea=$a,ja=a("8860"),Aa=a("ba95"),Fa=a("40fe"),Ua=a("5d23"),Ia=a("f774"),Ra=a("706c"),Na=Object(N["a"])(Ea,Oa,Va,!1,null,"0a0feb82",null),Ma=Na.exports;B()(Na,{VBtn:vt["a"],VDivider:gt["a"],VIcon:Et["a"],VList:ja["a"],VListTile:Aa["a"],VListTileAction:Fa["a"],VListTileContent:Ua["a"],VListTileTitle:Ua["b"],VNavigationDrawer:Ia["a"],VSpacer:Ut["a"],VToolbar:Gt["a"],VToolbarItems:Kt["a"],VToolbarSideIcon:Ra["a"],VToolbarTitle:Kt["b"]});var Ba=a("1487"),qa=a.n(Ba),Ja=a("bdfa"),Wa=(a("b116"),a("e4cb"),a("8159"),a("a745")),Ha=a.n(Wa),Ya={ie:"Trident",opera:"Presto",webKit:"AppleWebkit",fireFox:["Gecko","KHTML"],mobile:function(t){return!!t.match(/AppleWebKit.*Mobile.*/)},iOS:function(t){return!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)},android:["Android","Adr"],iPhone:"iPhone",iPad:"iPad",weChat:"MicroMessenger",macOS:"Mac OS X"},za=_(function(t){var e=navigator.userAgent,a=function t(a){return"function"===typeof a?a(e):"string"===typeof a?e.indexOf(a)>-1:Ha()(a)?a.some(t):null};return a(t)})(Ya),Ga=Object(f["a"])({},za);window.hljs=qa.a,window.platform=Ga;var Ka={components:{BlogToolbar:Ma,markdownEditor:Ja["a"]},name:"post-edit",data:function(){return{postData:{img:"",id:0,content:"",secret:0,title:"",subtitle:"",hidden:!1,enableComment:!0,darkTitle:!1,displayId:"",tags:[]},toast:{show:!1,text:"",color:""},deleteDialog:!1,valid:!0,markdown:!0,addPost:0,loading:!1,configs:{spellChecker:!1,hideIcons:["guide"]},uploadImages:[],doNotSave:!1}},props:{userData:Object},methods:{showToast:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.toast.text=t,this.toast.color=e,this.toast.show=!0},changeToast:function(t){this.toast.show=t},makeRedirect:function(t){ht.setRedirect(this.$route.fullPath),ht.redirectTo(t)},changeTags:function(){this.postData.tags=this.postData.tags.map(function(t){return t.replace(/ /g,"-")})},getPostNum:function(){return this.$route.query.post},getPostData:function(){return this.changeTags(),{markdown:this.markdown,data:this.postData,uploadImages:this.uploadImages}},getPostDraft:function(t){return JSON.parse(window.localStorage.getItem("postDraft#".concat(t||0)))},saveDraft:function(){window.localStorage.setItem("postDraft#".concat(this.postData.id||0),E()(this.getPostData())),this.showToast("Draft saved!")},deleteDraft:function(){window.localStorage.removeItem("postDraft#".concat(this.postData.id||0))},getRequestForm:function(){var t=Object(f["a"])({},this.postData,{id:void 0,next:void 0,prev:void 0,lastEdit:void 0,author:void 0,created:void 0});return{postID:this.addPost?void 0:this.postData.id,data:C(t),markdown:this.markdown}},loadDraft:function(){var t=this.getPostNum()||0,e=this.getPostDraft(t);return e&&(this.markdown=e.markdown,this.postData=e.data),!!e},preload:function(){var t=this.loadDraft();return t&&this.showToast("Draft loaded!"),t},loadContent:function(){var t=this,e=this.getPostNum();e&&(this.loading=!0,ht.fetchJSON(ht.apiFor("post",e),"GET",{markdown:this.markdown}).then(function(e){t.loading=!1,e?t.postData=D(e):t.addPost=!0}).catch(function(e){t.showToast(e,"error")}))},doEditPost:function(){var t=this;return this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("add"),"POST",this.getRequestForm()).then(function(e){t.showToast("Success!","success"),t.leave()}).catch(function(e){if(t.$Progress.fail(),"expired"===e)return ht.refreshToken().then(function(e){return t.doEditPost()}).catch(function(e){t.showToast("Token Expired!","warning"),t.makeRedirect({name:"login"})});t.showToast(e,"error")}).finally(function(){t.deleteDialog=!1,t.loading=!1})},deletePost:function(){var t=this,e=this.getPostNum();if(e){var a=ht.getLoginData();a&&a.role?ht.fetchJSONWithSuccess(ht.apiFor("remove"),"POST",{postID:e}).then(function(e){t.showToast("Success!","success"),t.leave(!0)}).catch(function(e){"expired"===e?(t.showToast("Token Expired!","warning"),t.$router.push({name:"login"})):t.showToast(e,"error")}):this.showToast("You are not supposed to do this.","warning")}},reloadPost:function(){this.markdown=!0,this.loadContent()},doNotDelete:function(){this.deleteDialog=!1,this.leave()},leave:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&this.deleteDraft(),this.doNotSave=t,this.$route.params.deletePost?this.$router.go(-1):ht.redirectTo({name:"index"})},simplemde:function(){var t=this.$refs.markdownEditor;return t?t.simplemde:{markdown:function(t){return t}}},getPreviewData:function(){return Object(f["a"])({},this.postData,{id:"preview",content:this.markdown?this.simplemde().markdown(this.postData.content):this.postData.content})}},computed:{realTitle:function(){return this.addPost?"Add a post":"Edit: ".concat(this.postData.title)},operationVerb:function(){return this.addPost?"add":"edit"},lockIcon:function(){return this.postData.secret?"lock":"lock_open"},isMac:function(){return Ga.macOS},isMobile:function(){return Ga.mobile},commandText:function(){return this.isMac?"⌘":"Ctrl"}},mounted:function(){var t=this;if(!this.userData)return this.makeRedirect({name:"login",params:{logout:!0,message:"Login to ".concat(this.operationVerb," a post")}});if(!this.userData.role)return this.showToast("You are not supposed to do this."),void ht.redirectTo({name:"index"});if(this.$route.params.deletePost){this.deleteDialog=!0,this.postData.title=this.$route.params.title;var e=this.$watch("deleteDialog",function(a){e(),t.doNotDelete()})}else{this.addPost=!this.getPostNum();var a=this.preload();a||this.addPost||this.loadContent(),window.addEventListener("beforeunload",function(e){return t.saveDraft()}),this.$emit("forceSwitchToLight",!0);ht.addEventListener("keyup",function(t){})}},watch:{userData:function(t){t||this.makeRedirect({name:"login"})}},beforeDestroy:function(){this.doNotSave||this.saveDraft()},destroyed:function(){var t=this;this.$emit("forceSwitchToLight"),removeEventListener("beforeunload",function(e){return t.saveDraft()})}},Xa=Ka,Za=a("2b5d"),Qa=a("ba0d"),tn=a("b73d"),en=a("3a2f"),an=Object(N["a"])(Xa,Pa,La,!1,null,"df2e9380",null),nn=an.exports;B()(an,{VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardText:Ot["b"],VCardTitle:Vt["a"],VCombobox:Za["a"],VContainer:pt["a"],VDialog:Ue["a"],VFlex:bt["a"],VForm:Ht["a"],VIcon:Et["a"],VLayout:yt["a"],VProgressCircular:wt["a"],VSlider:Qa["a"],VSpacer:Ut["a"],VSwitch:tn["a"],VTextField:zt["a"],VTooltip:en["a"]});var on=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"top-details"},[a("aside",{staticClass:"exception-logo"}),a("header",{staticClass:"exception-info"},[a("h5",{staticClass:"struct blog-text"},[t._v("\n        RoseliaBlog.Router."+t._s(t.errorCode)+"Error\n        "),a("small",[t._v("at "+t._s(t.method))]),a("small",{staticClass:"path"},[t._v(t._s(t.path))])]),a("h1",{staticClass:"title blog-text"},[t._v("an error found for "+t._s(t.method)+" "+t._s(t.path)+" (RoseliaBlog.Router)")])]),a("div",{staticClass:"code-explorer"},[a("div",{staticClass:"code-snippets"},[a("div",{staticClass:"frame-info -active",attrs:{"data-index":"0",role:"stack-trace-details"}},[t._m(0),a("pre",{staticClass:"black--text code code-block"},[t._m(1),t._v("\n                      "),t._m(2),t._v("\n                      "),t._m(3),t._v("\n                      "),t._m(4),t._v("\n                      "),t._m(5),t._v("\n                      "),t._m(6),t._v("\n                      "),a("span",{staticClass:"line -highlight"},[a("span",{staticClass:"ln"},[t._v("666")]),a("span",{staticClass:"code"},[t._v('    case "'+t._s(t.path)+'" => '+t._s(t.errorTaunt))])]),t._v("\n                      "),t._m(7),t._v("\n                      "),t._m(8),t._v("\n                  ")]),t._m(9)])]),a("div",{staticClass:"stack-trace"},[a("ul",{staticClass:"stack-trace-list -show-all",attrs:{role:"stack-trace-list"}},[t._m(10),a("li",[a("router-link",{staticClass:"stack-trace-item",attrs:{to:"/",role:"stack-trace-item","data-index":"0"}},[a("span",{staticClass:"left"},[a("span",{staticClass:"app"},[t._v("RoseliaBlog")]),a("span",{staticClass:"filename"},[t._v("\n                                  Bring me back\n                              ")])]),a("span",{staticClass:"info"},[t._v('_ => RoseliaBlog.Router.route("index")')])])],1)])])])]),a("div",{staticClass:"conn-info"},[a("details",{staticClass:"conn-details"},[a("summary",[t._v("Known info")]),a("dl",[a("dt",[t._v("Instance:")]),a("dd",{staticClass:"code-quote"},[t._v(t._s(t.title))])]),a("dl",[a("dt",[t._v("URI:")]),a("dd",{staticClass:"code-quote"},[t._v(t._s(t.path))])]),a("dl",[a("dt",[t._v("Description:")]),a("dd",{staticClass:"code-quote"},[t._v(t._s(t.motto))])]),a("dl",[a("dt",[t._v("Error:")]),a("dd",{staticClass:"code-quote"},[t._v(t._s(t.errorCode)+" - "+t._s(t.errorTaunt))])])])])])},rn=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"file"},[a("a",{attrs:{href:""}},[t._v("lib/roselia_blog/router")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"line"},[a("span",{staticClass:"ln"},[t._v("1")]),a("span",{staticClass:"code"},[t._v("class RoseliaBlog.Router extends Router{")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"line "},[a("span",{staticClass:"ln"},[t._v("2")]),a("span",{staticClass:"code"},[t._v("  ...")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"line "},[a("span",{staticClass:"ln"},[t._v("3")]),a("span",{staticClass:"code"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"line "},[a("span",{staticClass:"ln"},[t._v("233")]),a("span",{staticClass:"code"},[t._v("  def route(path: String): Request => Response = path match {")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"line "},[a("span",{staticClass:"ln"},[t._v("234")]),a("span",{staticClass:"code"},[t._v('    case "/" => Controller.index')])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"line "},[a("span",{staticClass:"ln"},[t._v("235")]),a("span",{staticClass:"code"},[t._v("    ...")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"line "},[a("span",{staticClass:"ln"},[t._v("667")]),a("span",{staticClass:"code"},[t._v("  }")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"line "},[a("span",{staticClass:"ln"},[t._v("668")]),a("span",{staticClass:"code"},[t._v("  def scope(scop: String)(f: Request => Response): Request => Response = {")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"meta"},[a("div",{staticClass:"frame-mfa"},[t._v("\n              RoseliaBlog.Router.route: (path: String): Request => Response\n\n              "),a("a",{staticClass:"docs right blog-text",attrs:{href:"/"}},[t._v("index")]),a("span",{staticClass:"app right"},[t._v("RoseliaBlog")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",[a("button",{staticClass:"stack-trace-item -app -active",attrs:{role:"stack-trace-item","data-index":"0"}},[a("span",{staticClass:"left"},[a("span",{staticClass:"app"},[t._v("RoseliaBlog")]),a("span",{staticClass:"filename"},[t._v("\n                                  lib/roselia_blog/router"),a("span",{staticClass:"line"},[t._v(":666")])])]),a("span",{staticClass:"info"},[t._v("RoseliaBlog.Router.route: (path: String): Request => Response")])])])}],sn={name:"blog-error",data:function(){return{errorCode:"404NotFound",errorTaunt:"Maybe Marisa has stolen something important",title:at.title,motto:at.motto,link:this.$router.resolve({name:"index"}),path:this.$route.fullPath,method:"GET"}}},cn=sn,ln=(a("8cd6"),a("86f9"),Object(N["a"])(cn,on,rn,!1,null,"c4e27986",null)),un=ln.exports,dn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{attrs:{dark:!t.currentColorScheme}},[a("blog-toolbar",{attrs:{userData:t.userData,noDrawer:!0}},[a("v-toolbar-side-icon",{attrs:{dark:""},nativeOn:{click:function(e){t.drawer=!t.drawer}}})],1),a("v-navigation-drawer",{attrs:{fixed:"",clipped:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{attrs:{dense:""}},[t._l(t.items,function(e,n){return[e.heading?a("v-layout",{key:n,attrs:{row:"","align-center":""}},[a("v-flex",{attrs:{xs6:""}},[e.heading?a("v-subheader",[t._v("\n              "+t._s(e.heading)+"\n            ")]):t._e()],1)],1):e.divider?a("v-divider",{key:n,staticClass:"my-3",attrs:{dark:""}}):e.click?a("v-list-tile",{key:n,attrs:{ripple:""},on:{click:e.click}},[a("v-list-tile-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"grey--text"},[t._v("\n              "+t._s(e.text)+"\n            ")])],1)],1):a("v-list-tile",{key:n,attrs:{ripple:"",to:e.to}},[a("v-list-tile-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"grey--text"},[t._v("\n              "+t._s(e.text)+"\n            ")])],1)],1)]})],2)],1),a("v-content",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"justify-center":"","align-center":""}},[a("v-flex",{attrs:{shrink:""}},[a("v-alert",{attrs:{type:t.toast.color,transition:"scale-transition"},model:{value:t.toast.show,callback:function(e){t.$set(t.toast,"show",e)},expression:"toast.show"}},[t._v("\n            "+t._s(t.toast.text)+"\n          ")]),a("v-slide-x-transition",{attrs:{"hide-on-leave":""}},[a("router-view",{attrs:{userData:t.userData,toast:t.showToast}})],1)],1)],1)],1)],1),a("toast",t._b({on:{showChange:t.changeToast}},"toast",t.toast,!1))],1)},hn=[],mn={components:{BlogToolbar:Ma},name:"blog-user-space",data:function(){return{toast:{show:!1,text:"",color:""},drawer:null,removeListener:null}},props:{currentColorScheme:Boolean,userData:Object},computed:{items:function(){return[{icon:"home",text:"Home",to:{name:"console-index"}},{divider:!0},{heading:"Articles"},{icon:"add_circle",text:"Write a new post",to:{name:"edit"},cond:this.userData.role},{icon:"archive",text:"Manage Drafts",to:{name:"manageDrafts",cond:this.userData.role}},{icon:"list_alt",text:"My Timeline",to:{name:"userTimeline",params:{username:this.userData.username}}},{divider:!0},{heading:"My Account"},{icon:"account_box",text:"Account Settings",to:{name:"setNickname"}},{icon:"account_circle",text:"OAuth Accounts",to:{name:"oauthAccounts"}},{icon:"security",text:"Two Step Auth",to:{name:"twoStepAuth"}},{divider:!0},{heading:"Management"},{icon:"lock",text:"Change Password",to:{name:"changePassword"}},{icon:"people",text:"Manage User",to:{name:"userManagement"},cond:this.userData.role},{icon:"computer",text:"System Monitor",to:{name:"systemMonitor"},cond:this.userData.role>1},{divider:!0},{heading:"My Session"},{icon:"refresh",text:"Token Refresh",to:{name:"tokenRefresh"},cond:this.userData.rftoken},{icon:"verified_user",text:"Remote Login",to:{name:"remoteLogin"}},{divider:!0},{icon:"exit_to_app",text:"Log Out",to:{name:"login",params:{logout:!0}}}].filter(function(t){return!t.hasOwnProperty("cond")||t.cond})}},methods:{showToast:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.toast=this.toast||{},this.toast.show=!1,this.toast.text=t.toString(),this.toast.color=e,this.toast.show=!0},changeToast:function(t){this.toast.show=t},ensureLoggedIn:function(){this.userData||this.$router.push({name:"login",params:{logout:!0,message:"Login to manage",alert:{color:"warning",text:"Please login first"},redirect:this.$route.fullPath}})},removeAllDraft:function(){var t=window.localStorage;oe()(Array(t.length).keys()).map(t.key.bind(t)).filter(function(t){return t.startsWith("postDraft")}).forEach(function(e){t.removeItem(e)}),this.showToast("Draft Cleaned!")}},mounted:function(){this.ensureLoggedIn()},destroyed:function(){ht.removeSUToken(),this.removeListener&&this.removeListener()},watch:{userData:function(){this.ensureLoggedIn()}}},fn=mn,vn=a("e0c7"),pn=Object(N["a"])(fn,dn,hn,!1,null,"620f8184",null),gn=pn.exports;B()(pn,{VAlert:Wt["a"],VApp:q["a"],VContainer:pt["a"],VContent:J["a"],VDivider:gt["a"],VFlex:bt["a"],VIcon:Et["a"],VLayout:yt["a"],VList:ja["a"],VListTile:Aa["a"],VListTileAction:Fa["a"],VListTileContent:Ua["a"],VListTileTitle:Ua["b"],VNavigationDrawer:Ia["a"],VSlideXTransition:W["e"],VSubheader:vn["a"],VToolbarSideIcon:Ra["a"]});var bn=a("7876"),yn=a.n(bn),wn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-action",[a("h2",{staticClass:"flex text--secondary"},[t._v("Change Password for "+t._s(t.userData.username))]),a("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{name:"oldPassword",label:"Old Password",type:"password",autofocus:"",rules:t.rules},model:{value:t.oldPassword,callback:function(e){t.oldPassword=e},expression:"oldPassword"}}),a("v-text-field",{attrs:{name:"newPassword",label:"New Password",type:"password",rules:t.rules},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),a("v-text-field",{attrs:{name:"repeatPassword",label:"Repeat Password",type:"password",rules:t.repeatRules},model:{value:t.repeatPassword,callback:function(e){t.repeatPassword=e},expression:"repeatPassword"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"warning",loading:t.loading,disabled:!t.valid},on:{click:t.changePassword}},[t._v("Change")])],1)],1)},kn=[],_n=[function(t){return!!t||"Required"},function(t){return t&&t.length>4&&t.length<20||"Length is not valid"}],xn={name:"change-password",props:["userData","toast"],data:function(){var t=this;return{loading:!1,oldPassword:"",newPassword:"",repeatPassword:"",valid:!1,rules:_n,repeatRules:_n.concat([function(e){return e===t.newPassword||"Repeat password should equal to new password"}])}},methods:{changePassword:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","change"),"POST",{username:this.userData.username,oldPassword:this.oldPassword,newPassword:this.newPassword},!1).then(function(e){t.toast("Success!","success"),t.$router.go(-1)}).catch(function(e){t.toast(e,"error")}).finally(function(e){t.loading=!1}))}}},Dn=xn,Cn=Object(N["a"])(Dn,wn,kn,!1,null,"d19c8c56",null),Tn=Cn.exports;B()(Cn,{VBtn:vt["a"],VCardActions:Ot["a"],VForm:Ht["a"],VSpacer:Ut["a"],VTextField:zt["a"]});var Sn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-action",[a("h2",{staticClass:"flex text--secondary"},[t._v("Remote Login")]),a("v-form",{ref:"form",on:{submit:function(t){t.preventDefault()}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{name:"loginCode",label:"Login Code",type:"number",autofocus:"",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.scanCode(e)}},model:{value:t.loginCode,callback:function(e){t.loginCode=e},expression:"loginCode"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.scanCode}},[t._v("Login")])],1),a("v-dialog",{attrs:{persistent:"","max-width":"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v("Remote Login")]),a("v-card-text",[t._v("Will login at "+t._s(t.loginMeta.os)+" "+t._s(t.loginMeta.browser)+" device on "+t._s(t.loginMeta.ip))]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"error",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("Nope")]),a("v-btn",{attrs:{color:"info",flat:""},on:{click:t.confirmCode}},[t._v("OK")])],1)],1)],1)],1)},Pn=[],Ln={name:"remote-login",props:["userData","toast"],data:function(){return{loginCode:"",valid:!1,loading:!1,rules:[function(t){return!!t||"Required"},function(t){return[].every.call(t,function(t){return!isNaN(c()(t))})||"Code should be digits"},function(t){return t&&6===t.length||"Length should be 6"}],dialog:!1,loginMeta:{os:"",browser:"",ip:""}}},methods:{scanCode:function(){var t=this;this.$refs.form.validate()&&(this.loading=!0,ht.fetchJSON(ht.apiFor("login","code","scan",this.loginCode),"POST").then(function(e){if(!e.success)return t.toast(e.msg,"error"),void(t.loading=!1);t.loginMeta=e.msg,t.dialog=!0,t.loading=!1}).catch(function(e){t.loading=!1,t.toast("Network error.","error")}))},confirmCode:function(){var t=this;this.loading=!0,ht.fetchJSON(ht.apiFor("login","code","confirm",this.loginCode),"POST").then(function(e){e.success||t.toast(e.msg,"error"),t.toast("I assume that you are teleported to another device","success"),t.dialog=!1,ht.redirectTo({name:"userspace"})}).catch(function(e){t.toast("Network error","error")})}},watch:{dialog:function(t){t||(this.loading=!1)}}},On=Ln,Vn=Object(N["a"])(On,Sn,Pn,!1,null,"7289c896",null),$n=Vn.exports;B()(Vn,{VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardText:Ot["b"],VCardTitle:Vt["a"],VDialog:Ue["a"],VForm:Ht["a"],VSpacer:Ut["a"],VTextField:zt["a"]});var En=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-btn",{attrs:{flat:""},nativeOn:{click:function(e){t.addUser.form=!0}}},[a("v-icon",[t._v("person_add")])],1),a("v-data-table",{staticClass:"elevation-1",attrs:{items:t.userList,loading:t.loading,headers:t.headers},scopedSlots:t._u([{key:"items",fn:function(e){return[a("td",[t._v(t._s(e.item.username))]),a("td",{staticClass:"text-xs-right"},[a("v-btn",{attrs:{flat:"",icon:"",small:"",disabled:e.item.role<=0},on:{click:function(a){return t.shiftRole(e.item,-1)}}},[t._v("-")]),t._v("\n        "+t._s(e.item.role)+"\n        "),a("v-btn",{attrs:{flat:"",icon:"",small:"",disabled:e.item.role+1>=t.userData.role},on:{click:function(a){return t.shiftRole(e.item,1)}}},[t._v("+")])],1),a("td",{staticClass:"text-xs-right"},[a("v-btn",{attrs:{icon:"",flat:"",color:"secondary"},on:{click:function(a){return t.setPasswordForm(e.item.username)}}},[a("v-icon",[t._v("edit")])],1),a("v-btn",{attrs:{icon:"",flat:"",color:"error"},on:{click:function(a){return t.deleteUserForm(e.item.username)}}},[a("v-icon",[t._v("delete")])],1)],1)]}},{key:"no-data",fn:function(){return[a("div",[t._v("I am sorry to announce that you can manage nobody. :(")])]},proxy:!0}])},[a("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1),a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.addUser.form,callback:function(e){t.$set(t.addUser,"form",e)},expression:"addUser.form"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Add User")])]),a("v-card-text",[a("v-form",{model:{value:t.addUser.valid,callback:function(e){t.$set(t.addUser,"valid",e)},expression:"addUser.valid"}},[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{rules:t.addUser.rules,label:"Username",required:""},model:{value:t.addUser.username,callback:function(e){t.$set(t.addUser,"username",e)},expression:"addUser.username"}})],1),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{rules:t.addUser.rules,label:"Password",type:"password",required:""},model:{value:t.addUser.password,callback:function(e){t.$set(t.addUser,"password",e)},expression:"addUser.password"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-select",{attrs:{items:t.addUser.items,label:"Permission Level",required:""},model:{value:t.addUser.role,callback:function(e){t.$set(t.addUser,"role",e)},expression:"addUser.role"}})],1)],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.addUser.form=!1}}},[t._v("Close")]),a("v-btn",{attrs:{color:"blue darken-1",flat:"",disabled:!t.addUser.valid,loading:t.loading},on:{click:t.doAddUser}},[t._v("Add")])],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.loginForm,callback:function(e){t.loginForm=e},expression:"loginForm"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Enter Password")])]),a("v-card-text",[a("h4",[t._v("For your safety, please input your password.")]),a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Password",type:"password",required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getSUToken(e)}},model:{value:t.loginPassword,callback:function(e){t.loginPassword=e},expression:"loginPassword"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",flat:""},on:{click:t.leave}},[t._v("Close")]),a("v-btn",{attrs:{color:"info",flat:""},on:{click:t.getSUToken}},[t._v("OK")])],1)],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.setPassword.form,callback:function(e){t.$set(t.setPassword,"form",e)},expression:"setPassword.form"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Set Password of "+t._s(t.setPassword.username))])]),a("v-card-text",[a("v-form",{on:{submit:function(t){t.preventDefault()}},model:{value:t.setPassword.valid,callback:function(e){t.$set(t.setPassword,"valid",e)},expression:"setPassword.valid"}},[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{rules:t.addUser.rules,label:"Password",type:"password",required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSetPassword(e)}},model:{value:t.setPassword.password,callback:function(e){t.$set(t.setPassword,"password",e)},expression:"setPassword.password"}})],1)],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.setPassword.form=!1}}},[t._v("Close")]),a("v-btn",{attrs:{color:"blue darken-1",flat:"",disabled:!t.setPassword.valid,loading:t.loading},on:{click:t.doSetPassword}},[t._v("Set")])],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.deleteUser.form,callback:function(e){t.$set(t.deleteUser,"form",e)},expression:"deleteUser.form"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline error--text"},[t._v("Delete "+t._s(t.deleteUser.username))])]),a("v-card-text",[a("span",[t._v("Please make sure by retyping username")]),a("v-form",{on:{submit:function(t){t.preventDefault()}},model:{value:t.deleteUser.valid,callback:function(e){t.$set(t.deleteUser,"valid",e)},expression:"deleteUser.valid"}},[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{rules:t.deleteUser.rules,label:"Retype Username",required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doDeleteUser(e)}},model:{value:t.deleteUser.typedUsername,callback:function(e){t.$set(t.deleteUser,"typedUsername",e)},expression:"deleteUser.typedUsername"}})],1)],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteUser.form=!1}}},[t._v("Close")]),a("v-btn",{attrs:{color:"error",flat:"",disabled:!t.deleteUser.valid,loading:t.loading},on:{click:t.doDeleteUser}},[t._v("Delete")])],1)],1)],1)],1)},jn=[],An={name:"user-management",props:["userData","toast"],data:function(){var t=this;return{suToken:"",loading:!1,userList:[],headers:[{text:"Username",align:"left",sortable:!0,value:"username"},{text:"Role Level",value:"role"},{text:"Action"}],loginForm:!1,addUser:{form:!1,username:"",password:"",role:0,items:oe()(Array(this.userData.role).keys()).map(function(t,e){return{text:"Level ".concat(e),value:e}}),rules:[function(t){return!!t||"Required"},function(t){return t&&t.length>4&&t.length<20||"Length is not valid"}],valid:!1},setPassword:{form:!1,valid:!1,username:"",password:""},deleteUser:{form:!1,valid:!1,username:"",typedUsername:"",rules:[function(e){return e&&e.toLowerCase()===t.deleteUser.username.toLowerCase()||"Username should be same to target user"}]},loginPassword:""}},methods:{leave:function(){this.$router.go(-1)},getSUToken:function(){var t=this;this.loading=!0,ht.fetchJSON(ht.apiFor("user","su"),"POST",{password:this.loginPassword}).then(function(e){if(t.loading=!1,!e.success)return t.toast("Wrong Password","error"),void(t.loginPassword="");t.loginForm=!1,t.suToken=e.token,ht.saveSUToken(e.token),t.loadUser()})},loadUser:function(){var t=this;this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","list")).then(function(e){t.loading=!1,t.userList=e}).catch(function(e){t.toast(e,"error"),t.leave()})},doAddUser:function(){var t=this;this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","add"),"POST",{username:this.addUser.username,password:this.addUser.password,role:this.addUser.role,token:this.suToken},!1).then(function(e){t.addUser.form=!1,t.addUser.username="",t.addUser.password="",t.loadUser()}).catch(function(e){t.toast(e,"error")}).finally(function(e){t.loading=!1})},setPasswordForm:function(t){this.setPassword.username=t,this.setPassword.form=!0},doSetPassword:function(){var t=this;this.setPassword.valid&&(this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","change"),"POST",{username:this.setPassword.username,newPassword:this.setPassword.password,token:this.suToken},!1).then(function(e){t.toast("Why must you change the password?","success"),t.setPassword.form=!1}).catch(function(e){t.toast(e,"error")}).finally(function(e){t.loading=!1}))},deleteUserForm:function(t){this.deleteUser.username=t,this.deleteUser.form=!0},doDeleteUser:function(){var t=this;this.deleteUser.valid&&(this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","remove"),"POST",{username:this.deleteUser.username,token:this.suToken},!1).then(function(e){t.toast("Success!","success"),t.deleteUser.form=!1,t.loadUser()}).catch(function(e){t.toast(e,"error")}).finally(function(e){t.loading=!1}))},shiftRole:function(t,e){var a=this,n=t.role+e;this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","change-role"),"POST",{username:t.username,role:n,token:this.suToken},!1,!1).then(function(){t.role=n,a.loading=!1,a.toast("It feels good to change privileges, right?","success")}).catch(function(t){a.loading=!1,a.toast("There must be something wrong","error")})}},mounted:function(){var t=ht.getSUToken();if(!this.userData.role)return this.toast("You are not supposed to do this.","warning"),this.leave();this.suToken=t,t?this.loadUser():this.loginForm=!0,this.$route.params.firstRun&&(this.addUser.form=!0)},watch:{"setPassword.form":function(){this.setPassword.password=""},"deleteUser.form":function(){this.deleteUser.password=""}}},Fn=An,Un=a("8fea"),In=a("b56d"),Rn=Object(N["a"])(Fn,En,jn,!1,null,"5206f214",null),Nn=Rn.exports;B()(Rn,{VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardText:Ot["b"],VCardTitle:Vt["a"],VContainer:pt["a"],VDataTable:Un["a"],VDialog:Ue["a"],VFlex:bt["a"],VForm:Ht["a"],VIcon:Et["a"],VLayout:yt["a"],VProgressLinear:Yt["a"],VSelect:In["a"],VSpacer:Ut["a"],VTextField:zt["a"]});var Mn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-action",[a("h1",{staticClass:"primary--text display-1"},[t._v("Well met, "+t._s(t.userData.nickname)+"("+t._s(t.userData.username)+")!")]),a("p",[t._v("There are "+t._s(t.posts)+" posts from your perspective.")]),a("p",[t._v("Take it easy casuse I will NOT break your legs in this page.")])])},Bn=[],qn={name:"ConsoleIndex",props:["userData","toast"],data:function(){return{posts:"Loading..."}},methods:{loadPostCount:function(){var t=this;ht.fetchJSON(ht.apiFor("posts"),"GET",{limit:1}).then(function(e){t.posts=e.total})}},mounted:function(){this.loadPostCount()}},Jn=qn,Wn=Object(N["a"])(Jn,Mn,Bn,!1,null,null,null),Hn=Wn.exports,Yn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:""}},[t.isTokenExpired?a("div",[a("h1",[t._v("Your token has expired")])]):a("div",[a("h1",[t._v("Your token will be expired @")]),a("v-time-picker",{attrs:{landscape:"",readonly:"",format:"24h"},model:{value:t.tokenExpiryTime,callback:function(e){t.tokenExpiryTime=e},expression:"tokenExpiryTime"}})],1),t.userData.rftoken?a("div",[t.isRefreshTokenExpired?a("div",[a("h1",[t._v("Your refresh token has expired")]),a("v-btn",{attrs:{to:{name:"login",params:{logout:!0}},color:"warning"}},[a("v-icon",[t._v("exit_to_app")]),t._v("Re-Login\n        ")],1)],1):a("div",[a("h1",[t._v("Your refresh token will be expired @")]),a("v-flex",{attrs:{md12:"",lg12:""}},[a("v-date-picker",{attrs:{readonly:"",color:"accent","header-color":"primary"},model:{value:t.rfTokenExpiryDate,callback:function(e){t.rfTokenExpiryDate=e},expression:"rfTokenExpiryDate"}}),a("v-time-picker",{attrs:{readonly:"",color:"primary",format:"24h"},model:{value:t.rfTokenExpiryTime,callback:function(e){t.rfTokenExpiryTime=e},expression:"rfTokenExpiryTime"}})],1),a("v-btn",{attrs:{color:"primary"},on:{click:t.refreshToken}},[a("v-icon",[t._v("refresh")]),t._v("Refresh\n        ")],1)],1)]):t._e()])],1)},zn=[],Gn={props:["userData","toast"],data:function(){return{get loginToken(){return ht.getLoginData().token},set loginToken(t){return 0},get rfToken(){return ht.getLoginData().rftoken}}},computed:{tokenExpiryTime:function(){return this.getTimeOf(this.tokenExpiryDatetime)},tokenExpiryDatetime:function(){return ht.getTokenExpiryTime(this.loginToken)},rfTokenExpiryDatetime:function(){return ht.getTokenExpiryTime(this.rfToken)},rfTokenExpiryDate:function(){var t=this.rfTokenExpiryDatetime;return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate())},rfTokenExpiryTime:function(){var t=this.rfTokenExpiryDatetime;return this.getTimeOf(t)},isRefreshTokenExpired:function(){return this.rfTokenExpiryDatetime<new Date},isTokenExpired:function(){return this.tokenExpiryDatetime<new Date}},methods:{makeRedirect:function(t){ht.setRedirect(this.$route.fullPath),ht.redirectTo(t)},refreshToken:function(){var t=this;ht.refreshToken().then(function(e){t.toast("+1h O..O","success"),++t.loginToken}).catch(function(e){t.toast(e,"error"),t.makeRedirect({name:"login"})})},getTimeOf:function(t){return"".concat(t.getHours(),":").concat(t.getMinutes())}}},Kn=Gn,Xn=a("2e4b"),Zn=a("c964"),Qn=Object(N["a"])(Kn,Yn,zn,!1,null,null,null),to=Qn.exports;B()(Qn,{VBtn:vt["a"],VDatePicker:Xn["a"],VFlex:bt["a"],VIcon:Et["a"],VLayout:yt["a"],VTimePicker:Zn["a"]});var eo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar",{attrs:{userData:t.userData,route:this.$route.fullPath}}),a("div",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:t.realWindowTitle,expression:"realWindowTitle"}]}),a("v-parallax",{attrs:{dark:"",src:t.bannerImage}},[a("v-layout",{attrs:{"align-center":"",column:"","justify-center":""}},[t.userInfo.avatar?a("div",[a("v-avatar",{staticClass:"elevation-7",attrs:{size:"128px"}},[a("v-img",{attrs:{src:t.userInfo.avatar,alt:t.userInfo.username}})],1),a("br"),a("br")],1):t._e(),a("h1",{staticClass:"display-2 font-weight-regular mb-3"},[t._v(t._s(t.realTitle))]),t.userFound?a("h2",{staticClass:"subheading"},[t._v("\n        "+t._s(t.mottoText)+"\n      ")]):a("h2",{staticClass:"subheading"},[t._v("\n        This guy is a mystery.\n      ")])])],1),a("v-container",[a("v-card-text",{staticClass:"py-0"},[a("v-timeline",{attrs:{"align-top":"",dense:t.$vuetify.breakpoint.smAndDown}},[a("v-slide-x-transition",{attrs:{group:""}},t._l(t.postData,function(e){return a("v-timeline-item",{key:e.id,attrs:{"fill-dot":"",color:"accent"}},[!t.userInfo.username&&e.author&&e.author.avatar?a("v-avatar",{attrs:{slot:"icon"},slot:"icon"},[a("v-img",{attrs:{src:e.author.avatar}})],1):t._e(),a("span",{staticClass:"headline font-weight-bold",attrs:{slot:"opposite"},slot:"opposite"},[a("h4",[t._v(t._s(e.datetime.toLocaleDateString()))]),t.userInfo.username?t._e():a("h3",{staticClass:"secondary-text"},[t._v(t._s(e.author&&e.author.nickname))]),t._l(e.tags,function(e){return a("router-link",{key:e,attrs:{to:{name:"index",params:{tag:e},query:{tag:e}}}},[a("v-chip",[t._v(t._s(e))])],1)}),e.secret?a("v-chip",{attrs:{color:"success","text-color":"white"}},[a("v-avatar",[a("v-icon",[t._v("lock")]),t._v(t._s(e.secret)+"\n              ")],1),t._v("\n              Secret\n            ")],1):t._e()],2),a("div",{staticClass:"py-3",class:{scale:e.clicked,"scale-finished":1===e.clicked,"scale-back":-1===e.clicked}},[a("v-card",{attrs:{dark:"",color:"primary"}},[a("v-card-title",{staticClass:"title"},[t._v(t._s(e.title))]),a("v-card-text",[a("p",[t._v(t._s(e.subtitle))]),a("v-btn",{staticClass:"mx-0",attrs:{outline:"",round:"",color:"secondary"},on:{click:function(a){return t.manuallyLoadPost(e)}}},[a("v-icon",[t._v("unfold_more")])],1)],1)],1)],1)],1)}),1)],1),a("v-layout",{attrs:{"align-center":"",column:"","justify-center":""}},[a("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.loadNextPage,expression:"loadNextPage"}]},[t.currentPage<t.totalPages?a("div",[a("v-btn",{attrs:{loading:t.loading,small:"",block:"",color:"secondary",dark:""},on:{click:t.loadNextPage}},[a("v-icon",[t._v("keyboard_arrow_down")])],1)],1):t.loading?a("div",[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):t.postData.length?a("div",[a("v-divider"),t._v("\n            Tiro Finale\n          ")],1):t._e()])])],1)],1),a("blog-footer")],1)},ao=[],no=(a("7514"),{data:function(){return{currentPage:1,totalPages:1,postData:[],loading:!1,hasLeft:!1,fromPost:0,userInfo:{username:"",avatar:"",nickname:"",banner:"",motto:""},userFound:!0}},props:{userData:Object},methods:{getPostData:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t=t||this.currentPage;var n={page:t,limit:6};this.loading=!0,ht.fetchJSON(this.userInfo.username?ht.apiFor("post","user",this.userInfo.username):ht.apiFor("posts"),"GET",n).then(function(t){var n=t.data.map(D).map(function(t){return Object(f["a"])({},t,{datetime:new Date(t.created),clicked:!1})});if(e.postData=a?e.postData.concat(n):n,e.totalPages=c()(t.pages),e.fromPost){var o=e.findPostBy(e.fromPost);o&&(o.clicked=-1,e.fromPost=0,setTimeout(function(){o.clicked=!1},1e3))}e.loading=!1}).catch(function(t){console.error(t),e.loading=!1})},manuallyLoadPost:function(t){var e=this;t.clicked=!0,ht.fetchJSON(ht.apiFor("post",t.id)).then(function(a){if(!a)return ot.a.reject(ReferenceError("NPE"));var n=D(a);t.clicked=1,e.$router.push({name:"post",params:{changeRoute:!!t.displayId,data:n},query:{p:t.id}})}).catch(function(a){t.clicked=1,e.$router.push({name:"post",query:{p:t.id}})})},loadNextPage:function(){this.currentPage>=this.totalPages||this.getPostData(++this.currentPage)},findPostBy:function(t){return this.postData.find(function(e){return e.id==t||e.displayId===t})},getUserMeta:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("user","user-meta"),"GET",{username:this.userInfo.username}).then(function(e){t.userInfo=D(e)}).catch(function(e){t.userFound=!1,t.userInfo.nickname="John Appleseed"})}},mounted:function(){this.$route.params.username&&(this.userInfo.username=this.userInfo.nickname=this.$route.params.username,this.getUserMeta()),this.getPostData(1,!1)},watch:{userData:function(){this.currentPage=1,this.totalPages=1,this.getPostData(1,!1)}},computed:{realTitle:function(){return this.userInfo.nickname||this.userInfo.username||this.$route.meta.title},bannerImage:function(){return this.userInfo&&this.userInfo.banner||this.config.images.timelineBannerImage},mottoText:function(){return this.userInfo.motto||"The fate of a person, of course, depends on self-strengthening, but also on the journey of the history."},realWindowTitle:function(){return this.userInfo.username?"".concat(this.userInfo.nickname,"'s Timeline"):this.$route.meta.title}},beforeRouteEnter:function(t,e,a){a(function(t){t.fromPost=e.query.p||e.params.postLink})}}),oo=no,ro=(a("8d3a"),Object(N["a"])(oo,eo,ao,!1,null,"7a20c271",null)),io=ro.exports;B()(ro,{VAvatar:Pt["a"],VBtn:vt["a"],VCard:Lt["a"],VCardText:Ot["b"],VCardTitle:Vt["a"],VChip:$t["a"],VContainer:pt["a"],VDivider:gt["a"],VIcon:Et["a"],VImg:jt["a"],VLayout:yt["a"],VParallax:Ft["a"],VProgressCircular:wt["a"],VSlideXTransition:W["e"],VTimeline:ua["a"],VTimelineItem:da["a"]});var so=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("div",[a("h2",{staticClass:"flex text--secondary"},[t._v("Nickname")]),a("v-form",{ref:"form",on:{submit:function(t){t.preventDefault()}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{name:"nickname",label:"Nickname",type:"text",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeNickname(e)}},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.changeNickname}},[a("v-icon",[t._v("check")])],1)],1)],1),a("div",[a("h2",{staticClass:"flex text--secondary"},[t._v("Motto")]),a("v-form",{on:{submit:function(t){t.preventDefault()}}},[a("v-text-field",{attrs:{name:"motto",label:"Motto",type:"text",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeMotto(e)}},model:{value:t.motto,callback:function(e){t.motto=e},expression:"motto"}})],1),a("v-card-actions",[a("v-spacer"),t.motto?a("v-btn",{attrs:{color:"primary",loading:t.loading},on:{click:t.changeMotto}},[a("v-icon",[t._v("check")])],1):a("v-btn",{attrs:{color:"error",loading:t.loading},on:{click:t.changeMotto}},[a("v-icon",[t._v("remove_circle")])],1)],1)],1),a("div",[a("h2",{staticClass:"flex text--secondary"},[t._v("Avatar")]),a("v-form",{ref:"formA",on:{submit:function(t){t.preventDefault()}},model:{value:t.avatarValid,callback:function(e){t.avatarValid=e},expression:"avatarValid"}},[a("v-text-field",{attrs:{name:"avatar",label:"Avatar Image URL",type:"text",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeAvatar(!1)}},model:{value:t.avatar,callback:function(e){t.avatar=e},expression:"avatar"}})],1),a("v-card-actions",[t.avatar?a("div",[a("v-avatar",{staticClass:"elevation-7",attrs:{size:"64px"}},[a("img",{attrs:{src:t.avatar},on:{load:function(e){t.avatarValid=!0}}})]),a("br"),a("br")],1):a("v-btn",{attrs:{color:"error",loading:t.loading},on:{click:function(e){return t.changeAvatar(!0)}}},[a("v-icon",[t._v("remove_circle")])],1),a("v-spacer"),a("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.avatar||!t.avatarValid},on:{click:t.changeAvatar}},[a("v-icon",[t._v("check")])],1)],1)],1),a("div",[a("h2",{staticClass:"flex text--secondary"},[t._v("Banner Image")]),a("v-form",[a("v-text-field",{attrs:{name:"banner",label:"Banner Image URL",type:"text",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeBanner(!1)}},model:{value:t.banner,callback:function(e){t.banner=e},expression:"banner"}})],1),a("div",[t.banner?a("v-img",{attrs:{src:t.banner},on:{load:function(e){t.bannerValid=!0}}}):a("v-btn",{attrs:{color:"error",loading:t.loading},on:{click:function(e){return t.changeBanner(!0)}}},[a("v-icon",[t._v("remove_circle")])],1),a("v-spacer"),a("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.banner||!t.bannerValid},on:{click:t.changeBanner}},[a("v-icon",[t._v("check")])],1)],1)],1)])},co=[],lo={name:"remote-login",props:["userData","toast"],data:function(){return{nickname:"",avatar:"",banner:"",motto:"",loading:!1,rules:[function(t){return!!t||"Required"}],valid:!1,avatarValid:!1,bannerValid:!1}},methods:{performChangeUserMeta:function(t,e){var a=this;return this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","change-meta"),"POST",{changes:Object(m["a"])({},t,e)}).then(function(t){return a.loading=!1,t}).catch(function(t){return a.loading=!1,ot.a.reject(t)})},changeNickname:function(){var t=this;if(this.valid)return this.loading=!0,this.changeInfo("nickname",this.nickname).then(function(e){t.userData.nickname=t.nickname,ht.updateLoginData(function(e){return Object(f["a"])({},e,{nickname:t.nickname})}),t.nickname=""})},changeMotto:function(){return this.changeInfo("motto",this.motto)},changeAvatar:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||this.avatarValid&&this.avatar)return this.changeInfo("avatar",this.avatar).then(function(e){t.avatar=""})},changeBanner:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||this.bannerValid&&this.banner)return this.changeInfo("banner",this.banner).then(function(e){t.banner=""})},changeInfo:function(t,e){var a=this;return this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","change-meta"),"POST",{changes:Object(m["a"])({},t,e)}).then(function(e){return a.toast("Your ".concat(t," has changed!"),"success"),a.loading=!1,e}).catch(function(t){return a.loading=!1,a.toast("Emmm... Something is strange","error"),ot.a.reject(t)})},getUserMeta:function(){var t=this;this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("user","user-meta"),"GET",{username:this.userData.username}).then(function(e){t.loading=!1,t.nickname=e.nickname,t.avatar=e.avatar,t.banner=e.banner||"",t.motto=e.motto||""}).catch(function(e){t.loading=!1,t.toast(e,"error")})}},watch:{avatar:function(){this.avatarValid=!1},banner:function(){this.bannerValid=!1}},mounted:function(){this.getUserMeta()}},uo=lo,ho=Object(N["a"])(uo,so,co,!1,null,"130b2f96",null),mo=ho.exports;B()(ho,{VAvatar:Pt["a"],VBtn:vt["a"],VCardActions:Ot["a"],VContainer:pt["a"],VForm:Ht["a"],VIcon:Et["a"],VImg:jt["a"],VSpacer:Ut["a"],VTextField:zt["a"]});var fo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("h2",[t._v("OAuth Accounts")])]),a("v-card-actions",t._l(t.adapterList,function(e){var n=e.adapter,o=e.isBound,r=e.bindUser;return a("v-flex",{key:n},[o?a("div",[t.$vuetify.icons.brand[n]?a("v-icon",[t._v(t._s(t.$vuetify.icons.brand[n]))]):a("span",[t._v(t._s(n))]),t._v("\n          :\n          "),a("span",[t._v(t._s(r))]),a("v-btn",{attrs:{icon:"",small:"",flat:"",color:"error"},on:{click:function(e){return t.removeAdapter(n)}}},[a("v-icon",[t._v("clear")])],1)],1):a("v-btn",{attrs:{round:"",color:"accent",dark:"",loading:t.loading},on:{click:function(e){return t.goToBind(n)}}},[t.$vuetify.icons.brand[n]?a("v-icon",[t._v(t._s(t.$vuetify.icons.brand[n]))]):a("span",[t._v(t._s(n))])],1)],1)}),1)],1)],1)},vo=[],po=a("db0c"),go=a.n(po),bo={props:["userData","toast"],data:function(){return{loading:!1,adapters:[],myAdapters:[]}},methods:{getAdapters:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("login","oauth","adapters")).then(function(e){t.adapters=e}).catch(function(e){t.toast(e,"error")})},getMyAdapters:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("oauth","list-bind-adapters")).then(function(e){t.myAdapters=e}).catch(function(e){t.toast(e,"error")})},mergeAvailableAdapters:function(){var t=k(this.adapters.map(function(t){return[t,{adapter:t,isBound:!1,bindUser:null}]}));return this.myAdapters.forEach(function(e){var a=e.adapter,n=e.user;t[a]&&(t[a]=Object(f["a"])({},t[a],{isBound:!0,bindUser:n}))}),go()(t)},goToBind:function(t){var e=this;this.loading=!0,ht.fetchJSONWithSuccess(ht.apiFor("oauth","bind",t,"url")).then(function(a){e.toast("We are now going to ".concat(t,"..."),"info"),location.href=a}).catch(function(t){e.loading=!1,e.toast("Oops! Failed.","error")})},removeAdapter:function(t){var e=this;ht.fetchJSONWithSuccess(ht.apiFor("oauth","remove-adapter",t),"POST").then(function(){e.myAdapters=e.myAdapters.filter(function(e){return e.adapter!==t}),e.toast("Account Removed","success")}).catch(function(t){e.toast("Something is strange","error")})}},computed:{adapterList:function(){return this.mergeAvailableAdapters()}},mounted:function(){if(this.getAdapters(),this.getMyAdapters(),this.$route.query.succeed||this.$route.query.error){var t=this.$route.query,e=t.succeed,a=t.error;this.$router.replace(Object(f["a"])({},this.$route,{query:Object(f["a"])({},this.$route.query,{succeed:void 0,error:void 0}),params:Object(f["a"])({},this.$route.params,{succeed:e,error:a})}))}if(this.$route.params.succeed||this.$route.params.error){var n=this.$route.params,o=n.succeed,r=n.error;o?this.toast("Bind succeed: "+o,"success"):this.toast("Bind error: "+r,"error")}}},yo=bo,wo=Object(N["a"])(yo,fo,vo,!1,null,null,null),ko=wo.exports;B()(wo,{VBtn:vt["a"],VCardActions:Ot["a"],VContainer:pt["a"],VFlex:bt["a"],VIcon:Et["a"],VLayout:yt["a"]});var _o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-action",[a("h2",{staticClass:"flex text--secondary"},[t._v("Two Step Auth")]),t.enabled?a("div",[a("h3",[t._v("You have enabled two step auth!")]),t.totpCode?a("div",[a("v-alert",{attrs:{type:"warning",value:!0}},[t._v("\n        Please make sure to keep this because it will display only once.\n      ")]),a("h4",[t._v("Account: "+t._s(t.userData.username))]),a("h4",[t._v("Code: "+t._s(t.totpCode))]),a("p",[a("v-btn",{attrs:{small:"",round:"",href:t.totpUri,color:"primary"}},[t._v("Bind Now")]),a("v-btn",{attrs:{small:"",round:"",color:"primary"},on:{click:t.downloadAuthFile}},[t._v("Save")])],1),a("vue-qrcode",{attrs:{value:t.totpUri}})],1):t._e(),a("v-btn",{attrs:{color:"warning"},on:{click:t.handleDelete}},[t._v("Disable")])],1):a("div",[a("h3",[t._v("Two step auth is disabled")]),a("v-btn",{on:{click:t.enableTwoStepAuth}},[t._v("Enable")])],1),a("v-card-actions",[a("v-spacer")],1),a("v-dialog",{attrs:{persistent:"","max-width":"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v("You need to confirm by typing code.")]),a("v-container",[a("v-form",{ref:"form",on:{submit:function(t){t.preventDefault()}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{name:"loginCode",label:"Auth Code",type:"number",autofocus:"",rules:t.rules},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.removeTwoStepAuth(e)}},model:{value:t.authCode,callback:function(e){t.authCode=e},expression:"authCode"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"error",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("Nope")]),a("v-btn",{attrs:{color:"info",flat:""},on:{click:t.removeTwoStepAuth}},[t._v("OK")])],1)],1)],1)],1)},xo=[],Do=a("d56f"),Co={components:{VueQrcode:Do["a"]},props:["userData","toast"],data:function(){return{enabled:!1,dialog:!1,totpCode:"",totpUri:"",authCode:"",nextCode:""}},methods:{enableTwoStepAuth:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("user","two-step-auth","bind"),"POST",{}).then(function(e){t.totpUri=e.url,t.totpCode=e.code,t.nextCode=e.nextCode,t.enabled=!0}).catch(function(e){t.toast("Oops, try again.","error")})},checkTwoStepAuth:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("user","user-meta"),"GET",{username:this.userData.username}).then(function(e){t.enabled=e.totp}).catch(function(e){t.toast("Oops!","error")})},removeTwoStepAuth:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("user","two-step-auth","remove"),"POST",{code:this.nextCode||this.authCode}).then(function(e){t.toast("Great! You are unsafe now!","success"),t.enabled=!1,t.dialog=!1}).catch(function(e){if(t.nextCode)return t.nextCode="",void(t.dialog=!0);t.toast("Somehow your code is wrong.","error")})},handleDelete:function(){if(this.nextCode)return this.removeTwoStepAuth();this.dialog=!0},downloadAuthFile:function(){var t="\n      Account: ".concat(this.userData.username,"\n      Key: ").concat(this.totpCode,",\n      BindURL: ").concat(this.totpUri,"\n      ").split("\n").map(function(t){return t.trim()}).join("\n"),e=new Blob([t]),a=URL.createObjectURL(e),n=document.createElement("a");n.download="".concat(this.userData.username," - Roselia Blog.txt"),n.href=a,n.click(),setTimeout(function(){return URL.revokeObjectURL(a)},4e4)}},mounted:function(){this.checkTwoStepAuth()}},To=Co,So=Object(N["a"])(To,_o,xo,!1,null,null,null),Po=So.exports;B()(So,{VAlert:Wt["a"],VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardTitle:Vt["a"],VContainer:pt["a"],VDialog:Ue["a"],VForm:Ht["a"],VSpacer:Ut["a"],VTextField:zt["a"]});var Lo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:""}},[a("div",[a("h1",[t._v("System Monitor")])]),a("v-card",{staticClass:"round-corner-card elevation-5 primary-card-gradient",attrs:{dark:""}},[a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("div",{staticClass:"headline"},[t._v("Platform")]),a("h2",[t._v("\n              "+t._s(t.basic.os.node)+"\n            ")]),a("span",[a("v-icon",[t._v("desktop_mac")]),t._v(" "+t._s(t.basic.os.name)+" "+t._s(t.basic.os.version)+" ("+t._s(t.basic.os.platform)+")\n            ")],1),a("p",[t._v(t._s(t.basic.os.serverInterpreter))]),a("v-divider"),t._v("\n            Refresh Loop:\n            "),t.mainTimer?a("span",[t._v("\n              On\n              "),a("v-btn",{attrs:{icon:"",flat:"",dark:""},on:{click:t.stopLoop}},[a("v-icon",[t._v("pause")])],1)],1):a("span",[t._v("\n              Off\n              "),a("v-btn",{attrs:{icon:"",flat:"",dark:""},on:{click:t.startLoop}},[a("v-icon",[t._v("play_arrow")])],1)],1)],1)])],1),a("v-card",{staticClass:"round-corner-card elevation-5 secondary-card-gradient",attrs:{dark:""}},[a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("div",{staticClass:"headline"},[t._v("CPU")]),a("h2",[t._v("\n              "+t._s(t.basic.cpu.name)+"\n            ")]),a("span",[t._v("\n              "+t._s(t.basic.cpu.totalCore)+" Cores "+t._s(t.basic.cpu.logicalCore)+" Threads\n            ")])])]),a("v-divider"),a("v-card-title",[a("div",[a("v-progress-circular",{attrs:{rotate:-90,size:150,width:15,value:t.dynamic.cpu.total}},[t._v("\n              Total: "+t._s(t.dynamic.cpu.total)+" %\n            ")])],1),t.dynamic.cpu.logic.length>1?a("div",t._l(t.dynamic.cpu.logic,function(e,n){return a("v-progress-circular",{key:n,attrs:{rotate:-90,size:100,width:15,value:e}},[t._v("\n              Core"+t._s(n)+": "+t._s(e)+" %\n            ")])}),1):t._e()])],1),a("v-card",{staticClass:"round-corner-card elevation-5 secondary-card-gradient",attrs:{dark:""}},[a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("div",{staticClass:"headline"},[t._v("Memory")]),a("h3",[t._v("\n              Virtual Memory\n            ")]),a("p",[t._v(t._s(t.usedMemory)+" Used")]),a("p",[t._v(t._s(t.availableMemory)+" Available")]),a("p",[t._v(t._s(t.totalMemory)+" Total")]),a("v-icon",[t._v("memory")]),t._v(" "+t._s(t.dynamic.memory.percent)+" %\n            "),a("v-progress-linear",{attrs:{"background-color":"info",color:"warning",value:t.dynamic.memory.percent}})],1)])],1),a("div",[a("div",[a("h1",[t._v("Revoke All Issued Tokens")]),a("v-flex",{attrs:{md12:"",lg12:""}},[a("v-alert",{attrs:{value:!0,type:"warning"}},[t._v("\n              This will revoke all issued tokens, and you will be logged out after that.\n            ")])],1),a("v-btn",{attrs:{color:"warning"},on:{click:t.refreshSalt,mouseleave:function(e){t.confirmRefresh=!1}}},[a("v-icon",[t._v("cloud_off")]),t._v(" "+t._s(t.confirmRefresh?"Confirm ":"")+"Revoke\n          ")],1)],1)])],1)],1)],1)},Oo=[],Vo={props:["userData","toast"],data:function(){return{basic:{cpu:{logicalCore:0,totalCore:0,name:""},os:{name:"",node:"",platform:"",version:"",serverInterpreter:""}},dynamic:{cpu:{total:0,logic:[]},memory:{percent:0,total:0,used:0,available:0}},mainTimer:0,removeBlurListener:null,removeFocusListener:null,confirmRefresh:!1}},computed:{usedMemory:function(){return this.readableMemory(this.dynamic.memory.used)},availableMemory:function(){return this.readableMemory(this.dynamic.memory.available)},totalMemory:function(){return this.readableMemory(this.dynamic.memory.total)}},methods:{getBasicInfo:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("system","basic-info")).then(D).then(function(e){t.basic=e}).catch(function(e){t.toast("You can not access such info.","error")})},getDynamicInfo:function(){var t=this;ht.fetchJSONWithSuccess(ht.apiFor("system","dynamic-info")).then(D).then(function(e){t.dynamic=e}).catch(function(e){t.destroyTimer(),t.toast("You can not access such info.","error")})},readableMemory:function(t){var e=["B","KB","MB","GB","TB","TB"],a=e.reduce(function(t){var e=Object(v["a"])(t,2),a=e[0],n=e[1];return a<1024?[a,n]:[a/1024,n+1]},[t,0]),n=Object(v["a"])(a,2),o=n[0],r=n[1];return o.toFixed(2)+e[r]},refreshSalt:function(){var t=this;this.confirmRefresh?(this.confirmRefresh=!1,ht.fetchJSONWithSuccess(ht.apiFor("system","refresh-salt"),"POST").then(function(){t.toast("Tokens revoked","success"),t.$router.push({name:"login",params:{logout:!0,alert:{color:"info",text:"All tokens revoked, so is your token, please login again."}}})}).error(function(e){t.toast("Something is wrong","error")})):this.confirmRefresh=!0},setListenerByVisibility:function(){document.hidden?this.destroyTimer():this.createTimer()},createTimer:function(){this.mainTimer||(this.mainTimer=setInterval(this.getDynamicInfo,2e3))},destroyTimer:function(){this.mainTimer&&(clearInterval(this.mainTimer),this.mainTimer=null)},setFocusTriggers:function(){this.removeBlurListener||(this.removeBlurListener=ht.addEventListener("blur",this.destroyTimer)),this.removeFocusListener||(this.removeFocusListener=ht.addEventListener("focus",this.createTimer))},destroyFocusTriggers:function(){this.removeBlurListener&&this.removeBlurListener(),this.removeFocusListener&&this.removeFocusListener(),this.removeBlurListener=this.removeFocusListener=null},startLoop:function(){this.createTimer(),this.setFocusTriggers()},stopLoop:function(){this.destroyFocusTriggers(),this.destroyTimer()}},mounted:function(){this.getBasicInfo(),this.getDynamicInfo(),this.createTimer(),this.setFocusTriggers()},beforeDestroy:function(){this.destroyTimer(),this.destroyFocusTriggers()}},$o=Vo,Eo=(a("e06d"),Object(N["a"])($o,Lo,Oo,!1,null,"14fc9104",null)),jo=Eo.exports;B()(Eo,{VAlert:Wt["a"],VBtn:vt["a"],VCard:Lt["a"],VCardTitle:Vt["a"],VContainer:pt["a"],VDivider:gt["a"],VFlex:bt["a"],VIcon:Et["a"],VLayout:yt["a"],VProgressCircular:wt["a"],VProgressLinear:Yt["a"]});var Ao=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("div",[a("div",[a("h1",[t._v("Clear All Drafts")]),a("v-flex",{attrs:{md12:"",lg12:""}},[a("v-alert",{attrs:{value:!0,type:"warning"}},[t._v("\n            This will remove all post drafts and this action can not be undone.\n          ")])],1),a("v-btn",{attrs:{color:"warning"},on:{click:t.removeDrafts,mouseleave:function(e){t.confirmClear=!1}}},[a("v-icon",[t._v("delete_sweep")]),t._v(" "+t._s(t.confirmClear?"Yes, ":"")+"Clear\n        ")],1)],1)]),a("v-flex",{attrs:{xs12:"",sm12:""}},[t.drafts.length?a("div",[a("h1",[t._v("Manage Drafts")])]):t._e(),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md6:"",sm12:""}},t._l(t.drafts,function(e){return a("v-scale-transition",{key:e.id},[a("v-card",{staticClass:"round-corner-card primary-card-gradient",attrs:{hover:"",dark:""}},[e.img?a("v-img",{attrs:{src:e.img}}):t._e(),a("v-card-title",{attrs:{"primary-title":""}},[a("div",[e.id?a("span",[t._v("#"+t._s(e.id))]):a("span",[t._v("New Post")]),a("h1",{staticClass:"headline"},[t._v(t._s(e.title||"Untitled"))]),a("h2",[t._v("\n                    "+t._s(e.subtitle)+"\n                  ")]),e.author?a("span",[t._v("\n                    "+t._s(e.author.nickname)+"\n                  ")]):a("span",[t._v(t._s(t.userData.nickname))])])]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{icon:"",to:{name:"edit",query:{post:e.id}}}},[a("v-icon",[t._v("mode_edit")])],1),a("v-btn",{attrs:{icon:""},on:{click:function(a){return t.removeDraft(e.id)}}},[a("v-icon",[t._v("delete")])],1)],1)],1)],1)}),1)],1)],1)],1)],1)},Fo=[],Uo={name:"DraftManage",props:{toast:Function,userData:Object},data:function(){return{drafts:[],confirmClear:!1}},methods:{removeDrafts:function(){if(this.confirmClear){this.confirmClear=!1;var t=localStorage;oe()(Array(t.length).keys()).map(t.key.bind(t)).filter(function(t){return t.startsWith("postDraft")}).forEach(function(e){t.removeItem(e)}),this.toast("Drafts cleaned!","success"),this.loadDrafts()}else this.confirmClear=!0},loadDrafts:function(){var t=localStorage;this.drafts=oe()(Array(t.length).keys()).map(t.key.bind(t)).filter(function(t){return t.startsWith("postDraft")}).map(function(e){return JSON.parse(t.getItem(e)).data})},removeDraft:function(t){localStorage.removeItem("postDraft#".concat(t)),this.loadDrafts()}},computed:{},mounted:function(){this.loadDrafts()}},Io=Uo,Ro=(a("0813"),Object(N["a"])(Io,Ao,Fo,!1,null,"f3c84178",null)),No=Ro.exports;B()(Ro,{VAlert:Wt["a"],VBtn:vt["a"],VCard:Lt["a"],VCardActions:Ot["a"],VCardTitle:Vt["a"],VContainer:pt["a"],VFlex:bt["a"],VIcon:Et["a"],VImg:jt["a"],VLayout:yt["a"],VScaleTransition:W["d"],VSpacer:Ut["a"]}),n["default"].use(z["a"]),n["default"].use(yn.a);var Mo=new z["a"]({mode:"history",base:at.urlPrefix,routes:[{path:"/hello",name:"helloWorld",component:xt},{path:"/",name:"index",component:Rt,meta:{title:at.title}},{path:"/login",name:"login",component:te,meta:{title:"Login"}},{path:"/post",name:"post",component:Sa,children:[{path:"shared/:shareId",name:"sharedPost",component:Sa},{path:":postLink",name:"postWithEternalLink",component:Sa}]},{path:"/edit",alias:"/add",name:"edit",component:nn},{path:"/userspace",alias:"/me",name:"userspace",component:gn,meta:{title:"Console"},children:[{path:"change-password",name:"changePassword",component:Tn,meta:{title:"Change Password"}},{path:"remote-login",name:"remoteLogin",component:$n,meta:{title:"Remote Login"}},{path:"user-management",name:"userManagement",component:Nn,meta:{title:"Manage Users"}},{path:"token-refresh",name:"tokenRefresh",component:to,meta:{title:"Refresh Tokens"}},{path:"account-settings",name:"setNickname",component:mo,meta:{title:"Account Settings"}},{path:"oauth-accounts",name:"oauthAccounts",component:ko,meta:{title:"OAuth Accounts"}},{path:"2-step-auth",name:"twoStepAuth",component:Po,meta:{title:"Two Factor Authentication"}},{path:"system-monitor",name:"systemMonitor",component:jo,meta:{title:"System Monitor"}},{path:"manage-drafts",name:"manageDrafts",component:No,meta:{title:"Draft Management"}},{path:"/",name:"console-index",component:Hn,meta:{title:"Roselia-Blog Console"}}]},{path:"/timeline",name:"timeline",component:io,meta:{title:"Timeline"},children:[{name:"userTimeline",path:":username",component:io}]},{path:"*",name:"notFound",alias:"/404",component:un,meta:{title:"404 Not Found"}}]}),Bo=a("fae4"),qo=a.n(Bo),Jo=a("bb71"),Wo=(a("da64"),a("25a2"));n["default"].use(Jo["a"],{theme:at.theme,customProperties:!0,iconfont:"md",lang:{locales:{zhHans:Wo["a"]},current:"zh-Hans"},icons:{brand:new Proxy({},{get:function(t,e){return qo()(t,e)?xe()(t,e):"string"===typeof e?"fab fa-".concat(e):void 0}})}}),n["default"].use(na["a"]);var Ho=new na["a"].Store({state:{commentDraft:{}},mutations:{setCommentDraft:function(t,e){t.commentDraft=Object(f["a"])({},t.commentDraft,Object(m["a"])({},e.commentId,e.comment))},removeCommentDraft:function(t,e){t.commentDraft=Object(f["a"])({},t.commentDraft,Object(m["a"])({},e,void 0))}},actions:{},getters:{}}),Yo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-snackbar",{attrs:{color:t.color,top:"",right:"",timeout:6e3},model:{value:t.showSelf,callback:function(e){t.showSelf=e},expression:"showSelf"}},[t._v("\n  "+t._s(t.text)+"\n  "),a("v-btn",{attrs:{flat:""},on:{click:function(e){t.showSelf=!1}}},[t._v("\n    Close\n  ")])],1)},zo=[],Go={name:"toast",props:["show","text","color"],computed:{showSelf:{get:function(){return this.show},set:function(t){this.$emit("showChange",t)}}}},Ko=Go,Xo=a("2db4"),Zo=Object(N["a"])(Ko,Yo,zo,!1,null,"0095ef24",null),Qo=Zo.exports;B()(Zo,{VBtn:vt["a"],VSnackbar:Xo["a"]});var tr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-footer",{staticClass:"oneness",attrs:{height:"auto"}},[a("v-layout",{attrs:{"justify-center":"",row:"",wrap:""}},[a("v-flex",{staticClass:"themed-text",attrs:{"py-3":"","lighten-2":"","text-xs-center":"",xs12:""}},[t._v("\n      ©"+t._s(t.year)+" — "),a("strong",[t._v("Somainer")])])],1)],1)},er=[],ar={name:"blog-footer",data:function(){return{year:(new Date).getFullYear(),title:at.title,motto:at.motto}}},nr=ar,or=(a("f97a"),a("553a")),rr=Object(N["a"])(nr,tr,er,!1,null,"a5ab113c",null),ir=rr.exports;B()(rr,{VFlex:bt["a"],VFooter:or["a"],VLayout:yt["a"]});var sr=a("26b9"),cr=a.n(sr),lr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{directives:[{name:"scroll",rawName:"v-scroll",value:t.recordScroll,expression:"recordScroll"},{name:"resize",rawName:"v-resize",value:t.recordHeight,expression:"recordHeight"}]},[a("v-scale-transition",{attrs:{origin:"center center 0"}},[t.showButton?a("v-btn",{staticClass:"fixed-action-btn",style:{bottom:t.$vuetify.breakpoint.smOnly?"64px":""},attrs:{color:"secondary",fab:"",fixed:"",bottom:"",right:""},on:{click:t.goTop}},[a("v-icon",[t._v("keyboard_arrow_up")])],1):t._e()],1)],1)},ur=[],dr=a("9d93"),hr={name:"gotop-button",directives:dr["a"],data:function(){return{height:0,offsetTop:0}},methods:{recordHeight:function(){this.height=window.innerHeight},recordScroll:function(){this.offsetTop=window.pageYOffset||document.documentElement.scrollTop},goTop:function(){this.$vuetify.goTo(0)}},mounted:function(){this.recordHeight(),this.recordScroll()},computed:{showButton:function(){return this.offsetTop>=this.height}}},mr=hr,fr=a("269a"),vr=a.n(fr),pr=a("0d3d"),gr=a("acdd"),br=Object(N["a"])(mr,lr,ur,!1,null,"05127ca4",null),yr=br.exports;B()(br,{VBtn:vt["a"],VIcon:Et["a"],VLayout:yt["a"],VScaleTransition:W["d"]}),vr()(br,{Resize:pr["a"],Scroll:gr["a"]});a("15f5");var wr=a("85fe");n["default"].prototype.config=at,n["default"].use(cr.a,{color:at.theme.secondary,failedColor:at.theme.error,thickness:"4px"}),n["default"].directive("observe-visibility",wr["a"]),n["default"].component("toast",Qo),n["default"].component("nav-bar",Ma),n["default"].component("blog-footer",ir),n["default"].component("go-top-btn",yr),n["default"].directive("focus",{update:function(t,e){var a=e.value;a&&t.focus()}}),n["default"].config.productionTip=!1;var kr=e["default"]=new n["default"]({router:Mo,store:Ho,render:function(t){return t(Y)}}).$mount("#black-shout")},d3b1:function(t,e,a){},d8c9:function(t,e,a){},e06d:function(t,e,a){"use strict";var n=a("9009"),o=a.n(n);o.a},efa2:function(t,e,a){},f97a:function(t,e,a){"use strict";var n=a("66fe"),o=a.n(n);o.a}});
//# sourceMappingURL=app.e5396a9a.js.map